{"version":3,"sources":["../src/components/AI/MCPToolCall.tsx","../src/components/AI/AIMessage.tsx","../src/components/Messaging/AttachmentPicker.tsx","../src/components/Messaging/MessageComposer.tsx","../src/components/Messaging/MessageBubble.tsx","../src/components/Messaging/MessageList.tsx","../src/components/AI/AIChat.tsx","../src/components/AI/AIChatModal.tsx","../src/components/AppHeader/AppHeader.tsx","../src/components/AudioPlayer/AudioPlayer.tsx","../src/components/AudioRecorder/AudioRecorder.tsx","../src/components/CommandPalette/CommandPaletteProvider.tsx","../src/components/CommandPalette/CommandPalette.tsx","../src/components/Messaging/ConversationHeader.tsx","../src/components/Messaging/MessageThread.tsx","../src/components/Messaging/hooks.ts","../src/components/RecordButton/RecordButton.tsx","../src/components/Sidebar/SidebarProvider.tsx","../src/components/Sidebar/Sidebar.tsx","../src/components/Toast/Toast.tsx","../src/components/Toast/ToastProvider.tsx"],"names":["React","formatDuration","avatarVariants","cva","getInitials","jsx","jsxs","React2","formatTime","React3","React4","statusIconVariants","formatFileSize","bubbleVariants","React5","React6","React7","Fragment","React8","React9","PlayIcon","PauseIcon","useState","useCallback","useMemo","SearchIcon","SpinnerIcon","isMac","useRef","useEffect","React13","React14","React15","MicrophoneIcon","StopIcon","React16","createContext","useContext","XIcon","toast"],"mappings":"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","file":"index.js","sourcesContent":["/**\n * MCP Tool Call Display Component\n *\n * Renders an MCP tool invocation with status, parameters, and results.\n */\n\nimport * as React from 'react';\nimport { cva, type VariantProps } from 'class-variance-authority';\nimport { cn } from '../../utils/cn';\nimport type {\n  MCPToolCall,\n  MCPToolStatus,\n  MCPToolResult,\n  MCPResourceLink,\n  MCPToolParameter,\n} from './types';\n\n// ============================================================================\n// Status Icon Component\n// ============================================================================\n\nconst statusIconVariants = cva(\n  'flex h-5 w-5 items-center justify-center rounded-full',\n  {\n    variants: {\n      status: {\n        pending: 'bg-neutral-200 dark:bg-neutral-700',\n        running: 'bg-primary-100 dark:bg-primary-900/50',\n        success: 'bg-green-100 dark:bg-green-900/50',\n        error: 'bg-red-100 dark:bg-red-900/50',\n        cancelled: 'bg-neutral-200 dark:bg-neutral-700',\n      },\n    },\n    defaultVariants: {\n      status: 'pending',\n    },\n  }\n);\n\ninterface ToolStatusIconProps {\n  status: MCPToolStatus;\n  className?: string;\n}\n\nfunction ToolStatusIcon({ status, className }: ToolStatusIconProps) {\n  return (\n    <span className={cn(statusIconVariants({ status }), className)}>\n      {status === 'pending' && (\n        <svg className=\"h-3 w-3 text-neutral-500\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n          <circle cx=\"10\" cy=\"10\" r=\"3\" />\n        </svg>\n      )}\n      {status === 'running' && (\n        <svg\n          className=\"h-3 w-3 animate-spin text-primary-600 dark:text-primary-400\"\n          fill=\"none\"\n          viewBox=\"0 0 24 24\"\n        >\n          <circle\n            className=\"opacity-25\"\n            cx=\"12\"\n            cy=\"12\"\n            r=\"10\"\n            stroke=\"currentColor\"\n            strokeWidth=\"4\"\n          />\n          <path\n            className=\"opacity-75\"\n            fill=\"currentColor\"\n            d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z\"\n          />\n        </svg>\n      )}\n      {status === 'success' && (\n        <svg\n          className=\"h-3 w-3 text-green-600 dark:text-green-400\"\n          fill=\"none\"\n          viewBox=\"0 0 24 24\"\n          stroke=\"currentColor\"\n          strokeWidth=\"3\"\n        >\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M5 13l4 4L19 7\" />\n        </svg>\n      )}\n      {status === 'error' && (\n        <svg\n          className=\"h-3 w-3 text-red-600 dark:text-red-400\"\n          fill=\"none\"\n          viewBox=\"0 0 24 24\"\n          stroke=\"currentColor\"\n          strokeWidth=\"3\"\n        >\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M6 18L18 6M6 6l12 12\" />\n        </svg>\n      )}\n      {status === 'cancelled' && (\n        <svg\n          className=\"h-3 w-3 text-neutral-500\"\n          fill=\"none\"\n          viewBox=\"0 0 24 24\"\n          stroke=\"currentColor\"\n          strokeWidth=\"3\"\n        >\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M18 12H6\" />\n        </svg>\n      )}\n    </span>\n  );\n}\n\n// ============================================================================\n// Tool Icon Component\n// ============================================================================\n\nconst TOOL_ICONS: Record<string, React.ReactNode> = {\n  // Patient tools\n  create_patient: (\n    <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M18 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zM3 19.235v-.11a6.375 6.375 0 0112.75 0v.109A12.318 12.318 0 019.374 21c-2.331 0-4.512-.645-6.374-1.766z\" />\n    </svg>\n  ),\n  get_patient: (\n    <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z\" />\n    </svg>\n  ),\n  search_patients: (\n    <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z\" />\n    </svg>\n  ),\n  // Appointment tools\n  schedule_appointment: (\n    <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5m-9-6h.008v.008H12v-.008zM12 15h.008v.008H12V15zm0 2.25h.008v.008H12v-.008zM9.75 15h.008v.008H9.75V15zm0 2.25h.008v.008H9.75v-.008zM7.5 15h.008v.008H7.5V15zm0 2.25h.008v.008H7.5v-.008zm6.75-4.5h.008v.008h-.008v-.008zm0 2.25h.008v.008h-.008V15zm0 2.25h.008v.008h-.008v-.008zm2.25-4.5h.008v.008H16.5v-.008zm0 2.25h.008v.008H16.5V15z\" />\n    </svg>\n  ),\n  // Document tools\n  create_document: (\n    <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m3.75 9v6m3-3H9m1.5-12H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z\" />\n    </svg>\n  ),\n  // Default tool icon\n  default: (\n    <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M11.42 15.17L17.25 21A2.652 2.652 0 0021 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 11-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 004.486-6.336l-3.276 3.277a3.004 3.004 0 01-2.25-2.25l3.276-3.276a4.5 4.5 0 00-6.336 4.486c.091 1.076-.071 2.264-.904 2.95l-.102.085m-1.745 1.437L5.909 7.5H4.5L2.25 3.75l1.5-1.5L7.5 4.5v1.409l4.26 4.26m-1.745 1.437l1.745-1.437m6.615 8.206L15.75 15.75M4.867 19.125h.008v.008h-.008v-.008z\" />\n    </svg>\n  ),\n};\n\nfunction getToolIcon(toolName: string): React.ReactNode {\n  return TOOL_ICONS[toolName] || TOOL_ICONS.default;\n}\n\n// ============================================================================\n// Resource Link Component\n// ============================================================================\n\nexport interface ResourceLinkProps {\n  link: MCPResourceLink;\n  onClick?: (link: MCPResourceLink) => void;\n  className?: string;\n}\n\nexport function ResourceLink({ link, onClick, className }: ResourceLinkProps) {\n  const handleClick = (e: React.MouseEvent) => {\n    if (onClick) {\n      e.preventDefault();\n      onClick(link);\n    }\n  };\n\n  const linkTypeIcons: Record<string, React.ReactNode> = {\n    patient: (\n      <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z\" />\n      </svg>\n    ),\n    document: (\n      <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z\" />\n      </svg>\n    ),\n    appointment: (\n      <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5\" />\n      </svg>\n    ),\n    order: (\n      <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25z\" />\n      </svg>\n    ),\n    external: (\n      <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M13.5 6H5.25A2.25 2.25 0 003 8.25v10.5A2.25 2.25 0 005.25 21h10.5A2.25 2.25 0 0018 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25\" />\n      </svg>\n    ),\n    internal: (\n      <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244\" />\n      </svg>\n    ),\n  };\n\n  const icon = link.type ? linkTypeIcons[link.type] : linkTypeIcons.internal;\n\n  return (\n    <a\n      href={link.href}\n      onClick={handleClick}\n      className={cn(\n        'inline-flex items-center gap-1.5 rounded-md px-2.5 py-1.5',\n        'bg-primary-50 text-primary-700 hover:bg-primary-100',\n        'dark:bg-primary-900/30 dark:text-primary-300 dark:hover:bg-primary-900/50',\n        'text-sm font-medium transition-colors',\n        'focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2',\n        'dark:focus:ring-offset-neutral-900',\n        className\n      )}\n    >\n      {icon}\n      <span>{link.label}</span>\n      {link.type === 'external' && (\n        <svg className=\"h-3 w-3 opacity-60\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M4.5 19.5l15-15m0 0H8.25m11.25 0v11.25\" />\n        </svg>\n      )}\n    </a>\n  );\n}\n\n// ============================================================================\n// Tool Result Component\n// ============================================================================\n\ninterface ToolResultDisplayProps {\n  result: MCPToolResult;\n  onLinkClick?: (link: MCPResourceLink) => void;\n  showRawData?: boolean;\n  className?: string;\n}\n\nfunction ToolResultDisplay({ result, onLinkClick, showRawData = false, className }: ToolResultDisplayProps) {\n  const [showJson, setShowJson] = React.useState(false);\n\n  if (result.type === 'error') {\n    return (\n      <div className={cn('mt-2 rounded-md bg-red-50 p-3 dark:bg-red-900/20', className)}>\n        <p className=\"text-sm text-red-700 dark:text-red-300\">\n          {typeof result.data === 'string' ? String(result.data) : 'An error occurred'}\n        </p>\n      </div>\n    );\n  }\n\n  const hasRawData = result.type === 'json' && result.data !== undefined && result.data !== null;\n\n  return (\n    <div className={cn('space-y-2', className)}>\n      {result.summary && (\n        <p className=\"text-sm text-neutral-700 dark:text-neutral-300\">\n          {result.summary}\n        </p>\n      )}\n      \n      {result.link && (\n        <ResourceLink link={result.link} onClick={onLinkClick} />\n      )}\n\n      {result.resources && result.resources.length > 0 && (\n        <div className=\"flex flex-wrap gap-2\">\n          {result.resources.map((resource) => (\n            <ResourceLink\n              key={resource.id}\n              link={{\n                href: resource.uri || '#',\n                label: resource.name,\n                type: resource.type as MCPResourceLink['type'],\n              }}\n              onClick={onLinkClick}\n            />\n          ))}\n        </div>\n      )}\n\n      {/* Raw JSON data - hidden by default */}\n      {hasRawData && showRawData && (\n        <div className=\"mt-2\">\n          <button\n            onClick={() => setShowJson(!showJson)}\n            className=\"flex items-center gap-1 text-xs text-neutral-500 hover:text-neutral-700 dark:text-neutral-400 dark:hover:text-neutral-300\"\n          >\n            <svg\n              className={cn('h-3 w-3 transition-transform', showJson && 'rotate-90')}\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              stroke=\"currentColor\"\n              strokeWidth=\"2\"\n            >\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9 5l7 7-7 7\" />\n            </svg>\n            {showJson ? 'Hide' : 'Show'} raw data\n          </button>\n          {showJson && (\n            <pre className=\"mt-2 max-h-40 overflow-auto rounded-md bg-neutral-100 p-2 text-xs dark:bg-neutral-800\">\n              {JSON.stringify(result.data, null, 2)}\n            </pre>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n\n// ============================================================================\n// MCP Tool Call Component\n// ============================================================================\n\nconst toolCallVariants = cva(\n  [\n    'rounded-lg border',\n    'overflow-hidden',\n    'transition-all duration-200',\n  ],\n  {\n    variants: {\n      status: {\n        pending: 'border-neutral-200 bg-neutral-50 dark:border-neutral-700 dark:bg-neutral-800/50',\n        running: 'border-primary-200 bg-primary-50/50 dark:border-primary-800 dark:bg-primary-900/20',\n        success: 'border-green-200 bg-green-50/50 dark:border-green-800 dark:bg-green-900/20',\n        error: 'border-red-200 bg-red-50/50 dark:border-red-800 dark:bg-red-900/20',\n        cancelled: 'border-neutral-200 bg-neutral-50 dark:border-neutral-700 dark:bg-neutral-800/50 opacity-60',\n      },\n      compact: {\n        true: 'p-2',\n        false: 'p-3',\n      },\n    },\n    defaultVariants: {\n      status: 'pending',\n      compact: false,\n    },\n  }\n);\n\n// Human-readable tool names\nconst TOOL_FRIENDLY_NAMES: Record<string, string> = {\n  create_patient: 'Creating patient',\n  get_patient: 'Looking up patient',\n  search_patients: 'Searching patients',\n  update_patient: 'Updating patient',\n  delete_patient: 'Removing patient',\n  schedule_appointment: 'Scheduling appointment',\n  cancel_appointment: 'Canceling appointment',\n  update_appointment: 'Updating appointment',\n  create_document: 'Creating document',\n  upload_document: 'Uploading document',\n  get_document: 'Retrieving document',\n  search_documents: 'Searching documents',\n  create_order: 'Creating order',\n  send_message: 'Sending message',\n  search: 'Searching',\n};\n\nfunction getToolFriendlyName(toolName: string, status: MCPToolStatus): string {\n  const baseName = TOOL_FRIENDLY_NAMES[toolName] || toolName.replace(/_/g, ' ');\n  \n  // Adjust tense based on status\n  if (status === 'success') {\n    // Past tense approximation\n    if (baseName.startsWith('Creating')) return baseName.replace('Creating', 'Created');\n    if (baseName.startsWith('Scheduling')) return baseName.replace('Scheduling', 'Scheduled');\n    if (baseName.startsWith('Searching')) return baseName.replace('Searching', 'Searched');\n    if (baseName.startsWith('Looking')) return baseName.replace('Looking', 'Found');\n    if (baseName.startsWith('Updating')) return baseName.replace('Updating', 'Updated');\n    if (baseName.startsWith('Removing')) return baseName.replace('Removing', 'Removed');\n    if (baseName.startsWith('Canceling')) return baseName.replace('Canceling', 'Canceled');\n    if (baseName.startsWith('Retrieving')) return baseName.replace('Retrieving', 'Retrieved');\n    if (baseName.startsWith('Uploading')) return baseName.replace('Uploading', 'Uploaded');\n    if (baseName.startsWith('Sending')) return baseName.replace('Sending', 'Sent');\n  }\n  return baseName;\n}\n\n// Generate a user-friendly summary from parameters\nfunction getParameterSummary(toolName: string, params: MCPToolParameter[]): string | null {\n  const paramMap = Object.fromEntries(params.map(p => [p.name, p.value]));\n  \n  // Patient creation\n  if (toolName === 'create_patient' && paramMap.firstName && paramMap.lastName) {\n    return `${paramMap.firstName} ${paramMap.lastName}`;\n  }\n  \n  // Search\n  if (toolName.includes('search') && paramMap.query) {\n    return `\"${paramMap.query}\"`;\n  }\n  \n  // Appointment\n  if (toolName.includes('appointment') && paramMap.patientName) {\n    const date = paramMap.preferredDate || paramMap.date;\n    return date ? `${paramMap.patientName} on ${date}` : String(paramMap.patientName);\n  }\n  \n  return null;\n}\n\nexport interface MCPToolCallDisplayProps extends VariantProps<typeof toolCallVariants> {\n  /** The tool call to display */\n  toolCall: MCPToolCall;\n  /** Whether to show parameters (in detailed view) */\n  showParameters?: boolean;\n  /** Whether the component is collapsible to show details */\n  collapsible?: boolean;\n  /** Default collapsed state (true = hide details) */\n  defaultCollapsed?: boolean;\n  /** Callback when a resource link is clicked */\n  onLinkClick?: (link: MCPResourceLink) => void;\n  /** Additional class name */\n  className?: string;\n}\n\n/**\n * Displays an MCP tool call with its status, parameters, and results.\n * Shows a user-friendly summary by default, with technical details available on expand.\n */\nexport function MCPToolCallDisplay({\n  toolCall,\n  showParameters = true,\n  collapsible = true,\n  defaultCollapsed = true,\n  compact,\n  onLinkClick,\n  className,\n}: MCPToolCallDisplayProps) {\n  const [showDetails, setShowDetails] = React.useState(!defaultCollapsed);\n\n  const formatDuration = (ms?: number) => {\n    if (!ms) return null;\n    if (ms < 1000) return `${ms}ms`;\n    return `${(ms / 1000).toFixed(1)}s`;\n  };\n\n  const friendlyName = getToolFriendlyName(toolCall.toolName, toolCall.status);\n  const paramSummary = getParameterSummary(toolCall.toolName, toolCall.parameters);\n\n  return (\n    <div className={cn(toolCallVariants({ status: toolCall.status, compact }), className)}>\n      {/* Main Content - Always Visible */}\n      <div className=\"flex items-start gap-3\">\n        {/* Tool Icon */}\n        <div className=\"flex h-8 w-8 shrink-0 items-center justify-center rounded-md bg-white/50 text-neutral-600 dark:bg-neutral-700/50 dark:text-neutral-400\">\n          {getToolIcon(toolCall.toolName)}\n        </div>\n\n        {/* Content */}\n        <div className=\"min-w-0 flex-1\">\n          {/* Friendly Status Line */}\n          <div className=\"flex items-center gap-2\">\n            <span className=\"text-sm font-medium text-neutral-900 dark:text-white\">\n              {friendlyName}\n            </span>\n            <ToolStatusIcon status={toolCall.status} />\n            {toolCall.duration && (\n              <span className=\"text-xs text-neutral-400\">\n                {formatDuration(toolCall.duration)}\n              </span>\n            )}\n          </div>\n\n          {/* Parameter Summary (user-friendly) */}\n          {paramSummary && toolCall.status !== 'success' && (\n            <p className=\"mt-0.5 text-sm text-neutral-600 dark:text-neutral-400\">\n              {paramSummary}\n            </p>\n          )}\n\n          {/* Result Summary & Links */}\n          {toolCall.result && (\n            <div className=\"mt-2\">\n              <ToolResultDisplay \n                result={toolCall.result} \n                onLinkClick={onLinkClick}\n                showRawData={showDetails}\n              />\n            </div>\n          )}\n\n          {/* Error */}\n          {toolCall.error && (\n            <div className=\"mt-2 rounded-md bg-red-100 p-2 dark:bg-red-900/30\">\n              <p className=\"text-sm text-red-700 dark:text-red-300\">{toolCall.error}</p>\n            </div>\n          )}\n\n          {/* Show Details Toggle */}\n          {collapsible && (showParameters && toolCall.parameters.length > 0) && (\n            <button\n              onClick={() => setShowDetails(!showDetails)}\n              className=\"mt-2 flex items-center gap-1 text-xs text-neutral-500 hover:text-neutral-700 dark:text-neutral-400 dark:hover:text-neutral-300\"\n            >\n              <svg\n                className={cn('h-3 w-3 transition-transform', showDetails && 'rotate-90')}\n                fill=\"none\"\n                viewBox=\"0 0 24 24\"\n                stroke=\"currentColor\"\n                strokeWidth=\"2\"\n              >\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9 5l7 7-7 7\" />\n              </svg>\n              {showDetails ? 'Hide' : 'Show'} details\n            </button>\n          )}\n\n          {/* Technical Details (collapsed by default) */}\n          {showDetails && showParameters && toolCall.parameters.length > 0 && (\n            <div className=\"mt-3 rounded-md bg-neutral-100 p-2 dark:bg-neutral-800\">\n              <h4 className=\"mb-1.5 text-xs font-medium uppercase tracking-wide text-neutral-500 dark:text-neutral-400\">\n                Parameters\n              </h4>\n              <div className=\"space-y-0.5\">\n                {toolCall.parameters.map((param) => (\n                  <div key={param.name} className=\"flex items-start gap-2 text-xs\">\n                    <span className=\"font-mono text-neutral-500 dark:text-neutral-500\">\n                      {param.name}:\n                    </span>\n                    <span className=\"font-mono text-neutral-700 dark:text-neutral-300\">\n                      {typeof param.value === 'string'\n                        ? param.value\n                        : JSON.stringify(param.value)}\n                    </span>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport { ToolStatusIcon, getToolIcon };\n","/**\n * AI Message Component\n *\n * Renders AI chat messages with support for text, tool calls, and streaming.\n */\n\nimport * as React from 'react';\nimport { cva, type VariantProps } from 'class-variance-authority';\nimport { cn } from '../../utils/cn';\nimport type { AIMessage, AIMessageContent, MCPResourceLink } from './types';\nimport { MCPToolCallDisplay } from './MCPToolCall';\n\n// ============================================================================\n// Avatar Component\n// ============================================================================\n\nconst avatarVariants = cva(\n  'flex shrink-0 items-center justify-center rounded-full',\n  {\n    variants: {\n      role: {\n        user: 'bg-primary-100 text-primary-700 dark:bg-primary-900/50 dark:text-primary-300',\n        assistant: 'bg-gradient-to-br from-violet-500 to-purple-600 text-white',\n        system: 'bg-neutral-200 text-neutral-600 dark:bg-neutral-700 dark:text-neutral-400',\n        tool: 'bg-amber-100 text-amber-700 dark:bg-amber-900/50 dark:text-amber-300',\n      },\n      size: {\n        sm: 'h-6 w-6 text-xs',\n        md: 'h-8 w-8 text-sm',\n        lg: 'h-10 w-10 text-base',\n      },\n    },\n    defaultVariants: {\n      role: 'user',\n      size: 'md',\n    },\n  }\n);\n\ninterface MessageAvatarProps extends VariantProps<typeof avatarVariants> {\n  userName?: string;\n  className?: string;\n}\n\nfunction MessageAvatar({ role, size, userName, className }: MessageAvatarProps) {\n  const getInitials = (name?: string) => {\n    if (!name) return '?';\n    return name.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase();\n  };\n\n  return (\n    <div className={cn(avatarVariants({ role, size }), className)}>\n      {role === 'assistant' ? (\n        <svg className=\"h-5 w-5\" viewBox=\"0 0 24 24\" fill=\"none\">\n          <path\n            d=\"M12 2L2 7L12 12L22 7L12 2Z\"\n            stroke=\"currentColor\"\n            strokeWidth=\"1.5\"\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            fill=\"currentColor\"\n            fillOpacity=\"0.2\"\n          />\n          <path\n            d=\"M2 17L12 22L22 17\"\n            stroke=\"currentColor\"\n            strokeWidth=\"1.5\"\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n          />\n          <path\n            d=\"M2 12L12 17L22 12\"\n            stroke=\"currentColor\"\n            strokeWidth=\"1.5\"\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n          />\n        </svg>\n      ) : role === 'user' ? (\n        <span className=\"font-medium\">{getInitials(userName)}</span>\n      ) : role === 'system' ? (\n        <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z\" />\n        </svg>\n      ) : (\n        <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M11.42 15.17L17.25 21A2.652 2.652 0 0021 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 11-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 004.486-6.336l-3.276 3.277a3.004 3.004 0 01-2.25-2.25l3.276-3.276a4.5 4.5 0 00-6.336 4.486c.091 1.076-.071 2.264-.904 2.95l-.102.085m-1.745 1.437L5.909 7.5H4.5L2.25 3.75l1.5-1.5L7.5 4.5v1.409l4.26 4.26m-1.745 1.437l1.745-1.437m6.615 8.206L15.75 15.75M4.867 19.125h.008v.008h-.008v-.008z\" />\n        </svg>\n      )}\n    </div>\n  );\n}\n\n// ============================================================================\n// Typing Indicator\n// ============================================================================\n\nfunction AITypingIndicator({ className }: { className?: string }) {\n  return (\n    <div className={cn('flex items-center gap-1', className)}>\n      <span className=\"h-2 w-2 animate-bounce rounded-full bg-neutral-400 dark:bg-neutral-500 [animation-delay:-0.3s]\" />\n      <span className=\"h-2 w-2 animate-bounce rounded-full bg-neutral-400 dark:bg-neutral-500 [animation-delay:-0.15s]\" />\n      <span className=\"h-2 w-2 animate-bounce rounded-full bg-neutral-400 dark:bg-neutral-500\" />\n    </div>\n  );\n}\n\n// ============================================================================\n// Content Block Renderer\n// ============================================================================\n\ninterface ContentBlockProps {\n  content: AIMessageContent;\n  onLinkClick?: (link: MCPResourceLink) => void;\n}\n\nfunction ContentBlock({ content, onLinkClick }: ContentBlockProps) {\n  const [isCollapsed, setIsCollapsed] = React.useState(content.collapsed ?? false);\n\n  if (content.type === 'text' && content.text) {\n    return (\n      <div className=\"prose prose-sm dark:prose-invert max-w-none\">\n        <p className=\"whitespace-pre-wrap\">{content.text}</p>\n      </div>\n    );\n  }\n\n  if (content.type === 'tool_use' && content.toolCall) {\n    return (\n      <MCPToolCallDisplay\n        toolCall={content.toolCall}\n        onLinkClick={onLinkClick}\n        defaultCollapsed={content.collapsed}\n      />\n    );\n  }\n\n  if (content.type === 'thinking' && content.text) {\n    return (\n      <div className=\"rounded-lg border border-neutral-200 bg-neutral-50 dark:border-neutral-700 dark:bg-neutral-800/50\">\n        <button\n          onClick={() => setIsCollapsed(!isCollapsed)}\n          className=\"flex w-full items-center justify-between px-3 py-2 text-left\"\n        >\n          <span className=\"flex items-center gap-2 text-sm text-neutral-500 dark:text-neutral-400\">\n            <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.894 20.567L16.5 21.75l-.394-1.183a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 001.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 001.423 1.423l1.183.394-1.183.394a2.25 2.25 0 00-1.423 1.423z\" />\n            </svg>\n            Thinking...\n          </span>\n          <svg\n            className={cn('h-4 w-4 text-neutral-400 transition-transform', isCollapsed && '-rotate-90')}\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            stroke=\"currentColor\"\n            strokeWidth=\"2\"\n          >\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M19 9l-7 7-7-7\" />\n          </svg>\n        </button>\n        {!isCollapsed && (\n          <div className=\"border-t border-neutral-200 px-3 py-2 dark:border-neutral-700\">\n            <p className=\"text-sm text-neutral-600 italic dark:text-neutral-400\">\n              {content.text}\n            </p>\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  if (content.type === 'code' && content.text) {\n    return (\n      <pre className=\"rounded-lg bg-neutral-900 p-3 text-sm dark:bg-neutral-950\">\n        <code className={content.language ? `language-${content.language}` : ''}>\n          {content.text}\n        </code>\n      </pre>\n    );\n  }\n\n  return null;\n}\n\n// ============================================================================\n// AI Message Component\n// ============================================================================\n\nconst messageVariants = cva('flex gap-3', {\n  variants: {\n    role: {\n      user: 'flex-row-reverse',\n      assistant: 'flex-row',\n      system: 'flex-row justify-center',\n      tool: 'flex-row',\n    },\n  },\n  defaultVariants: {\n    role: 'assistant',\n  },\n});\n\nconst bubbleVariants = cva(\n  'rounded-2xl px-4 py-2.5 max-w-[85%]',\n  {\n    variants: {\n      role: {\n        user: 'bg-primary-600 text-white dark:bg-primary-500',\n        assistant: 'bg-neutral-100 text-neutral-900 dark:bg-neutral-800 dark:text-white',\n        system: 'bg-neutral-100 text-neutral-600 dark:bg-neutral-800 dark:text-neutral-400 text-center text-sm max-w-[95%]',\n        tool: 'bg-transparent p-0 max-w-full w-full',\n      },\n    },\n    defaultVariants: {\n      role: 'assistant',\n    },\n  }\n);\n\nexport interface AIMessageDisplayProps {\n  /** The message to display */\n  message: AIMessage;\n  /** User name for user messages */\n  userName?: string;\n  /** Whether to show the avatar */\n  showAvatar?: boolean;\n  /** Whether to show timestamp */\n  showTimestamp?: boolean;\n  /** Callback when a resource link is clicked */\n  onLinkClick?: (link: MCPResourceLink) => void;\n  /** Additional class name */\n  className?: string;\n}\n\n/**\n * Displays an AI chat message with support for text, tool calls, and streaming.\n */\nexport function AIMessageDisplay({\n  message,\n  userName,\n  showAvatar = true,\n  showTimestamp = false,\n  onLinkClick,\n  className,\n}: AIMessageDisplayProps) {\n  const isStreaming = message.status === 'streaming';\n  const hasContent = message.content.length > 0;\n\n  const formatTime = (timestamp: Date | string) => {\n    const date = new Date(timestamp);\n    return date.toLocaleTimeString(undefined, { hour: 'numeric', minute: '2-digit' });\n  };\n\n  // For tool messages, render just the tool call without bubble\n  if (message.role === 'tool') {\n    return (\n      <div className={cn(messageVariants({ role: message.role }), className)}>\n        {showAvatar && <MessageAvatar role={message.role} />}\n        <div className=\"flex-1 space-y-2\">\n          {message.content.map((content, index) => (\n            <ContentBlock key={index} content={content} onLinkClick={onLinkClick} />\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={cn(messageVariants({ role: message.role }), className)}>\n      {showAvatar && message.role !== 'system' && (\n        <MessageAvatar role={message.role} userName={userName} />\n      )}\n      \n      <div className={cn('flex flex-col gap-1', message.role === 'user' && 'items-end')}>\n        <div className={bubbleVariants({ role: message.role })}>\n          {hasContent ? (\n            <div className=\"space-y-3\">\n              {message.content.map((content, index) => (\n                <ContentBlock key={index} content={content} onLinkClick={onLinkClick} />\n              ))}\n            </div>\n          ) : isStreaming ? (\n            <AITypingIndicator />\n          ) : null}\n        </div>\n\n        {showTimestamp && (\n          <span className=\"px-2 text-xs text-neutral-500\">\n            {formatTime(message.timestamp)}\n          </span>\n        )}\n\n        {message.status === 'error' && (\n          <span className=\"px-2 text-xs text-red-500\">\n            Failed to send\n          </span>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport { MessageAvatar, AITypingIndicator };\n","/* eslint-disable no-undef */\nimport * as React from 'react';\nimport { cn } from '../../utils/cn';\nimport type { AttachmentType, AttachmentState } from './types';\n\n// ============================================================================\n// Utility Functions\n// ============================================================================\n\n/**\n * Get file type from MIME type.\n */\nfunction getFileType(mimeType: string): AttachmentType {\n  if (mimeType.startsWith('image/')) return 'image';\n  if (mimeType.startsWith('video/')) return 'video';\n  if (mimeType.startsWith('audio/')) return 'audio';\n  if (\n    mimeType.includes('pdf') ||\n    mimeType.includes('document') ||\n    mimeType.includes('text')\n  ) {\n    return 'document';\n  }\n  return 'file';\n}\n\n/**\n * Format file size in human-readable format.\n */\nfunction formatFileSize(bytes: number): string {\n  if (bytes < 1024) return `${bytes} B`;\n  if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\n  return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\n}\n\n/**\n * Validate file type and size.\n */\nfunction validateFile(\n  file: File,\n  acceptedTypes?: string[],\n  maxSize?: number\n): { valid: boolean; error?: string } {\n  if (acceptedTypes && acceptedTypes.length > 0) {\n    const isAccepted = acceptedTypes.some((type) => {\n      if (type.startsWith('.')) {\n        return file.name.toLowerCase().endsWith(type.toLowerCase());\n      }\n      if (type.endsWith('/*')) {\n        return file.type.startsWith(type.replace('/*', '/'));\n      }\n      return file.type === type;\n    });\n    if (!isAccepted) {\n      return { valid: false, error: 'File type not supported' };\n    }\n  }\n\n  if (maxSize && file.size > maxSize) {\n    return {\n      valid: false,\n      error: `File too large (max ${formatFileSize(maxSize)})`,\n    };\n  }\n\n  return { valid: true };\n}\n\n/**\n * Generate a unique ID for attachments.\n */\nfunction generateAttachmentId(): string {\n  return `attachment-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n}\n\n// ============================================================================\n// Attachment Preview Item Component\n// ============================================================================\n\nexport interface AttachmentPreviewItemProps {\n  /** The attachment to preview */\n  attachment: {\n    id: string;\n    file: File;\n    previewUrl?: string;\n    type: AttachmentType;\n    state: AttachmentState;\n    progress?: number;\n    error?: string;\n  };\n  /** Called when remove is clicked */\n  onRemove: () => void;\n  /** Called when retry is clicked */\n  onRetry?: () => void;\n  className?: string;\n}\n\n/**\n * Preview item for a pending attachment.\n */\nfunction AttachmentPreviewItem({\n  attachment,\n  onRemove,\n  onRetry,\n  className,\n}: AttachmentPreviewItemProps) {\n  const { file, previewUrl, type, state, progress } = attachment;\n  const isImage = type === 'image';\n  const isVideo = type === 'video';\n  const isUploading = state === 'uploading';\n  const isFailed = state === 'failed';\n\n  return (\n    <div\n      className={cn(\n        'group relative overflow-hidden rounded-lg',\n        'bg-neutral-100 dark:bg-neutral-800',\n        'border border-neutral-200 dark:border-neutral-700',\n        isFailed && 'border-red-500',\n        className\n      )}\n    >\n      {/* Image/Video preview */}\n      {(isImage || isVideo) && previewUrl ? (\n        <div className=\"relative h-20 w-20\">\n          <img\n            src={previewUrl}\n            alt={file.name}\n            className={cn(\n              'h-full w-full object-cover',\n              (isUploading || isFailed) && 'opacity-50'\n            )}\n          />\n          {isVideo && (\n            <div className=\"absolute inset-0 flex items-center justify-center\">\n              <svg\n                className=\"h-6 w-6 text-white drop-shadow\"\n                fill=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n              >\n                <path d=\"M8 5v14l11-7z\" />\n              </svg>\n            </div>\n          )}\n        </div>\n      ) : (\n        /* File preview */\n        <div className=\"flex h-20 w-20 flex-col items-center justify-center p-2\">\n          <svg\n            className=\"h-8 w-8 text-neutral-400\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            stroke=\"currentColor\"\n          >\n            <path\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth={2}\n              d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\n            />\n          </svg>\n          <span className=\"mt-1 max-w-full truncate px-1 text-xs text-neutral-500\">\n            {file.name.split('.').pop()?.toUpperCase()}\n          </span>\n        </div>\n      )}\n\n      {/* Upload progress overlay */}\n      {isUploading && progress !== undefined && (\n        <div className=\"absolute inset-0 flex items-center justify-center bg-black/50\">\n          <div className=\"text-center text-white\">\n            <svg\n              className=\"mx-auto h-6 w-6 animate-spin\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n            >\n              <circle\n                className=\"opacity-25\"\n                cx=\"12\"\n                cy=\"12\"\n                r=\"10\"\n                stroke=\"currentColor\"\n                strokeWidth=\"4\"\n              />\n              <path\n                className=\"opacity-75\"\n                fill=\"currentColor\"\n                d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z\"\n              />\n            </svg>\n            <span className=\"mt-1 text-xs\">{progress}%</span>\n          </div>\n        </div>\n      )}\n\n      {/* Error overlay */}\n      {isFailed && (\n        <div className=\"absolute inset-0 flex items-center justify-center bg-black/50\">\n          <div className=\"text-center\">\n            <svg\n              className=\"mx-auto h-6 w-6 text-red-400\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              stroke=\"currentColor\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\"\n              />\n            </svg>\n            {onRetry && (\n              <button\n                type=\"button\"\n                onClick={onRetry}\n                className=\"mt-1 text-xs text-white underline hover:no-underline\"\n              >\n                Retry\n              </button>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Remove button */}\n      <button\n        type=\"button\"\n        onClick={onRemove}\n        className={cn(\n          'absolute -top-1 -right-1 z-10',\n          'rounded-full p-1',\n          'bg-neutral-900 text-white',\n          'opacity-0 group-hover:opacity-100',\n          'focus:ring-primary-500 focus:opacity-100 focus:ring-2 focus:outline-none',\n          'transition-opacity'\n        )}\n        aria-label={`Remove ${file.name}`}\n      >\n        <svg\n          className=\"h-3 w-3\"\n          fill=\"none\"\n          viewBox=\"0 0 24 24\"\n          stroke=\"currentColor\"\n        >\n          <path\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            strokeWidth={2}\n            d=\"M6 18L18 6M6 6l12 12\"\n          />\n        </svg>\n      </button>\n\n      {/* File name tooltip on hover */}\n      <div\n        className={cn(\n          'absolute right-0 bottom-0 left-0',\n          'bg-black/70 px-1 py-0.5',\n          'opacity-0 group-hover:opacity-100',\n          'transition-opacity'\n        )}\n      >\n        <p className=\"truncate text-xs text-white\">{file.name}</p>\n      </div>\n    </div>\n  );\n}\n\nAttachmentPreviewItem.displayName = 'AttachmentPreviewItem';\n\n// ============================================================================\n// Attachment Picker Component\n// ============================================================================\n\nexport interface AttachmentPickerProps {\n  /** Called when files are selected */\n  onFilesSelected: (files: File[]) => void;\n  /** Accepted file types (MIME types or extensions) */\n  acceptedTypes?: string[];\n  /** Maximum file size in bytes */\n  maxFileSize?: number;\n  /** Maximum number of files */\n  maxFiles?: number;\n  /** Whether multiple files can be selected */\n  multiple?: boolean;\n  /** Whether the picker is disabled */\n  disabled?: boolean;\n  /** Called when an error occurs */\n  onError?: (error: string) => void;\n  className?: string;\n  children?: React.ReactNode;\n}\n\n/**\n * A button/trigger component for selecting attachments.\n */\nconst AttachmentPicker = React.forwardRef<\n  HTMLInputElement,\n  AttachmentPickerProps\n>(\n  (\n    {\n      onFilesSelected,\n      acceptedTypes = ['image/*', 'video/*', '.pdf', '.doc', '.docx'],\n      maxFileSize = 25 * 1024 * 1024, // 25MB\n      maxFiles = 10,\n      multiple = true,\n      disabled = false,\n      onError,\n      className,\n      children,\n    },\n    ref\n  ) => {\n    const inputRef = React.useRef<HTMLInputElement>(null);\n\n    // Combine refs\n    React.useImperativeHandle(ref, () => inputRef.current!);\n\n    const handleClick = () => {\n      inputRef.current?.click();\n    };\n\n    const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n      const files = Array.from(event.target.files || []);\n      if (files.length === 0) return;\n\n      // Validate files\n      const validFiles: File[] = [];\n      for (const file of files.slice(0, maxFiles)) {\n        const validation = validateFile(file, acceptedTypes, maxFileSize);\n        if (validation.valid) {\n          validFiles.push(file);\n        } else if (onError) {\n          onError(`${file.name}: ${validation.error}`);\n        }\n      }\n\n      if (files.length > maxFiles && onError) {\n        onError(`Maximum ${maxFiles} files allowed`);\n      }\n\n      if (validFiles.length > 0) {\n        onFilesSelected(validFiles);\n      }\n\n      // Reset input\n      event.target.value = '';\n    };\n\n    return (\n      <>\n        <input\n          ref={inputRef}\n          type=\"file\"\n          accept={acceptedTypes.join(',')}\n          multiple={multiple}\n          onChange={handleChange}\n          disabled={disabled}\n          className=\"sr-only\"\n          aria-label=\"Select files to attach\"\n        />\n        <button\n          type=\"button\"\n          onClick={handleClick}\n          disabled={disabled}\n          className={cn(\n            'inline-flex items-center justify-center',\n            'rounded-full p-2',\n            'text-neutral-500 hover:text-neutral-700',\n            'dark:text-neutral-400 dark:hover:text-neutral-200',\n            'hover:bg-neutral-100 dark:hover:bg-neutral-800',\n            'focus:ring-primary-500 focus:ring-2 focus:outline-none',\n            'disabled:cursor-not-allowed disabled:opacity-50',\n            'transition-colors',\n            className\n          )}\n          aria-label=\"Attach files\"\n        >\n          {children || (\n            <svg\n              className=\"h-5 w-5\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              stroke=\"currentColor\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13\"\n              />\n            </svg>\n          )}\n        </button>\n      </>\n    );\n  }\n);\n\nAttachmentPicker.displayName = 'AttachmentPicker';\n\n// ============================================================================\n// Drag Drop Zone Component\n// ============================================================================\n\nexport interface DragDropZoneProps {\n  /** Called when files are dropped */\n  onFilesDropped: (files: File[]) => void;\n  /** Accepted file types */\n  acceptedTypes?: string[];\n  /** Maximum file size */\n  maxFileSize?: number;\n  /** Maximum number of files */\n  maxFiles?: number;\n  /** Whether the zone is disabled */\n  disabled?: boolean;\n  /** Called when an error occurs */\n  onError?: (error: string) => void;\n  /** Children to render inside the zone */\n  children: React.ReactNode;\n  className?: string;\n}\n\n/**\n * A wrapper component that accepts drag-and-drop files.\n */\nfunction DragDropZone({\n  onFilesDropped,\n  acceptedTypes,\n  maxFileSize,\n  maxFiles = 10,\n  disabled = false,\n  onError,\n  children,\n  className,\n}: DragDropZoneProps) {\n  const [isDragging, setIsDragging] = React.useState(false);\n  const dragCounterRef = React.useRef(0);\n\n  const handleDragEnter = (event: React.DragEvent) => {\n    event.preventDefault();\n    event.stopPropagation();\n    if (disabled) return;\n\n    dragCounterRef.current++;\n    if (event.dataTransfer.items && event.dataTransfer.items.length > 0) {\n      setIsDragging(true);\n    }\n  };\n\n  const handleDragLeave = (event: React.DragEvent) => {\n    event.preventDefault();\n    event.stopPropagation();\n    if (disabled) return;\n\n    dragCounterRef.current--;\n    if (dragCounterRef.current === 0) {\n      setIsDragging(false);\n    }\n  };\n\n  const handleDragOver = (event: React.DragEvent) => {\n    event.preventDefault();\n    event.stopPropagation();\n  };\n\n  const handleDrop = (event: React.DragEvent) => {\n    event.preventDefault();\n    event.stopPropagation();\n    if (disabled) return;\n\n    setIsDragging(false);\n    dragCounterRef.current = 0;\n\n    const files = Array.from(event.dataTransfer.files);\n    if (files.length === 0) return;\n\n    // Validate files\n    const validFiles: File[] = [];\n    for (const file of files.slice(0, maxFiles)) {\n      const validation = validateFile(file, acceptedTypes, maxFileSize);\n      if (validation.valid) {\n        validFiles.push(file);\n      } else if (onError) {\n        onError(`${file.name}: ${validation.error}`);\n      }\n    }\n\n    if (files.length > maxFiles && onError) {\n      onError(`Maximum ${maxFiles} files allowed`);\n    }\n\n    if (validFiles.length > 0) {\n      onFilesDropped(validFiles);\n    }\n  };\n\n  return (\n    <div\n      onDragEnter={handleDragEnter}\n      onDragLeave={handleDragLeave}\n      onDragOver={handleDragOver}\n      onDrop={handleDrop}\n      className={cn('relative', className)}\n    >\n      {children}\n\n      {/* Drag overlay */}\n      {isDragging && (\n        <div\n          className={cn(\n            'absolute inset-0 z-50',\n            'flex items-center justify-center',\n            'bg-primary-50/90 dark:bg-primary-900/90',\n            'border-primary-500 border-2 border-dashed',\n            'rounded-lg'\n          )}\n        >\n          <div className=\"text-center\">\n            <svg\n              className=\"text-primary-500 mx-auto h-12 w-12\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              stroke=\"currentColor\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12\"\n              />\n            </svg>\n            <p className=\"text-primary-700 dark:text-primary-300 mt-2 text-sm font-medium\">\n              Drop files here\n            </p>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nDragDropZone.displayName = 'DragDropZone';\n\n// ============================================================================\n// Camera Button Component (Mobile)\n// ============================================================================\n\nexport interface CameraButtonProps {\n  /** Called when a photo is captured */\n  onCapture: (file: File) => void;\n  /** Whether to use front camera */\n  useFrontCamera?: boolean;\n  /** Whether the button is disabled */\n  disabled?: boolean;\n  className?: string;\n}\n\n/**\n * Button to capture photos from camera (mobile).\n */\nfunction CameraButton({\n  onCapture,\n  useFrontCamera = false,\n  disabled = false,\n  className,\n}: CameraButtonProps) {\n  const inputRef = React.useRef<HTMLInputElement>(null);\n\n  const handleClick = () => {\n    inputRef.current?.click();\n  };\n\n  const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      onCapture(file);\n    }\n    event.target.value = '';\n  };\n\n  return (\n    <>\n      <input\n        ref={inputRef}\n        type=\"file\"\n        accept=\"image/*\"\n        capture={useFrontCamera ? 'user' : 'environment'}\n        onChange={handleChange}\n        disabled={disabled}\n        className=\"sr-only\"\n        aria-label=\"Take a photo\"\n      />\n      <button\n        type=\"button\"\n        onClick={handleClick}\n        disabled={disabled}\n        className={cn(\n          'inline-flex items-center justify-center',\n          'rounded-full p-2',\n          'text-neutral-500 hover:text-neutral-700',\n          'dark:text-neutral-400 dark:hover:text-neutral-200',\n          'hover:bg-neutral-100 dark:hover:bg-neutral-800',\n          'focus:ring-primary-500 focus:ring-2 focus:outline-none',\n          'disabled:cursor-not-allowed disabled:opacity-50',\n          'transition-colors',\n          className\n        )}\n        aria-label=\"Take a photo\"\n      >\n        <svg\n          className=\"h-5 w-5\"\n          fill=\"none\"\n          viewBox=\"0 0 24 24\"\n          stroke=\"currentColor\"\n        >\n          <path\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            strokeWidth={2}\n            d=\"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z\"\n          />\n          <path\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            strokeWidth={2}\n            d=\"M15 13a3 3 0 11-6 0 3 3 0 016 0z\"\n          />\n        </svg>\n      </button>\n    </>\n  );\n}\n\nCameraButton.displayName = 'CameraButton';\n\nexport {\n  AttachmentPicker,\n  AttachmentPreviewItem,\n  DragDropZone,\n  CameraButton,\n  getFileType,\n  formatFileSize,\n  validateFile,\n  generateAttachmentId,\n};\n","/* eslint-disable no-undef */\nimport * as React from 'react';\nimport { cva, type VariantProps } from 'class-variance-authority';\nimport { cn } from '../../utils/cn';\nimport type { AttachmentType, NewMessage } from './types';\nimport {\n  AttachmentPicker,\n  AttachmentPreviewItem,\n  CameraButton,\n  DragDropZone,\n  getFileType,\n  generateAttachmentId,\n} from './AttachmentPicker';\n\n// ============================================================================\n// Types\n// ============================================================================\n\ninterface PendingAttachment {\n  id: string;\n  file: File;\n  previewUrl?: string;\n  type: AttachmentType;\n  state: 'pending' | 'uploading' | 'uploaded' | 'failed';\n  progress?: number;\n  error?: string;\n}\n\n// ============================================================================\n// Character Counter Component\n// ============================================================================\n\nexport interface CharacterCounterProps {\n  current: number;\n  max: number;\n  showWarningAt?: number;\n  className?: string;\n}\n\n/**\n * Displays character count with warning colors.\n */\nfunction CharacterCounter({\n  current,\n  max,\n  showWarningAt = 0.9,\n  className,\n}: CharacterCounterProps) {\n  const percentage = current / max;\n  const isWarning = percentage >= showWarningAt && percentage < 1;\n  const isOver = current > max;\n\n  return (\n    <span\n      className={cn(\n        'text-xs tabular-nums',\n        isOver\n          ? 'font-medium text-red-500'\n          : isWarning\n            ? 'text-amber-500'\n            : 'text-neutral-400',\n        className\n      )}\n      aria-live=\"polite\"\n      aria-label={`${current} of ${max} characters`}\n    >\n      {current}/{max}\n    </span>\n  );\n}\n\nCharacterCounter.displayName = 'CharacterCounter';\n\n// ============================================================================\n// Send Button Component\n// ============================================================================\n\nconst sendButtonVariants = cva(\n  [\n    'inline-flex items-center justify-center',\n    'rounded-full p-2.5',\n    'transition-all duration-200',\n    'focus:outline-none focus:ring-2 focus:ring-primary-500',\n    'disabled:opacity-50 disabled:cursor-not-allowed',\n  ],\n  {\n    variants: {\n      variant: {\n        primary: [\n          'bg-primary-800 text-white',\n          'hover:bg-primary-700',\n          'active:scale-95',\n        ],\n        subtle: [\n          'bg-transparent text-primary-600',\n          'hover:bg-primary-50 dark:hover:bg-primary-900/20',\n        ],\n      },\n      canSend: {\n        true: '',\n        false: 'opacity-50 cursor-not-allowed',\n      },\n    },\n    defaultVariants: {\n      variant: 'primary',\n      canSend: false,\n    },\n  }\n);\n\nexport interface SendButtonProps\n  extends\n    React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof sendButtonVariants> {\n  isLoading?: boolean;\n}\n\n/**\n * Send button with loading state.\n */\nconst SendButton = React.forwardRef<HTMLButtonElement, SendButtonProps>(\n  ({ className, variant, canSend, isLoading, disabled, ...props }, ref) => {\n    return (\n      <button\n        ref={ref}\n        type=\"submit\"\n        disabled={disabled || !canSend || isLoading}\n        className={cn(sendButtonVariants({ variant, canSend }), className)}\n        aria-label={isLoading ? 'Sending message' : 'Send message'}\n        {...props}\n      >\n        {isLoading ? (\n          <svg className=\"h-5 w-5 animate-spin\" fill=\"none\" viewBox=\"0 0 24 24\">\n            <circle\n              className=\"opacity-25\"\n              cx=\"12\"\n              cy=\"12\"\n              r=\"10\"\n              stroke=\"currentColor\"\n              strokeWidth=\"4\"\n            />\n            <path\n              className=\"opacity-75\"\n              fill=\"currentColor\"\n              d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z\"\n            />\n          </svg>\n        ) : (\n          <svg\n            className=\"h-5 w-5\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            stroke=\"currentColor\"\n          >\n            <path\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth={2}\n              d=\"M12 19l9 2-9-18-9 18 9-2zm0 0v-8\"\n            />\n          </svg>\n        )}\n      </button>\n    );\n  }\n);\n\nSendButton.displayName = 'SendButton';\n\n// ============================================================================\n// Message Composer Component\n// ============================================================================\n\nexport interface MessageComposerProps {\n  /** Called when a message is sent */\n  onSend: (message: NewMessage) => void | Promise<void>;\n  /** Called when the user starts typing */\n  onTypingStart?: () => void;\n  /** Called when the user stops typing */\n  onTypingStop?: () => void;\n  /** Placeholder text */\n  placeholder?: string;\n  /** Maximum message length */\n  maxLength?: number;\n  /** Show character count */\n  showCharacterCount?: boolean;\n  /** Whether the composer is disabled */\n  disabled?: boolean;\n  /** Whether a message is currently being sent */\n  isSending?: boolean;\n  /** Show attachment picker */\n  showAttachmentPicker?: boolean;\n  /** Show camera button (mobile) */\n  showCameraButton?: boolean;\n  /** Accepted file types */\n  acceptedFileTypes?: string[];\n  /** Maximum file size */\n  maxFileSize?: number;\n  /** Maximum number of attachments */\n  maxAttachments?: number;\n  /** Called when an error occurs */\n  onError?: (error: string) => void;\n  /** Auto-focus the input */\n  autoFocus?: boolean;\n  /** Reply-to message reference */\n  replyTo?: {\n    id: string;\n    content: string;\n    senderName: string;\n  } | null;\n  /** Called when reply is cancelled */\n  onCancelReply?: () => void;\n  /** Additional class name */\n  className?: string;\n}\n\n/**\n * A message input component with attachment support and send button.\n *\n * @example\n * ```tsx\n * <MessageComposer\n *   onSend={handleSend}\n *   placeholder=\"Type a message...\"\n *   showAttachmentPicker\n *   maxLength={1600}\n * />\n * ```\n */\nconst MessageComposer = React.forwardRef<\n  HTMLTextAreaElement,\n  MessageComposerProps\n>(\n  (\n    {\n      onSend,\n      onTypingStart,\n      onTypingStop,\n      placeholder = 'Type a message...',\n      maxLength = 1600,\n      showCharacterCount = false,\n      disabled = false,\n      isSending = false,\n      showAttachmentPicker = true,\n      showCameraButton = false,\n      acceptedFileTypes = ['image/*', 'video/*', '.pdf', '.doc', '.docx'],\n      maxFileSize = 25 * 1024 * 1024,\n      maxAttachments = 10,\n      onError,\n      autoFocus = false,\n      replyTo = null,\n      onCancelReply,\n      className,\n    },\n    ref\n  ) => {\n    const textareaRef = React.useRef<HTMLTextAreaElement>(null);\n    const [content, setContent] = React.useState('');\n    const [attachments, setAttachments] = React.useState<PendingAttachment[]>(\n      []\n    );\n    const [isTyping, setIsTyping] = React.useState(false);\n    const typingTimeoutRef = React.useRef<NodeJS.Timeout | null>(null);\n\n    // Combine refs\n    React.useImperativeHandle(ref, () => textareaRef.current!);\n\n    // Auto-resize textarea\n    React.useEffect(() => {\n      const textarea = textareaRef.current;\n      if (textarea) {\n        textarea.style.height = 'auto';\n        textarea.style.height = `${Math.min(textarea.scrollHeight, 150)}px`;\n      }\n    }, [content]);\n\n    // Handle typing indicators\n    React.useEffect(() => {\n      if (content.length > 0 && !isTyping) {\n        setIsTyping(true);\n        onTypingStart?.();\n      }\n\n      // Clear previous timeout\n      if (typingTimeoutRef.current) {\n        clearTimeout(typingTimeoutRef.current);\n      }\n\n      // Set timeout to stop typing indicator\n      typingTimeoutRef.current = setTimeout(() => {\n        if (isTyping) {\n          setIsTyping(false);\n          onTypingStop?.();\n        }\n      }, 2000);\n\n      return () => {\n        if (typingTimeoutRef.current) {\n          clearTimeout(typingTimeoutRef.current);\n        }\n      };\n    }, [content, isTyping, onTypingStart, onTypingStop]);\n\n    // Focus on mount if autoFocus\n    React.useEffect(() => {\n      if (autoFocus) {\n        textareaRef.current?.focus();\n      }\n    }, [autoFocus]);\n\n    // Focus when reply is set\n    React.useEffect(() => {\n      if (replyTo) {\n        textareaRef.current?.focus();\n      }\n    }, [replyTo]);\n\n    const canSend =\n      (content.trim().length > 0 || attachments.length > 0) &&\n      content.length <= maxLength &&\n      !disabled &&\n      !isSending;\n\n    const handleSubmit = async (event: React.FormEvent) => {\n      event.preventDefault();\n      if (!canSend) return;\n\n      const message: NewMessage = {\n        content: content.trim(),\n        attachments: attachments.map((a) => a.file),\n        replyToId: replyTo?.id,\n      };\n\n      // Clear state before sending for optimistic UI\n      setContent('');\n      setAttachments([]);\n      setIsTyping(false);\n      onTypingStop?.();\n\n      try {\n        await onSend(message);\n      } catch {\n        // Restore content on failure\n        setContent(message.content);\n        // Note: attachments would need to be re-added manually\n        onError?.('Failed to send message');\n      }\n    };\n\n    const handleKeyDown = (event: React.KeyboardEvent<HTMLTextAreaElement>) => {\n      // Send on Enter (without Shift)\n      if (event.key === 'Enter' && !event.shiftKey) {\n        event.preventDefault();\n        if (canSend) {\n          handleSubmit(event);\n        }\n      }\n    };\n\n    const handleFilesSelected = (files: File[]) => {\n      const remainingSlots = maxAttachments - attachments.length;\n      const filesToAdd = files.slice(0, remainingSlots);\n\n      if (files.length > remainingSlots) {\n        onError?.(`Maximum ${maxAttachments} attachments allowed`);\n      }\n\n      const newAttachments: PendingAttachment[] = filesToAdd.map((file) => {\n        const type = getFileType(file.type);\n        let previewUrl: string | undefined;\n\n        if (type === 'image' || type === 'video') {\n          previewUrl = URL.createObjectURL(file);\n        }\n\n        return {\n          id: generateAttachmentId(),\n          file,\n          previewUrl,\n          type,\n          state: 'pending' as const,\n        };\n      });\n\n      setAttachments((prev) => [...prev, ...newAttachments]);\n    };\n\n    const handleRemoveAttachment = (attachmentId: string) => {\n      setAttachments((prev) => {\n        const attachment = prev.find((a) => a.id === attachmentId);\n        if (attachment?.previewUrl) {\n          URL.revokeObjectURL(attachment.previewUrl);\n        }\n        return prev.filter((a) => a.id !== attachmentId);\n      });\n    };\n\n    // Cleanup preview URLs on unmount\n    React.useEffect(() => {\n      // Capture current attachments for cleanup\n      const currentAttachments = attachments;\n      return () => {\n        currentAttachments.forEach((a) => {\n          if (a.previewUrl) {\n            URL.revokeObjectURL(a.previewUrl);\n          }\n        });\n      };\n    }, [attachments]);\n\n    return (\n      <DragDropZone\n        onFilesDropped={handleFilesSelected}\n        acceptedTypes={acceptedFileTypes}\n        maxFileSize={maxFileSize}\n        maxFiles={maxAttachments - attachments.length}\n        disabled={disabled || attachments.length >= maxAttachments}\n        onError={onError}\n        className={cn('w-full', className)}\n      >\n        <form onSubmit={handleSubmit} className=\"w-full\">\n          {/* Reply preview */}\n          {replyTo && (\n            <div\n              className={cn(\n                'flex items-center gap-2 px-4 py-2',\n                'bg-neutral-50 dark:bg-neutral-800/50',\n                'border-primary-500 border-l-4'\n              )}\n            >\n              <div className=\"min-w-0 flex-1\">\n                <span className=\"text-primary-600 dark:text-primary-400 text-xs font-medium\">\n                  Replying to {replyTo.senderName}\n                </span>\n                <p className=\"truncate text-sm text-neutral-600 dark:text-neutral-300\">\n                  {replyTo.content}\n                </p>\n              </div>\n              <button\n                type=\"button\"\n                onClick={onCancelReply}\n                className={cn(\n                  'shrink-0 rounded p-1',\n                  'text-neutral-400 hover:text-neutral-600',\n                  'dark:text-neutral-500 dark:hover:text-neutral-300',\n                  'focus:ring-primary-500 focus:ring-2 focus:outline-none'\n                )}\n                aria-label=\"Cancel reply\"\n              >\n                <svg\n                  className=\"h-4 w-4\"\n                  fill=\"none\"\n                  viewBox=\"0 0 24 24\"\n                  stroke=\"currentColor\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth={2}\n                    d=\"M6 18L18 6M6 6l12 12\"\n                  />\n                </svg>\n              </button>\n            </div>\n          )}\n\n          {/* Attachment previews */}\n          {attachments.length > 0 && (\n            <div\n              className={cn(\n                'flex flex-wrap gap-2 p-3',\n                'border-t border-neutral-200 dark:border-neutral-700'\n              )}\n            >\n              {attachments.map((attachment) => (\n                <AttachmentPreviewItem\n                  key={attachment.id}\n                  attachment={attachment}\n                  onRemove={() => handleRemoveAttachment(attachment.id)}\n                />\n              ))}\n            </div>\n          )}\n\n          {/* Input area */}\n          <div\n            className={cn(\n              'flex items-end gap-2 p-3',\n              'bg-white dark:bg-neutral-900',\n              'border-t border-neutral-200 dark:border-neutral-700'\n            )}\n          >\n            {/* Attachment buttons */}\n            {showAttachmentPicker && (\n              <AttachmentPicker\n                onFilesSelected={handleFilesSelected}\n                acceptedTypes={acceptedFileTypes}\n                maxFileSize={maxFileSize}\n                maxFiles={maxAttachments - attachments.length}\n                disabled={disabled || attachments.length >= maxAttachments}\n                onError={onError}\n              />\n            )}\n\n            {showCameraButton && (\n              <CameraButton\n                onCapture={(file) => handleFilesSelected([file])}\n                disabled={disabled || attachments.length >= maxAttachments}\n              />\n            )}\n\n            {/* Text input */}\n            <div className=\"relative flex-1\">\n              <textarea\n                ref={textareaRef}\n                value={content}\n                onChange={(e) => setContent(e.target.value)}\n                onKeyDown={handleKeyDown}\n                placeholder={placeholder}\n                disabled={disabled || isSending}\n                rows={1}\n                className={cn(\n                  'w-full resize-none rounded-2xl px-4 py-2.5',\n                  'bg-neutral-100 dark:bg-neutral-800',\n                  'text-neutral-900 dark:text-neutral-100',\n                  'placeholder:text-neutral-400 dark:placeholder:text-neutral-500',\n                  'focus:ring-primary-500 focus:ring-2 focus:outline-none',\n                  'disabled:cursor-not-allowed disabled:opacity-50',\n                  'transition-colors',\n                  'max-h-[150px]'\n                )}\n                aria-label=\"Message\"\n                aria-describedby={showCharacterCount ? 'char-count' : undefined}\n              />\n\n              {/* Character count */}\n              {showCharacterCount && (\n                <div id=\"char-count\" className=\"absolute right-3 bottom-1.5\">\n                  <CharacterCounter current={content.length} max={maxLength} />\n                </div>\n              )}\n            </div>\n\n            {/* Send button */}\n            <SendButton\n              canSend={canSend}\n              isLoading={isSending}\n              disabled={disabled}\n            />\n          </div>\n        </form>\n      </DragDropZone>\n    );\n  }\n);\n\nMessageComposer.displayName = 'MessageComposer';\n\nexport { MessageComposer, CharacterCounter, SendButton, sendButtonVariants };\n","import * as React from 'react';\nimport { cva, type VariantProps } from 'class-variance-authority';\nimport { cn } from '../../utils/cn';\nimport type {\n  Message,\n  MessageStatus,\n  MessageAttachment,\n  ReadReceipt,\n} from './types';\n\n// ============================================================================\n// Message Status Icon Component\n// ============================================================================\n\nconst statusIconVariants = cva(\n  'inline-flex items-center gap-0.5 text-current',\n  {\n    variants: {\n      status: {\n        sending: 'text-neutral-400',\n        sent: 'text-neutral-500',\n        delivered: 'text-neutral-600 dark:text-neutral-400',\n        read: 'text-primary-600 dark:text-primary-400',\n        failed: 'text-red-500',\n      },\n    },\n    defaultVariants: {\n      status: 'sent',\n    },\n  }\n);\n\nexport interface MessageStatusIconProps {\n  status: MessageStatus;\n  className?: string;\n}\n\n/**\n * Visual status indicator for messages (checkmarks).\n */\nfunction MessageStatusIcon({ status, className }: MessageStatusIconProps) {\n  return (\n    <span\n      className={cn(statusIconVariants({ status }), className)}\n      role=\"img\"\n      aria-label={`Message ${status}`}\n    >\n      {status === 'sending' && (\n        <svg\n          className=\"h-3.5 w-3.5 animate-spin\"\n          fill=\"none\"\n          viewBox=\"0 0 24 24\"\n        >\n          <circle\n            className=\"opacity-25\"\n            cx=\"12\"\n            cy=\"12\"\n            r=\"10\"\n            stroke=\"currentColor\"\n            strokeWidth=\"4\"\n          />\n          <path\n            className=\"opacity-75\"\n            fill=\"currentColor\"\n            d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z\"\n          />\n        </svg>\n      )}\n      {status === 'sent' && (\n        <svg\n          className=\"h-3.5 w-3.5\"\n          fill=\"none\"\n          viewBox=\"0 0 24 24\"\n          stroke=\"currentColor\"\n          strokeWidth=\"2\"\n        >\n          <path\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            d=\"M5 13l4 4L19 7\"\n          />\n        </svg>\n      )}\n      {(status === 'delivered' || status === 'read') && (\n        <svg\n          className=\"h-4 w-4\"\n          fill=\"none\"\n          viewBox=\"0 0 24 24\"\n          stroke=\"currentColor\"\n          strokeWidth=\"2\"\n        >\n          <path\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            d=\"M5 13l4 4L19 7\"\n          />\n          <path\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            d=\"M12 13l4 4L26 7\"\n            transform=\"translate(-5, 0)\"\n          />\n        </svg>\n      )}\n      {status === 'failed' && (\n        <svg\n          className=\"h-3.5 w-3.5\"\n          fill=\"none\"\n          viewBox=\"0 0 24 24\"\n          stroke=\"currentColor\"\n          strokeWidth=\"2\"\n        >\n          <path\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\"\n          />\n        </svg>\n      )}\n    </span>\n  );\n}\n\n// ============================================================================\n// Read Receipt Indicator Component\n// ============================================================================\n\nexport interface ReadReceiptIndicatorProps {\n  /** Read receipts to display */\n  receipts: ReadReceipt[];\n  /** Maximum avatars to show before +N */\n  maxAvatars?: number;\n  /** Size of avatars */\n  size?: 'xs' | 'sm';\n  className?: string;\n}\n\n/**\n * Displays read receipt avatars for group conversations.\n */\nfunction ReadReceiptIndicator({\n  receipts,\n  maxAvatars = 3,\n  size = 'xs',\n  className,\n}: ReadReceiptIndicatorProps) {\n  if (receipts.length === 0) return null;\n\n  const visibleReceipts = receipts.slice(0, maxAvatars);\n  const remainingCount = receipts.length - maxAvatars;\n\n  const sizeClasses = {\n    xs: 'h-4 w-4 text-[8px]',\n    sm: 'h-5 w-5 text-[10px]',\n  };\n\n  return (\n    <div\n      className={cn('flex items-center -space-x-1', className)}\n      aria-label={`Read by ${receipts.map((r) => r.participant.name).join(', ')}`}\n    >\n      {visibleReceipts.map((receipt) => (\n        <div\n          key={receipt.participant.id}\n          className={cn(\n            'rounded-full ring-2 ring-white dark:ring-neutral-900',\n            'bg-primary-800 font-medium text-white',\n            'flex items-center justify-center',\n            sizeClasses[size]\n          )}\n          title={`Read by ${receipt.participant.name}`}\n        >\n          {receipt.participant.avatarUrl ? (\n            <img\n              src={receipt.participant.avatarUrl}\n              alt={receipt.participant.name}\n              className=\"h-full w-full rounded-full object-cover\"\n            />\n          ) : (\n            receipt.participant.name.charAt(0).toUpperCase()\n          )}\n        </div>\n      ))}\n      {remainingCount > 0 && (\n        <div\n          className={cn(\n            'rounded-full ring-2 ring-white dark:ring-neutral-900',\n            'bg-neutral-500 font-medium text-white',\n            'flex items-center justify-center',\n            sizeClasses[size]\n          )}\n        >\n          +{remainingCount}\n        </div>\n      )}\n    </div>\n  );\n}\n\n// ============================================================================\n// Message Attachment Preview Component\n// ============================================================================\n\nexport interface AttachmentPreviewProps {\n  attachment: MessageAttachment;\n  onClick?: () => void;\n  className?: string;\n}\n\n/**\n * Renders an attachment preview within a message bubble.\n */\nfunction AttachmentPreview({\n  attachment,\n  onClick,\n  className,\n}: AttachmentPreviewProps) {\n  const isImage = attachment.type === 'image';\n  const isVideo = attachment.type === 'video';\n\n  if (isImage || isVideo) {\n    return (\n      <button\n        type=\"button\"\n        onClick={onClick}\n        className={cn(\n          'relative block overflow-hidden rounded-lg',\n          'focus:ring-primary-500 focus:ring-2 focus:outline-none',\n          'transition-transform hover:scale-[1.02]',\n          className\n        )}\n        aria-label={`View ${attachment.alt || attachment.filename}`}\n      >\n        <img\n          src={attachment.thumbnailUrl || attachment.url}\n          alt={attachment.alt || attachment.filename}\n          className=\"max-h-64 w-auto rounded-lg object-cover\"\n          loading=\"lazy\"\n        />\n        {isVideo && (\n          <div className=\"absolute inset-0 flex items-center justify-center bg-black/30\">\n            <div className=\"rounded-full bg-white/90 p-3\">\n              <svg\n                className=\"h-6 w-6 text-neutral-900\"\n                fill=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n              >\n                <path d=\"M8 5v14l11-7z\" />\n              </svg>\n            </div>\n          </div>\n        )}\n        {attachment.state === 'uploading' &&\n          attachment.progress !== undefined && (\n            <div className=\"absolute inset-0 flex items-center justify-center bg-black/50\">\n              <div className=\"text-center text-white\">\n                <svg\n                  className=\"mx-auto h-8 w-8 animate-spin\"\n                  fill=\"none\"\n                  viewBox=\"0 0 24 24\"\n                >\n                  <circle\n                    className=\"opacity-25\"\n                    cx=\"12\"\n                    cy=\"12\"\n                    r=\"10\"\n                    stroke=\"currentColor\"\n                    strokeWidth=\"4\"\n                  />\n                  <path\n                    className=\"opacity-75\"\n                    fill=\"currentColor\"\n                    d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z\"\n                  />\n                </svg>\n                <span className=\"mt-1 text-sm\">{attachment.progress}%</span>\n              </div>\n            </div>\n          )}\n        {attachment.state === 'failed' && (\n          <div className=\"absolute inset-0 flex items-center justify-center bg-black/50\">\n            <div className=\"text-center text-white\">\n              <svg\n                className=\"mx-auto h-8 w-8 text-red-400\"\n                fill=\"none\"\n                viewBox=\"0 0 24 24\"\n                stroke=\"currentColor\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\"\n                />\n              </svg>\n              <span className=\"mt-1 text-sm\">Upload failed</span>\n            </div>\n          </div>\n        )}\n      </button>\n    );\n  }\n\n  // File/document attachment\n  return (\n    <button\n      type=\"button\"\n      onClick={onClick}\n      className={cn(\n        'flex items-center gap-3 rounded-lg p-3',\n        'bg-white/10 hover:bg-white/20',\n        'transition-colors',\n        'focus:ring-primary-500 focus:ring-2 focus:outline-none',\n        className\n      )}\n    >\n      <div className=\"rounded-lg bg-white/20 p-2\">\n        <svg\n          className=\"h-6 w-6\"\n          fill=\"none\"\n          viewBox=\"0 0 24 24\"\n          stroke=\"currentColor\"\n        >\n          <path\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            strokeWidth={2}\n            d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\n          />\n        </svg>\n      </div>\n      <div className=\"min-w-0 flex-1 text-left\">\n        <p className=\"truncate text-sm font-medium\">{attachment.filename}</p>\n        <p className=\"text-xs opacity-70\">{formatFileSize(attachment.size)}</p>\n      </div>\n    </button>\n  );\n}\n\n/**\n * Format file size in human-readable format.\n */\nfunction formatFileSize(bytes: number): string {\n  if (bytes < 1024) return `${bytes} B`;\n  if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;\n  return `${(bytes / (1024 * 1024)).toFixed(1)} MB`;\n}\n\n// ============================================================================\n// Message Bubble Component\n// ============================================================================\n\nconst bubbleVariants = cva(\n  [\n    'relative max-w-[85%] sm:max-w-[70%]',\n    'rounded-2xl px-4 py-2',\n    'transition-all duration-200',\n  ],\n  {\n    variants: {\n      variant: {\n        outgoing: ['bg-primary-800 text-white', 'rounded-br-md', 'ml-auto'],\n        incoming: [\n          'bg-neutral-100 text-neutral-900',\n          'dark:bg-neutral-800 dark:text-neutral-100',\n          'rounded-bl-md',\n          'mr-auto',\n        ],\n        system: [\n          'mx-auto max-w-none',\n          'bg-transparent text-neutral-500 dark:text-neutral-400',\n          'text-center text-sm',\n          'py-1 px-2',\n        ],\n      },\n      status: {\n        sending: 'opacity-70',\n        sent: '',\n        delivered: '',\n        read: '',\n        failed: 'ring-2 ring-red-500/50',\n      },\n    },\n    defaultVariants: {\n      variant: 'incoming',\n      status: 'sent',\n    },\n  }\n);\n\nexport interface MessageBubbleProps\n  extends\n    Omit<React.HTMLAttributes<HTMLDivElement>, 'id'>,\n    VariantProps<typeof bubbleVariants> {\n  /** The message to display */\n  message: Message;\n  /** Whether to show the sender's avatar */\n  showAvatar?: boolean;\n  /** Whether to show the sender's name (for group chats) */\n  showSenderName?: boolean;\n  /** Whether to show the timestamp */\n  showTimestamp?: boolean;\n  /** Whether to show message status */\n  showStatus?: boolean;\n  /** Whether to show read receipts */\n  showReadReceipts?: boolean;\n  /** Called when retry is clicked for failed messages */\n  onRetry?: () => void;\n  /** Called when an attachment is clicked */\n  onAttachmentClick?: (attachment: MessageAttachment) => void;\n  /** Whether this is the current user's message */\n  isOutgoing?: boolean;\n  /** Custom timestamp formatter */\n  formatTimestamp?: (timestamp: Date | string) => string;\n}\n\n/**\n * Default timestamp formatter.\n */\nfunction defaultFormatTimestamp(timestamp: Date | string): string {\n  const date = typeof timestamp === 'string' ? new Date(timestamp) : timestamp;\n  return date.toLocaleTimeString(undefined, {\n    hour: 'numeric',\n    minute: '2-digit',\n  });\n}\n\n/**\n * A message bubble component for displaying individual messages.\n *\n * @example\n * ```tsx\n * <MessageBubble\n *   message={message}\n *   isOutgoing={message.sender.isCurrentUser}\n *   showAvatar\n *   showTimestamp\n * />\n * ```\n */\nconst MessageBubble = React.forwardRef<HTMLDivElement, MessageBubbleProps>(\n  (\n    {\n      className,\n      message,\n      showAvatar = false,\n      showSenderName = false,\n      showTimestamp = true,\n      showStatus = true,\n      showReadReceipts = true,\n      onRetry,\n      onAttachmentClick,\n      isOutgoing,\n      formatTimestamp = defaultFormatTimestamp,\n      ...props\n    },\n    ref\n  ) => {\n    const isSystem = message.type === 'system';\n    const variant = isSystem ? 'system' : isOutgoing ? 'outgoing' : 'incoming';\n\n    const hasAttachments =\n      message.attachments && message.attachments.length > 0;\n    const hasText = message.content && message.content.trim().length > 0;\n    const isFailed = message.status === 'failed';\n\n    // System messages render differently\n    if (isSystem) {\n      return (\n        <div\n          ref={ref}\n          className={cn(bubbleVariants({ variant: 'system' }), className)}\n          role=\"status\"\n          aria-live=\"polite\"\n          {...props}\n        >\n          {message.content}\n        </div>\n      );\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          'group flex items-end gap-2',\n          isOutgoing ? 'flex-row-reverse' : 'flex-row',\n          className\n        )}\n        {...props}\n      >\n        {/* Avatar */}\n        {showAvatar && !isOutgoing && (\n          <div className=\"mb-1 shrink-0\">\n            <div\n              className={cn(\n                'flex h-8 w-8 items-center justify-center rounded-full',\n                'bg-primary-800 text-sm font-medium text-white'\n              )}\n            >\n              {message.sender.avatarUrl ? (\n                <img\n                  src={message.sender.avatarUrl}\n                  alt={message.sender.name}\n                  className=\"h-full w-full rounded-full object-cover\"\n                />\n              ) : (\n                message.sender.name.charAt(0).toUpperCase()\n              )}\n            </div>\n          </div>\n        )}\n\n        {/* Message content container */}\n        <div\n          className={cn(\n            'flex flex-col',\n            isOutgoing ? 'items-end' : 'items-start'\n          )}\n        >\n          {/* Sender name (for group chats) */}\n          {showSenderName && !isOutgoing && (\n            <span className=\"mb-1 px-1 text-xs font-medium text-neutral-500 dark:text-neutral-400\">\n              {message.sender.name}\n            </span>\n          )}\n\n          {/* Reply preview */}\n          {message.replyTo && (\n            <div\n              className={cn(\n                'mb-1 max-w-full rounded-lg px-3 py-1.5 text-xs',\n                isOutgoing\n                  ? 'bg-primary-700/50 text-white/80'\n                  : 'bg-neutral-200 text-neutral-600 dark:bg-neutral-700 dark:text-neutral-300'\n              )}\n            >\n              <span className=\"font-medium\">{message.replyTo.sender.name}</span>\n              <p className=\"truncate\">{message.replyTo.content}</p>\n            </div>\n          )}\n\n          {/* Bubble */}\n          <div\n            className={cn(bubbleVariants({ variant, status: message.status }))}\n            role=\"article\"\n            aria-label={`Message from ${message.sender.name}`}\n          >\n            {/* Attachments */}\n            {hasAttachments && (\n              <div className={cn('space-y-2', hasText && 'mb-2')}>\n                {message.attachments!.map((attachment) => (\n                  <AttachmentPreview\n                    key={attachment.id}\n                    attachment={attachment}\n                    onClick={() => onAttachmentClick?.(attachment)}\n                  />\n                ))}\n              </div>\n            )}\n\n            {/* Text content */}\n            {hasText && (\n              <p className=\"break-words whitespace-pre-wrap\">\n                {message.isDeleted ? (\n                  <span className=\"italic opacity-60\">\n                    This message was deleted\n                  </span>\n                ) : (\n                  message.content\n                )}\n              </p>\n            )}\n\n            {/* Edited indicator */}\n            {message.isEdited && !message.isDeleted && (\n              <span className=\"ml-1 text-xs opacity-60\">(edited)</span>\n            )}\n          </div>\n\n          {/* Footer: timestamp, status, read receipts */}\n          <div\n            className={cn(\n              'mt-1 flex items-center gap-2 px-1',\n              isOutgoing ? 'flex-row-reverse' : 'flex-row'\n            )}\n          >\n            {showTimestamp && (\n              <span className=\"text-xs text-neutral-400 dark:text-neutral-500\">\n                {formatTimestamp(message.timestamp)}\n              </span>\n            )}\n\n            {showStatus && isOutgoing && (\n              <MessageStatusIcon status={message.status} />\n            )}\n\n            {showReadReceipts &&\n              isOutgoing &&\n              message.readReceipts &&\n              message.readReceipts.length > 0 && (\n                <ReadReceiptIndicator receipts={message.readReceipts} />\n              )}\n\n            {/* Retry button for failed messages */}\n            {isFailed && onRetry && (\n              <button\n                type=\"button\"\n                onClick={onRetry}\n                className={cn(\n                  'flex items-center gap-1 rounded px-2 py-0.5',\n                  'text-xs font-medium text-red-500',\n                  'hover:bg-red-50 dark:hover:bg-red-900/20',\n                  'focus:ring-2 focus:ring-red-500 focus:outline-none'\n                )}\n                aria-label=\"Retry sending message\"\n              >\n                <svg\n                  className=\"h-3 w-3\"\n                  fill=\"none\"\n                  viewBox=\"0 0 24 24\"\n                  stroke=\"currentColor\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth={2}\n                    d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"\n                  />\n                </svg>\n                Retry\n              </button>\n            )}\n          </div>\n\n          {/* Reactions */}\n          {message.reactions && message.reactions.length > 0 && (\n            <div\n              className={cn(\n                '-mt-1 flex flex-wrap gap-1',\n                isOutgoing ? 'justify-end' : 'justify-start'\n              )}\n            >\n              {message.reactions.map((reaction) => (\n                <span\n                  key={reaction.emoji}\n                  className={cn(\n                    'inline-flex items-center gap-1 rounded-full px-2 py-0.5',\n                    'bg-neutral-100 text-xs dark:bg-neutral-800',\n                    'border border-neutral-200 dark:border-neutral-700'\n                  )}\n                  title={reaction.participants.map((p) => p.name).join(', ')}\n                >\n                  <span>{reaction.emoji}</span>\n                  {reaction.count > 1 && (\n                    <span className=\"text-neutral-500\">{reaction.count}</span>\n                  )}\n                </span>\n              ))}\n            </div>\n          )}\n        </div>\n\n        {/* Spacer for avatar alignment when showing own messages */}\n        {showAvatar && isOutgoing && <div className=\"w-8 shrink-0\" />}\n      </div>\n    );\n  }\n);\n\nMessageBubble.displayName = 'MessageBubble';\n\nexport {\n  MessageBubble,\n  MessageStatusIcon,\n  ReadReceiptIndicator,\n  AttachmentPreview,\n  bubbleVariants,\n  formatFileSize,\n};\n","import * as React from 'react';\nimport { cn } from '../../utils/cn';\nimport type {\n  Message,\n  MessageGroup,\n  MessageParticipant,\n  MessageAttachment,\n  TypingState,\n} from './types';\nimport { MessageBubble } from './MessageBubble';\n\n// ============================================================================\n// Utility Functions\n// ============================================================================\n\n/**\n * Groups messages by date.\n */\nfunction groupMessagesByDate(messages: Message[]): MessageGroup[] {\n  const groups: Map<string, Message[]> = new Map();\n\n  messages.forEach((message) => {\n    const date = new Date(message.timestamp);\n    const dateKey = date.toDateString();\n    const existing = groups.get(dateKey) || [];\n    groups.set(dateKey, [...existing, message]);\n  });\n\n  return Array.from(groups.entries()).map(([dateKey, msgs]) => ({\n    date: dateKey,\n    label: formatDateLabel(new Date(dateKey)),\n    messages: msgs,\n  }));\n}\n\n/**\n * Format date label for message grouping.\n */\nfunction formatDateLabel(date: Date): string {\n  const now = new Date();\n  const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n  const yesterday = new Date(today);\n  yesterday.setDate(yesterday.getDate() - 1);\n  const messageDate = new Date(\n    date.getFullYear(),\n    date.getMonth(),\n    date.getDate()\n  );\n\n  if (messageDate.getTime() === today.getTime()) {\n    return 'Today';\n  }\n  if (messageDate.getTime() === yesterday.getTime()) {\n    return 'Yesterday';\n  }\n\n  // Check if same year\n  if (date.getFullYear() === now.getFullYear()) {\n    return date.toLocaleDateString(undefined, {\n      weekday: 'long',\n      month: 'long',\n      day: 'numeric',\n    });\n  }\n\n  return date.toLocaleDateString(undefined, {\n    weekday: 'long',\n    month: 'long',\n    day: 'numeric',\n    year: 'numeric',\n  });\n}\n\n/**\n * Check if two messages are from the same sender within a time threshold.\n */\nfunction isSameSenderGroup(\n  prev: Message | undefined,\n  current: Message,\n  thresholdMinutes: number = 5\n): boolean {\n  if (!prev) return false;\n  if (prev.sender.id !== current.sender.id) return false;\n  if (prev.type === 'system' || current.type === 'system') return false;\n\n  const prevTime = new Date(prev.timestamp).getTime();\n  const currentTime = new Date(current.timestamp).getTime();\n  const diffMinutes = (currentTime - prevTime) / (1000 * 60);\n\n  return diffMinutes < thresholdMinutes;\n}\n\n// ============================================================================\n// Skeleton Message Component\n// ============================================================================\n\nexport interface SkeletonMessageProps {\n  isOutgoing?: boolean;\n  showAvatar?: boolean;\n  className?: string;\n}\n\n/**\n * A skeleton placeholder for loading messages.\n */\nfunction SkeletonMessage({\n  isOutgoing = false,\n  showAvatar = true,\n  className,\n}: SkeletonMessageProps) {\n  return (\n    <div\n      className={cn(\n        'flex items-end gap-2',\n        isOutgoing ? 'flex-row-reverse' : 'flex-row',\n        className\n      )}\n      aria-hidden=\"true\"\n    >\n      {showAvatar && !isOutgoing && (\n        <div className=\"h-8 w-8 animate-pulse rounded-full bg-neutral-200 dark:bg-neutral-700\" />\n      )}\n      <div\n        className={cn(\n          'animate-pulse rounded-2xl',\n          isOutgoing\n            ? 'bg-primary-800/30 rounded-br-md'\n            : 'rounded-bl-md bg-neutral-200 dark:bg-neutral-700',\n          'h-10 w-48'\n        )}\n      />\n      {showAvatar && isOutgoing && <div className=\"w-8\" />}\n    </div>\n  );\n}\n\nSkeletonMessage.displayName = 'SkeletonMessage';\n\n// ============================================================================\n// Typing Indicator Component\n// ============================================================================\n\nexport interface TypingIndicatorProps {\n  typingState: TypingState;\n  className?: string;\n}\n\n/**\n * Displays who is currently typing.\n */\nfunction TypingIndicator({ typingState, className }: TypingIndicatorProps) {\n  const { participants } = typingState;\n\n  if (participants.length === 0) return null;\n\n  const typingText =\n    participants.length === 1\n      ? `${participants[0].name} is typing`\n      : participants.length === 2\n        ? `${participants[0].name} and ${participants[1].name} are typing`\n        : `${participants[0].name} and ${participants.length - 1} others are typing`;\n\n  return (\n    <div\n      className={cn('flex items-center gap-2 px-4 py-2', className)}\n      role=\"status\"\n      aria-live=\"polite\"\n      aria-label={typingText}\n    >\n      {/* Typing bubble animation */}\n      <div className=\"flex items-center gap-1 rounded-2xl rounded-bl-md bg-neutral-200 px-4 py-3 dark:bg-neutral-700\">\n        <span\n          className=\"h-2 w-2 animate-bounce rounded-full bg-neutral-500\"\n          style={{ animationDelay: '0ms' }}\n        />\n        <span\n          className=\"h-2 w-2 animate-bounce rounded-full bg-neutral-500\"\n          style={{ animationDelay: '150ms' }}\n        />\n        <span\n          className=\"h-2 w-2 animate-bounce rounded-full bg-neutral-500\"\n          style={{ animationDelay: '300ms' }}\n        />\n      </div>\n      <span className=\"text-xs text-neutral-500 dark:text-neutral-400\">\n        {typingText}\n      </span>\n    </div>\n  );\n}\n\nTypingIndicator.displayName = 'TypingIndicator';\n\n// ============================================================================\n// Date Separator Component\n// ============================================================================\n\nexport interface DateSeparatorProps {\n  label: string;\n  className?: string;\n}\n\n/**\n * A visual separator showing the date between message groups.\n */\nfunction DateSeparator({ label, className }: DateSeparatorProps) {\n  return (\n    <div\n      className={cn('flex items-center justify-center py-4', className)}\n      role=\"separator\"\n      aria-label={label}\n    >\n      <span\n        className={cn(\n          'rounded-full px-3 py-1 text-xs font-medium',\n          'bg-neutral-100 text-neutral-500',\n          'dark:bg-neutral-800 dark:text-neutral-400'\n        )}\n      >\n        {label}\n      </span>\n    </div>\n  );\n}\n\nDateSeparator.displayName = 'DateSeparator';\n\n// ============================================================================\n// Empty State Component\n// ============================================================================\n\nexport interface EmptyStateProps {\n  /** Custom title */\n  title?: string;\n  /** Custom description */\n  description?: string;\n  /** Custom icon */\n  icon?: React.ReactNode;\n  /** Action button */\n  action?: React.ReactNode;\n  className?: string;\n}\n\n/**\n * Empty state shown when there are no messages.\n */\nfunction EmptyState({\n  title = 'No messages yet',\n  description = 'Start the conversation by sending a message below.',\n  icon,\n  action,\n  className,\n}: EmptyStateProps) {\n  return (\n    <div\n      className={cn(\n        'flex flex-1 flex-col items-center justify-center p-8 text-center',\n        className\n      )}\n      role=\"status\"\n      aria-label={title}\n    >\n      {icon || (\n        <div className=\"mb-4 rounded-full bg-neutral-100 p-4 dark:bg-neutral-800\">\n          <svg\n            className=\"h-12 w-12 text-neutral-400\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            stroke=\"currentColor\"\n          >\n            <path\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth={1.5}\n              d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\"\n            />\n          </svg>\n        </div>\n      )}\n      <h3 className=\"mb-2 text-lg font-semibold text-neutral-900 dark:text-neutral-100\">\n        {title}\n      </h3>\n      <p className=\"mb-4 max-w-sm text-sm text-neutral-500 dark:text-neutral-400\">\n        {description}\n      </p>\n      {action}\n    </div>\n  );\n}\n\nEmptyState.displayName = 'EmptyState';\n\n// ============================================================================\n// Load More Button Component\n// ============================================================================\n\nexport interface LoadMoreButtonProps {\n  isLoading?: boolean;\n  onClick: () => void;\n  className?: string;\n}\n\n/**\n * Button to load more message history.\n */\nfunction LoadMoreButton({\n  isLoading,\n  onClick,\n  className,\n}: LoadMoreButtonProps) {\n  return (\n    <div className={cn('flex justify-center py-4', className)}>\n      <button\n        type=\"button\"\n        onClick={onClick}\n        disabled={isLoading}\n        className={cn(\n          'rounded-full px-4 py-2 text-sm font-medium',\n          'bg-neutral-100 text-neutral-600 dark:bg-neutral-800 dark:text-neutral-300',\n          'hover:bg-neutral-200 dark:hover:bg-neutral-700',\n          'focus:ring-primary-500 focus:ring-2 focus:outline-none',\n          'disabled:cursor-not-allowed disabled:opacity-50',\n          'transition-colors'\n        )}\n        aria-label={isLoading ? 'Loading more messages' : 'Load more messages'}\n      >\n        {isLoading ? (\n          <span className=\"flex items-center gap-2\">\n            <svg\n              className=\"h-4 w-4 animate-spin\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n            >\n              <circle\n                className=\"opacity-25\"\n                cx=\"12\"\n                cy=\"12\"\n                r=\"10\"\n                stroke=\"currentColor\"\n                strokeWidth=\"4\"\n              />\n              <path\n                className=\"opacity-75\"\n                fill=\"currentColor\"\n                d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z\"\n              />\n            </svg>\n            Loading...\n          </span>\n        ) : (\n          'Load earlier messages'\n        )}\n      </button>\n    </div>\n  );\n}\n\nLoadMoreButton.displayName = 'LoadMoreButton';\n\n// ============================================================================\n// Message List Component\n// ============================================================================\n\nexport interface MessageListProps {\n  /** Array of messages to display */\n  messages: Message[];\n  /** Current user for determining outgoing messages */\n  currentUser: MessageParticipant;\n  /** Whether messages are loading */\n  isLoading?: boolean;\n  /** Whether more messages are available */\n  hasMore?: boolean;\n  /** Whether more messages are being loaded */\n  isLoadingMore?: boolean;\n  /** Typing indicator state */\n  typingState?: TypingState;\n  /** Show avatars for incoming messages */\n  showAvatars?: boolean;\n  /** Show sender names (for group conversations) */\n  showSenderNames?: boolean;\n  /** Group messages by date */\n  groupByDate?: boolean;\n  /** Callback when load more is triggered */\n  onLoadMore?: () => void;\n  /** Callback when a message action (retry) is triggered */\n  onRetryMessage?: (messageId: string) => void;\n  /** Callback when an attachment is clicked */\n  onAttachmentClick?: (attachment: MessageAttachment, message: Message) => void;\n  /** Custom empty state */\n  emptyState?: React.ReactNode;\n  /** Custom timestamp formatter */\n  formatTimestamp?: (timestamp: Date | string) => string;\n  /** Additional class name */\n  className?: string;\n  /** Auto-scroll behavior */\n  autoScroll?: 'always' | 'onNewMessage' | 'manual';\n}\n\n/**\n * A scrollable list of messages with date grouping, auto-scroll, and loading states.\n *\n * @example\n * ```tsx\n * <MessageList\n *   messages={messages}\n *   currentUser={currentUser}\n *   typingState={typingState}\n *   onLoadMore={handleLoadMore}\n *   showAvatars\n *   groupByDate\n * />\n * ```\n */\nconst MessageList = React.forwardRef<HTMLDivElement, MessageListProps>(\n  (\n    {\n      messages,\n      currentUser,\n      isLoading = false,\n      hasMore = false,\n      isLoadingMore = false,\n      typingState,\n      showAvatars = true,\n      showSenderNames = false,\n      groupByDate = true,\n      onLoadMore,\n      onRetryMessage,\n      onAttachmentClick,\n      emptyState,\n      formatTimestamp,\n      className,\n      autoScroll = 'onNewMessage',\n    },\n    ref\n  ) => {\n    const scrollContainerRef = React.useRef<HTMLDivElement>(null);\n    const bottomRef = React.useRef<HTMLDivElement>(null);\n    const [isUserScrolled, setIsUserScrolled] = React.useState(false);\n    const prevMessageCountRef = React.useRef(messages.length);\n\n    // Combine refs\n    React.useImperativeHandle(ref, () => scrollContainerRef.current!);\n\n    // Handle scroll to detect if user has scrolled up\n    const handleScroll = React.useCallback(() => {\n      const container = scrollContainerRef.current;\n      if (!container) return;\n\n      const { scrollTop, scrollHeight, clientHeight } = container;\n      const isAtBottom = scrollHeight - scrollTop - clientHeight < 100;\n      setIsUserScrolled(!isAtBottom);\n    }, []);\n\n    // Auto-scroll on new messages\n    React.useEffect(() => {\n      const container = scrollContainerRef.current;\n      const bottom = bottomRef.current;\n      if (!container || !bottom) return;\n\n      const messageCountChanged =\n        messages.length !== prevMessageCountRef.current;\n      prevMessageCountRef.current = messages.length;\n\n      if (autoScroll === 'always') {\n        bottom.scrollIntoView({ behavior: 'smooth' });\n      } else if (autoScroll === 'onNewMessage' && messageCountChanged) {\n        // Check if new message is from current user (outgoing)\n        const lastMessage = messages[messages.length - 1];\n        const isOutgoing = lastMessage?.sender.id === currentUser.id;\n\n        // Always scroll on outgoing, only scroll on incoming if at bottom\n        if (isOutgoing || !isUserScrolled) {\n          bottom.scrollIntoView({ behavior: 'smooth' });\n        }\n      }\n    }, [messages, currentUser.id, autoScroll, isUserScrolled]);\n\n    // Scroll to bottom on initial load\n    React.useEffect(() => {\n      const bottom = bottomRef.current;\n      if (bottom && !isLoading) {\n        bottom.scrollIntoView();\n      }\n    }, [isLoading]);\n\n    // Group messages\n    const messageGroups = groupByDate\n      ? groupMessagesByDate(messages)\n      : [{ date: 'all', label: '', messages }];\n\n    // Loading skeleton\n    if (isLoading) {\n      return (\n        <div\n          className={cn(\n            'flex flex-1 flex-col gap-3 overflow-y-auto p-4',\n            className\n          )}\n          aria-busy=\"true\"\n          aria-label=\"Loading messages\"\n        >\n          {Array.from({ length: 8 }).map((_, i) => (\n            <SkeletonMessage\n              key={i}\n              isOutgoing={i % 3 === 0}\n              showAvatar={showAvatars}\n            />\n          ))}\n        </div>\n      );\n    }\n\n    // Empty state\n    if (messages.length === 0) {\n      return emptyState || <EmptyState />;\n    }\n\n    return (\n      <div\n        ref={scrollContainerRef}\n        className={cn(\n          'flex flex-1 flex-col overflow-y-auto',\n          'scroll-smooth',\n          className\n        )}\n        onScroll={handleScroll}\n        role=\"log\"\n        aria-label=\"Message history\"\n        aria-live=\"polite\"\n      >\n        {/* Load more button */}\n        {hasMore && onLoadMore && (\n          <LoadMoreButton isLoading={isLoadingMore} onClick={onLoadMore} />\n        )}\n\n        {/* Messages grouped by date */}\n        <div className=\"flex flex-col gap-1 p-4\">\n          {messageGroups.map((group) => (\n            <React.Fragment key={group.date}>\n              {/* Date separator */}\n              {groupByDate && group.label && (\n                <DateSeparator label={group.label} />\n              )}\n\n              {/* Messages in group */}\n              {group.messages.map((message, index) => {\n                const prevMessage = group.messages[index - 1];\n                const isOutgoing = message.sender.id === currentUser.id;\n                const isSameGroup = isSameSenderGroup(prevMessage, message);\n\n                return (\n                  <div\n                    key={message.id}\n                    className={cn(\n                      'transition-opacity duration-200',\n                      isSameGroup ? 'mt-0.5' : 'mt-3',\n                      index === 0 && 'mt-0'\n                    )}\n                  >\n                    <MessageBubble\n                      message={message}\n                      isOutgoing={isOutgoing}\n                      showAvatar={showAvatars && !isSameGroup && !isOutgoing}\n                      showSenderName={\n                        showSenderNames && !isSameGroup && !isOutgoing\n                      }\n                      showTimestamp={!isSameGroup}\n                      onRetry={\n                        message.status === 'failed' && onRetryMessage\n                          ? () => onRetryMessage(message.id)\n                          : undefined\n                      }\n                      onAttachmentClick={(attachment) =>\n                        onAttachmentClick?.(attachment, message)\n                      }\n                      formatTimestamp={formatTimestamp}\n                    />\n                  </div>\n                );\n              })}\n            </React.Fragment>\n          ))}\n        </div>\n\n        {/* Typing indicator */}\n        {typingState && typingState.participants.length > 0 && (\n          <TypingIndicator typingState={typingState} />\n        )}\n\n        {/* Scroll anchor */}\n        <div ref={bottomRef} className=\"h-0\" aria-hidden=\"true\" />\n\n        {/* Scroll to bottom button when user has scrolled up */}\n        {isUserScrolled && (\n          <button\n            type=\"button\"\n            onClick={() => {\n              bottomRef.current?.scrollIntoView({ behavior: 'smooth' });\n            }}\n            className={cn(\n              'fixed right-4 bottom-24 z-10',\n              'rounded-full p-3 shadow-lg',\n              'bg-white dark:bg-neutral-800',\n              'border border-neutral-200 dark:border-neutral-700',\n              'hover:bg-neutral-50 dark:hover:bg-neutral-700',\n              'focus:ring-primary-500 focus:ring-2 focus:outline-none',\n              'transition-all'\n            )}\n            aria-label=\"Scroll to bottom\"\n          >\n            <svg\n              className=\"h-5 w-5 text-neutral-600 dark:text-neutral-300\"\n              fill=\"none\"\n              viewBox=\"0 0 24 24\"\n              stroke=\"currentColor\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M19 14l-7 7m0 0l-7-7m7 7V3\"\n              />\n            </svg>\n          </button>\n        )}\n      </div>\n    );\n  }\n);\n\nMessageList.displayName = 'MessageList';\n\nexport {\n  MessageList,\n  SkeletonMessage,\n  TypingIndicator,\n  DateSeparator,\n  EmptyState,\n  LoadMoreButton,\n  groupMessagesByDate,\n  formatDateLabel,\n  isSameSenderGroup,\n};\n","/**\n * AI Chat Component\n *\n * A complete chat interface for AI interactions with support for\n * MCP tool calls, suggested actions, and streaming responses.\n *\n * This component reuses the core Messaging components (MessageComposer,\n * EmptyState) to maintain DRY principles.\n */\n\nimport * as React from 'react';\nimport { cva, type VariantProps } from 'class-variance-authority';\nimport { cn } from '../../utils/cn';\nimport type {\n  AIMessage,\n  AIChatSession,\n  AISuggestedAction,\n  AIChatCallbacks,\n  MCPResourceLink,\n} from './types';\nimport { AIMessageDisplay } from './AIMessage';\nimport {\n  MessageComposer,\n  type MessageComposerProps,\n} from '../Messaging/MessageComposer';\nimport {\n  EmptyState as MessagingEmptyState,\n  type EmptyStateProps as MessagingEmptyStateProps,\n} from '../Messaging/MessageList';\n\n// ============================================================================\n// Suggested Actions Component\n// ============================================================================\n\nexport interface SuggestedActionsProps {\n  /** Available suggested actions */\n  actions: AISuggestedAction[];\n  /** Callback when an action is selected */\n  onSelect: (action: AISuggestedAction) => void;\n  /** Additional class name */\n  className?: string;\n}\n\nconst ACTION_ICONS: Record<string, React.ReactNode> = {\n  patient: (\n    <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M18 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zM3 19.235v-.11a6.375 6.375 0 0112.75 0v.109A12.318 12.318 0 019.374 21c-2.331 0-4.512-.645-6.374-1.766z\" />\n    </svg>\n  ),\n  search: (\n    <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z\" />\n    </svg>\n  ),\n  appointment: (\n    <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5\" />\n    </svg>\n  ),\n  document: (\n    <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z\" />\n    </svg>\n  ),\n  help: (\n    <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z\" />\n    </svg>\n  ),\n  default: (\n    <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M8.625 12a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H8.25m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H12m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0h-.375M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n    </svg>\n  ),\n};\n\nexport function SuggestedActions({ actions, onSelect, className }: SuggestedActionsProps) {\n  return (\n    <div className={cn('flex flex-wrap gap-2', className)}>\n      {actions.map((action) => (\n        <button\n          key={action.id}\n          onClick={() => onSelect(action)}\n          className={cn(\n            'flex items-center gap-2 rounded-full border border-neutral-200 px-3 py-1.5',\n            'text-sm text-neutral-700 hover:border-primary-300 hover:bg-primary-50 hover:text-primary-700',\n            'dark:border-neutral-700 dark:text-neutral-300',\n            'dark:hover:border-primary-700 dark:hover:bg-primary-900/20 dark:hover:text-primary-300',\n            'transition-colors'\n          )}\n        >\n          {ACTION_ICONS[action.icon || 'default'] || ACTION_ICONS.default}\n          <span>{action.label}</span>\n        </button>\n      ))}\n    </div>\n  );\n}\n\n// ============================================================================\n// AI Empty State Component (wraps Messaging EmptyState with AI-specific defaults)\n// ============================================================================\n\ninterface AIEmptyStateProps extends Omit<MessagingEmptyStateProps, 'icon'> {\n  suggestions?: AISuggestedAction[];\n  onSuggestionSelect?: (action: AISuggestedAction) => void;\n}\n\nfunction AIEmptyState({\n  title = \"How can I help you today?\",\n  description = \"Ask me anything about patients, appointments, documents, or how to use the system.\",\n  suggestions,\n  onSuggestionSelect,\n  className,\n  ...props\n}: AIEmptyStateProps) {\n  const aiIcon = (\n    <div className=\"flex h-16 w-16 items-center justify-center rounded-full bg-gradient-to-br from-violet-500 to-purple-600\">\n      <svg className=\"h-8 w-8 text-white\" viewBox=\"0 0 24 24\" fill=\"none\">\n        <path\n          d=\"M12 2L2 7L12 12L22 7L12 2Z\"\n          stroke=\"currentColor\"\n          strokeWidth=\"1.5\"\n          strokeLinecap=\"round\"\n          strokeLinejoin=\"round\"\n          fill=\"currentColor\"\n          fillOpacity=\"0.2\"\n        />\n        <path\n          d=\"M2 17L12 22L22 17\"\n          stroke=\"currentColor\"\n          strokeWidth=\"1.5\"\n          strokeLinecap=\"round\"\n          strokeLinejoin=\"round\"\n        />\n        <path\n          d=\"M2 12L12 17L22 12\"\n          stroke=\"currentColor\"\n          strokeWidth=\"1.5\"\n          strokeLinecap=\"round\"\n          strokeLinejoin=\"round\"\n        />\n      </svg>\n    </div>\n  );\n\n  const suggestionsAction = suggestions && suggestions.length > 0 && onSuggestionSelect ? (\n    <div className=\"mt-6\">\n      <p className=\"mb-3 text-sm text-neutral-500 dark:text-neutral-400\">\n        Try asking:\n      </p>\n      <SuggestedActions\n        actions={suggestions}\n        onSelect={onSuggestionSelect}\n      />\n    </div>\n  ) : undefined;\n\n  return (\n    <MessagingEmptyState\n      title={title}\n      description={description}\n      icon={aiIcon}\n      action={suggestionsAction}\n      className={className}\n      {...props}\n    />\n  );\n}\n\n// ============================================================================\n// AI Chat Component\n// ============================================================================\n\nconst chatVariants = cva(\n  'flex flex-col',\n  {\n    variants: {\n      variant: {\n        default: 'bg-white dark:bg-neutral-900',\n        embedded: 'bg-transparent',\n        floating: 'bg-white dark:bg-neutral-900 rounded-2xl shadow-xl border border-neutral-200 dark:border-neutral-700',\n      },\n      size: {\n        sm: 'max-w-sm',\n        md: 'max-w-lg',\n        lg: 'max-w-2xl',\n        xl: 'max-w-4xl',\n        full: 'w-full',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n      size: 'full',\n    },\n  }\n);\n\nexport interface AIChatProps extends VariantProps<typeof chatVariants>, AIChatCallbacks {\n  /** Chat session data */\n  session?: AIChatSession;\n  /** Messages to display (alternative to session) */\n  messages?: AIMessage[];\n  /** Whether the AI is generating */\n  isGenerating?: boolean;\n  /** Current user name */\n  userName?: string;\n  /** Title for the chat header */\n  title?: string;\n  /** Suggested actions */\n  suggestions?: AISuggestedAction[];\n  /** Whether to show the header */\n  showHeader?: boolean;\n  /** Whether to show timestamps */\n  showTimestamps?: boolean;\n  /** Placeholder for input */\n  inputPlaceholder?: string;\n  /** Height constraint */\n  height?: string | number;\n  /** Props to pass to the MessageComposer */\n  composerProps?: Partial<MessageComposerProps>;\n  /** Additional class name */\n  className?: string;\n}\n\n/**\n * A complete AI chat interface with message history, input, and tool call support.\n * Reuses MessageComposer from the Messaging components for consistent UX.\n */\nexport function AIChat({\n  session,\n  messages: messagesProp,\n  isGenerating: isGeneratingProp,\n  userName = 'You',\n  title = 'AI Assistant',\n  suggestions,\n  showHeader = true,\n  showTimestamps = false,\n  inputPlaceholder = 'Ask anything...',\n  variant,\n  size,\n  height,\n  composerProps,\n  className,\n  onSendMessage,\n  onToolCall: _onToolCall,\n  onResourceClick,\n  onSuggestedAction,\n  onCancel,\n  onClear,\n}: AIChatProps) {\n  const messagesEndRef = React.useRef<HTMLDivElement>(null);\n\n  const messages = React.useMemo(\n    () => session?.messages || messagesProp || [],\n    [session?.messages, messagesProp]\n  );\n  const isGenerating = session?.isGenerating || isGeneratingProp || false;\n\n  // Auto-scroll to bottom on new messages\n  React.useEffect(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  }, [messages]);\n\n  const handleSend = async (message: { content: string }) => {\n    if (message.content.trim() && onSendMessage) {\n      onSendMessage(message.content.trim());\n    }\n  };\n\n  const handleSuggestionSelect = (action: AISuggestedAction) => {\n    if (onSuggestedAction) {\n      onSuggestedAction(action);\n    } else if (onSendMessage) {\n      onSendMessage(action.prompt);\n    }\n  };\n\n  const handleLinkClick = (link: MCPResourceLink) => {\n    if (onResourceClick) {\n      onResourceClick(link);\n    }\n  };\n\n  return (\n    <div\n      className={cn(chatVariants({ variant, size }), className)}\n      style={{ height: height || undefined }}\n    >\n      {/* Header */}\n      {showHeader && (\n        <div className=\"flex items-center justify-between border-b border-neutral-200 px-4 py-3 dark:border-neutral-700\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"flex h-8 w-8 items-center justify-center rounded-full bg-gradient-to-br from-violet-500 to-purple-600\">\n              <svg className=\"h-4 w-4 text-white\" viewBox=\"0 0 24 24\" fill=\"none\">\n                <path\n                  d=\"M12 2L2 7L12 12L22 7L12 2Z\"\n                  stroke=\"currentColor\"\n                  strokeWidth=\"1.5\"\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  fill=\"currentColor\"\n                  fillOpacity=\"0.2\"\n                />\n                <path\n                  d=\"M2 17L12 22L22 17\"\n                  stroke=\"currentColor\"\n                  strokeWidth=\"1.5\"\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                />\n                <path\n                  d=\"M2 12L12 17L22 12\"\n                  stroke=\"currentColor\"\n                  strokeWidth=\"1.5\"\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                />\n              </svg>\n            </div>\n            <div>\n              <h2 className=\"font-semibold text-neutral-900 dark:text-white\">{title}</h2>\n              {isGenerating && (\n                <p className=\"text-xs text-neutral-500\">Generating...</p>\n              )}\n            </div>\n          </div>\n\n          <div className=\"flex items-center gap-2\">\n            {isGenerating && onCancel && (\n              <button\n                onClick={onCancel}\n                className={cn(\n                  'rounded-lg px-3 py-1.5 text-sm',\n                  'bg-red-100 text-red-600 hover:bg-red-200',\n                  'dark:bg-red-900/30 dark:text-red-400 dark:hover:bg-red-900/50',\n                  'transition-colors'\n                )}\n              >\n                Stop\n              </button>\n            )}\n            {onClear && messages.length > 0 && (\n              <button\n                onClick={onClear}\n                className=\"rounded-lg p-2 text-neutral-500 hover:bg-neutral-100 hover:text-neutral-700 dark:hover:bg-neutral-800 dark:hover:text-neutral-300\"\n                title=\"Clear chat\"\n              >\n                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"1.5\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99\" />\n                </svg>\n              </button>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Messages */}\n      <div className=\"flex-1 overflow-y-auto px-4 py-4\">\n        {messages.length === 0 ? (\n          <AIEmptyState\n            suggestions={suggestions}\n            onSuggestionSelect={handleSuggestionSelect}\n          />\n        ) : (\n          <div className=\"space-y-4\">\n            {messages.map((message) => (\n              <AIMessageDisplay\n                key={message.id}\n                message={message}\n                userName={userName}\n                showTimestamp={showTimestamps}\n                onLinkClick={handleLinkClick}\n              />\n            ))}\n            <div ref={messagesEndRef} />\n          </div>\n        )}\n      </div>\n\n      {/* Input - Using MessageComposer from Messaging */}\n      <div className=\"border-t border-neutral-200 p-4 dark:border-neutral-700\">\n        {suggestions && suggestions.length > 0 && messages.length > 0 && !isGenerating && (\n          <SuggestedActions\n            actions={suggestions}\n            onSelect={handleSuggestionSelect}\n            className=\"mb-3\"\n          />\n        )}\n        <MessageComposer\n          onSend={handleSend}\n          placeholder={inputPlaceholder}\n          disabled={isGenerating}\n          isSending={isGenerating}\n          showAttachmentPicker={false}\n          showCameraButton={false}\n          showCharacterCount={false}\n          {...composerProps}\n        />\n      </div>\n    </div>\n  );\n}\n\n// Re-export for convenience\nexport type { AISuggestedAction };\n","/**\n * AI Chat Modal Component\n *\n * A floating chat window that can be triggered with a button.\n */\n\nimport * as React from 'react';\nimport { cn } from '../../utils/cn';\nimport { useFocusTrap } from '../../hooks/useFocusTrap';\nimport { useEscapeKey } from '../../hooks/useEscapeKey';\nimport type { AIChatProps } from './AIChat';\nimport { AIChat } from './AIChat';\n\n// ============================================================================\n// AI Chat Trigger Button\n// ============================================================================\n\nexport interface AIChatTriggerProps {\n  /** Whether the chat is open */\n  isOpen?: boolean;\n  /** Callback when clicked */\n  onClick?: () => void;\n  /** Pulse animation to draw attention */\n  pulse?: boolean;\n  /** Badge count for notifications */\n  badge?: number;\n  /** Position of the button */\n  position?: 'bottom-right' | 'bottom-left' | 'top-right' | 'top-left';\n  /** Additional class name */\n  className?: string;\n}\n\nexport function AIChatTrigger({\n  isOpen = false,\n  onClick,\n  pulse = false,\n  badge,\n  position = 'bottom-right',\n  className,\n}: AIChatTriggerProps) {\n  const positionClasses = {\n    'bottom-right': 'bottom-4 right-4',\n    'bottom-left': 'bottom-4 left-4',\n    'top-right': 'top-4 right-4',\n    'top-left': 'top-4 left-4',\n  };\n\n  return (\n    <button\n      onClick={onClick}\n      className={cn(\n        'fixed z-50 flex h-14 w-14 items-center justify-center rounded-full shadow-lg',\n        'bg-gradient-to-br from-violet-500 to-purple-600 text-white',\n        'hover:from-violet-600 hover:to-purple-700',\n        'focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2',\n        'dark:focus:ring-offset-neutral-900',\n        'transition-all duration-200',\n        isOpen && 'scale-0 opacity-0',\n        positionClasses[position],\n        className\n      )}\n      aria-label=\"Open AI Assistant\"\n    >\n      {/* Pulse effect */}\n      {pulse && !isOpen && (\n        <span className=\"absolute inline-flex h-full w-full animate-ping rounded-full bg-purple-400 opacity-75\" />\n      )}\n      \n      {/* Badge */}\n      {badge && badge > 0 && (\n        <span className=\"absolute -right-1 -top-1 flex h-5 w-5 items-center justify-center rounded-full bg-red-500 text-xs font-bold\">\n          {badge > 9 ? '9+' : badge}\n        </span>\n      )}\n\n      {/* AI Icon */}\n      <svg className=\"h-7 w-7\" viewBox=\"0 0 24 24\" fill=\"none\">\n        <path\n          d=\"M12 2L2 7L12 12L22 7L12 2Z\"\n          stroke=\"currentColor\"\n          strokeWidth=\"1.5\"\n          strokeLinecap=\"round\"\n          strokeLinejoin=\"round\"\n          fill=\"currentColor\"\n          fillOpacity=\"0.2\"\n        />\n        <path\n          d=\"M2 17L12 22L22 17\"\n          stroke=\"currentColor\"\n          strokeWidth=\"1.5\"\n          strokeLinecap=\"round\"\n          strokeLinejoin=\"round\"\n        />\n        <path\n          d=\"M2 12L12 17L22 12\"\n          stroke=\"currentColor\"\n          strokeWidth=\"1.5\"\n          strokeLinecap=\"round\"\n          strokeLinejoin=\"round\"\n        />\n      </svg>\n    </button>\n  );\n}\n\n// ============================================================================\n// AI Chat Modal\n// ============================================================================\n\nexport interface AIChatModalProps extends Omit<AIChatProps, 'variant' | 'size'> {\n  /** Whether the modal is open */\n  open: boolean;\n  /** Callback when the modal should close */\n  onOpenChange: (open: boolean) => void;\n  /** Position of the modal */\n  position?: 'bottom-right' | 'bottom-left' | 'center';\n  /** Width of the modal */\n  width?: string | number;\n  /** Height of the modal */\n  height?: string | number;\n  /** Additional class name for the modal */\n  modalClassName?: string;\n}\n\n/**\n * A modal chat window that can be positioned in the corner or center.\n */\nexport function AIChatModal({\n  open,\n  onOpenChange,\n  position = 'bottom-right',\n  width = 400,\n  height = 600,\n  modalClassName,\n  ...chatProps\n}: AIChatModalProps) {\n  // Focus trap when open\n  const modalRef = useFocusTrap<HTMLDivElement>(open);\n\n  // Close on escape\n  useEscapeKey(() => {\n    if (open) onOpenChange(false);\n  });\n\n  if (!open) return null;\n\n  const positionClasses = {\n    'bottom-right': 'bottom-20 right-4',\n    'bottom-left': 'bottom-20 left-4',\n    'center': 'top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2',\n  };\n\n  return (\n    <>\n      {/* Backdrop for center position */}\n      {position === 'center' && (\n        <div\n          className=\"fixed inset-0 z-40 bg-black/50 backdrop-blur-sm\"\n          onClick={() => onOpenChange(false)}\n          onKeyDown={(e) => e.key === 'Escape' && onOpenChange(false)}\n          role=\"button\"\n          tabIndex={0}\n          aria-label=\"Close dialog\"\n        />\n      )}\n\n      {/* Modal */}\n      <div\n        ref={modalRef}\n        className={cn(\n          'fixed z-50',\n          'animate-in fade-in-0 zoom-in-95',\n          positionClasses[position],\n          modalClassName\n        )}\n        style={{\n          width: typeof width === 'number' ? `${width}px` : width,\n          height: typeof height === 'number' ? `${height}px` : height,\n          maxHeight: 'calc(100vh - 6rem)',\n          maxWidth: 'calc(100vw - 2rem)',\n        }}\n        role=\"dialog\"\n        aria-modal=\"true\"\n        aria-label=\"AI Assistant Chat\"\n      >\n        <div className=\"relative h-full w-full overflow-hidden rounded-2xl border border-neutral-200 bg-white shadow-2xl dark:border-neutral-700 dark:bg-neutral-900\">\n          {/* Close Button */}\n          <button\n            onClick={() => onOpenChange(false)}\n            className={cn(\n              'absolute right-3 top-3 z-10 flex h-8 w-8 items-center justify-center rounded-full',\n              'text-neutral-500 hover:bg-neutral-100 hover:text-neutral-700',\n              'dark:hover:bg-neutral-800 dark:hover:text-neutral-300',\n              'transition-colors'\n            )}\n            aria-label=\"Close chat\"\n          >\n            <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M6 18L18 6M6 6l12 12\" />\n            </svg>\n          </button>\n\n          <AIChat\n            {...chatProps}\n            variant=\"embedded\"\n            height=\"100%\"\n            className=\"h-full\"\n          />\n        </div>\n      </div>\n    </>\n  );\n}\n\n// ============================================================================\n// Floating AI Chat (Combined Trigger + Modal)\n// ============================================================================\n\nexport interface FloatingAIChatProps extends Omit<AIChatModalProps, 'open' | 'onOpenChange'> {\n  /** Initial open state */\n  defaultOpen?: boolean;\n  /** Controlled open state */\n  open?: boolean;\n  /** Callback when open state changes */\n  onOpenChange?: (open: boolean) => void;\n  /** Button position */\n  buttonPosition?: AIChatTriggerProps['position'];\n  /** Show pulse animation */\n  pulse?: boolean;\n}\n\n/**\n * A complete floating AI chat with trigger button and modal.\n */\nexport function FloatingAIChat({\n  defaultOpen = false,\n  open: controlledOpen,\n  onOpenChange: controlledOnOpenChange,\n  buttonPosition = 'bottom-right',\n  position = 'bottom-right',\n  pulse = false,\n  ...chatProps\n}: FloatingAIChatProps) {\n  const [internalOpen, setInternalOpen] = React.useState(defaultOpen);\n  \n  const isControlled = controlledOpen !== undefined;\n  const isOpen = isControlled ? controlledOpen : internalOpen;\n  \n  const handleOpenChange = (open: boolean) => {\n    if (!isControlled) {\n      setInternalOpen(open);\n    }\n    controlledOnOpenChange?.(open);\n  };\n\n  return (\n    <>\n      <AIChatTrigger\n        isOpen={isOpen}\n        onClick={() => handleOpenChange(true)}\n        position={buttonPosition}\n        pulse={pulse && !isOpen}\n      />\n      <AIChatModal\n        open={isOpen}\n        onOpenChange={handleOpenChange}\n        position={position}\n        {...chatProps}\n      />\n    </>\n  );\n}\n","import React, { type ReactNode } from 'react';\nimport { cn } from '../../utils/cn';\n\n// =============================================================================\n// AppHeader Component\n// =============================================================================\n\nexport interface AppHeaderProps {\n  children: ReactNode;\n  /** Additional CSS classes */\n  className?: string;\n  /** Whether the header is sticky (default: true) */\n  sticky?: boolean;\n  /** Whether to show border (default: true) */\n  bordered?: boolean;\n  /** Custom height class (default: 'h-16') */\n  height?: string;\n  /** Test ID for testing */\n  'data-testid'?: string;\n}\n\nexport function AppHeader({\n  children,\n  className,\n  sticky = true,\n  bordered = true,\n  height = 'h-16',\n  'data-testid': testId = 'app-header',\n}: AppHeaderProps): React.JSX.Element {\n  return (\n    <header\n      data-testid={testId}\n      className={cn(\n        'flex items-center justify-between px-4 lg:px-6',\n        'bg-white dark:bg-gray-900',\n        height,\n        sticky && 'sticky top-0 z-30',\n        bordered && 'border-b border-gray-200 dark:border-gray-700',\n        className\n      )}\n    >\n      {children}\n    </header>\n  );\n}\n\n// =============================================================================\n// AppHeaderSection Component\n// =============================================================================\n\nexport interface AppHeaderSectionProps {\n  children: ReactNode;\n  /** Section alignment */\n  align?: 'left' | 'center' | 'right';\n  /** Additional CSS classes */\n  className?: string;\n}\n\nexport function AppHeaderSection({\n  children,\n  align = 'left',\n  className,\n}: AppHeaderSectionProps): React.JSX.Element {\n  return (\n    <div\n      className={cn(\n        'flex items-center gap-3',\n        align === 'left' && 'mr-auto',\n        align === 'center' && 'mx-auto',\n        align === 'right' && 'ml-auto',\n        className\n      )}\n    >\n      {children}\n    </div>\n  );\n}\n\n// =============================================================================\n// AppHeaderTitle Component\n// =============================================================================\n\nexport interface AppHeaderTitleProps {\n  children: ReactNode;\n  /** Optional subtitle */\n  subtitle?: ReactNode;\n  /** Additional CSS classes */\n  className?: string;\n}\n\nexport function AppHeaderTitle({\n  children,\n  subtitle,\n  className,\n}: AppHeaderTitleProps): React.JSX.Element {\n  return (\n    <div className={cn('min-w-0', className)}>\n      <h1 className=\"truncate text-lg font-semibold text-gray-900 dark:text-white\">\n        {children}\n      </h1>\n      {subtitle && (\n        <p className=\"truncate text-sm text-gray-500 dark:text-gray-400\">\n          {subtitle}\n        </p>\n      )}\n    </div>\n  );\n}\n\n// =============================================================================\n// AppHeaderActions Component\n// =============================================================================\n\nexport interface AppHeaderActionsProps {\n  children: ReactNode;\n  /** Additional CSS classes */\n  className?: string;\n}\n\nexport function AppHeaderActions({\n  children,\n  className,\n}: AppHeaderActionsProps): React.JSX.Element {\n  return (\n    <div className={cn('flex items-center gap-2', className)}>{children}</div>\n  );\n}\n\n// =============================================================================\n// AppHeaderDivider Component\n// =============================================================================\n\nexport interface AppHeaderDividerProps {\n  /** Additional CSS classes */\n  className?: string;\n}\n\nexport function AppHeaderDivider({\n  className,\n}: AppHeaderDividerProps): React.JSX.Element {\n  return (\n    <div\n      className={cn('mx-2 h-6 w-px bg-gray-200 dark:bg-gray-700', className)}\n      aria-hidden=\"true\"\n    />\n  );\n}\n\n// =============================================================================\n// AppHeaderIconButton Component\n// =============================================================================\n\nexport interface AppHeaderIconButtonProps {\n  /** Button icon */\n  icon: ReactNode;\n  /** Accessible label */\n  label: string;\n  /** Click handler */\n  onClick?: () => void;\n  /** Badge count */\n  badge?: number;\n  /** Whether the button is active */\n  isActive?: boolean;\n  /** Additional CSS classes */\n  className?: string;\n  /** Test ID for testing */\n  'data-testid'?: string;\n}\n\nexport function AppHeaderIconButton({\n  icon,\n  label,\n  onClick,\n  badge,\n  isActive = false,\n  className,\n  'data-testid': testId,\n}: AppHeaderIconButtonProps): React.JSX.Element {\n  return (\n    <button\n      onClick={onClick}\n      data-testid={testId}\n      className={cn(\n        'relative rounded-lg p-2 transition-colors',\n        'text-gray-500 dark:text-gray-400',\n        'hover:bg-gray-100 dark:hover:bg-gray-800',\n        'focus:ring-primary-500 focus:ring-2 focus:outline-none',\n        isActive &&\n          'text-primary-600 dark:text-primary-400 bg-gray-100 dark:bg-gray-800',\n        className\n      )}\n      aria-label={label}\n      title={label}\n    >\n      <span className=\"h-5 w-5\">{icon}</span>\n      {typeof badge === 'number' && badge > 0 && (\n        <span\n          className={cn(\n            'absolute -top-1 -right-1 flex items-center justify-center',\n            'h-[18px] min-w-[18px] px-1 text-[10px] font-bold',\n            'rounded-full bg-red-500 text-white'\n          )}\n        >\n          {badge > 99 ? '99+' : badge}\n        </span>\n      )}\n    </button>\n  );\n}\n\n// =============================================================================\n// AppHeaderSearch Component (placeholder trigger for CommandPalette)\n// =============================================================================\n\nexport interface AppHeaderSearchProps {\n  /** Click handler to open search */\n  onClick?: () => void;\n  /** Placeholder text */\n  placeholder?: string;\n  /** Whether to show on mobile (default: false) */\n  showOnMobile?: boolean;\n  /** Additional CSS classes */\n  className?: string;\n  /** Test ID for testing */\n  'data-testid'?: string;\n}\n\nconst SearchIcon = () => (\n  <svg\n    className=\"h-5 w-5\"\n    fill=\"none\"\n    viewBox=\"0 0 24 24\"\n    stroke=\"currentColor\"\n    strokeWidth={2}\n  >\n    <path\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"\n    />\n  </svg>\n);\n\n/** Check if running on Mac */\nconst isMac =\n  typeof window !== 'undefined' &&\n  typeof window.navigator !== 'undefined' &&\n  /Mac|iPod|iPhone|iPad/.test(window.navigator.platform);\n\nexport function AppHeaderSearch({\n  onClick,\n  placeholder = 'Search...',\n  showOnMobile = false,\n  className,\n  'data-testid': testId = 'app-header-search',\n}: AppHeaderSearchProps): React.JSX.Element {\n  return (\n    <button\n      onClick={onClick}\n      data-testid={testId}\n      className={cn(\n        'flex items-center gap-3 rounded-lg border border-gray-300 dark:border-gray-600',\n        'bg-white px-4 py-2 text-sm text-gray-500 dark:bg-gray-700 dark:text-gray-400',\n        'hover:border-gray-400 dark:hover:border-gray-500',\n        'transition-colors hover:bg-gray-50 dark:hover:bg-gray-600',\n        !showOnMobile && 'hidden sm:flex',\n        'min-w-[200px] lg:min-w-[300px]',\n        className\n      )}\n    >\n      <SearchIcon />\n      <span className=\"flex-1 text-left whitespace-nowrap\">{placeholder}</span>\n      <kbd\n        className={cn(\n          'hidden items-center gap-0.5 px-2 py-0.5 sm:inline-flex',\n          'rounded border border-gray-200 bg-gray-100 dark:border-gray-500 dark:bg-gray-600',\n          'flex-shrink-0 text-xs text-gray-600 dark:text-gray-300'\n        )}\n      >\n        {isMac ? '' : 'Ctrl'}+K\n      </kbd>\n    </button>\n  );\n}\n\n// =============================================================================\n// AppHeaderUserMenu Component\n// =============================================================================\n\nexport interface AppHeaderUserMenuProps {\n  /** User's name */\n  name: string;\n  /** User's email or subtitle */\n  email?: string;\n  /** User's avatar URL */\n  avatarUrl?: string;\n  /** Fallback initials when no avatar */\n  initials?: string;\n  /** Whether the menu is open */\n  isOpen?: boolean;\n  /** Click handler */\n  onClick?: () => void;\n  /** Additional CSS classes */\n  className?: string;\n  /** Test ID for testing */\n  'data-testid'?: string;\n}\n\nexport function AppHeaderUserMenu({\n  name,\n  email,\n  avatarUrl,\n  initials,\n  isOpen = false,\n  onClick,\n  className,\n  'data-testid': testId = 'app-header-user-menu',\n}: AppHeaderUserMenuProps): React.JSX.Element {\n  const displayInitials =\n    initials ??\n    name\n      .split(' ')\n      .map((n) => n[0])\n      .join('')\n      .toUpperCase()\n      .slice(0, 2);\n\n  return (\n    <button\n      onClick={onClick}\n      data-testid={testId}\n      className={cn(\n        'flex items-center gap-3 rounded-lg px-2 py-1.5 transition-colors',\n        'hover:bg-gray-100 dark:hover:bg-gray-800',\n        'focus:ring-primary-500 focus:ring-2 focus:outline-none',\n        isOpen && 'bg-gray-100 dark:bg-gray-800',\n        className\n      )}\n    >\n      {/* Avatar */}\n      <div\n        className={cn(\n          'flex h-8 w-8 items-center justify-center overflow-hidden rounded-full',\n          'bg-primary-100 dark:bg-primary-900 text-primary-900 dark:text-primary-100 text-sm font-medium'\n        )}\n      >\n        {avatarUrl ? (\n          <img\n            src={avatarUrl}\n            alt={name}\n            className=\"h-full w-full object-cover\"\n          />\n        ) : (\n          displayInitials\n        )}\n      </div>\n\n      {/* Name (hidden on small screens) */}\n      <div className=\"hidden min-w-0 text-left lg:block\">\n        <div className=\"max-w-[150px] truncate text-sm font-medium text-gray-900 dark:text-white\">\n          {name}\n        </div>\n        {email && (\n          <div className=\"max-w-[150px] truncate text-xs text-gray-500 dark:text-gray-400\">\n            {email}\n          </div>\n        )}\n      </div>\n\n      {/* Chevron */}\n      <svg\n        className={cn(\n          'hidden h-4 w-4 text-gray-400 transition-transform lg:block',\n          isOpen && 'rotate-180'\n        )}\n        fill=\"none\"\n        viewBox=\"0 0 24 24\"\n        stroke=\"currentColor\"\n        strokeWidth={2}\n      >\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M19 9l-7 7-7-7\" />\n      </svg>\n    </button>\n  );\n}\n","import * as React from 'react';\nimport { cva, type VariantProps } from 'class-variance-authority';\nimport { cn } from '../../utils/cn';\n\n// ============================================================================\n// Types & Interfaces\n// ============================================================================\n\nexport type AudioPlayerState =\n  | 'idle'\n  | 'loading'\n  | 'playing'\n  | 'paused'\n  | 'error';\n\nexport interface AudioPlayerProps extends VariantProps<\n  typeof audioPlayerVariants\n> {\n  /** Audio source URL */\n  src: string;\n  /** Title/label for the audio (used for accessibility and display) */\n  title?: string;\n  /** Callback when playback state changes */\n  onStateChange?: (state: AudioPlayerState) => void;\n  /** Callback when playback ends */\n  onEnded?: () => void;\n  /** Callback when an error occurs */\n  onError?: (error: Error) => void;\n  /** Callback when time updates during playback */\n  onTimeUpdate?: (currentTime: number, duration: number) => void;\n  /** Whether to show the time display */\n  showTime?: boolean;\n  /** Whether to show the duration (for inline variant) */\n  showDuration?: boolean;\n  /** Waveform color (for waveform variant) */\n  waveColor?: string;\n  /** Progress/played waveform color (for waveform variant) */\n  progressColor?: string;\n  /** Height of the waveform (for waveform variant) */\n  waveformHeight?: number;\n  /** Whether the player is disabled */\n  disabled?: boolean;\n  /** Additional class name */\n  className?: string;\n  /** Accessible label */\n  'aria-label'?: string;\n  /** Playback speed options */\n  playbackRates?: number[];\n  /** Whether to show playback speed control */\n  showPlaybackRate?: boolean;\n}\n\n// ============================================================================\n// Variants\n// ============================================================================\n\nconst audioPlayerVariants = cva('', {\n  variants: {\n    variant: {\n      inline: 'inline-flex items-center gap-2',\n      compact: [\n        'flex items-center gap-3 p-3',\n        'rounded-lg border border-border',\n        'bg-card text-card-foreground',\n      ],\n      waveform: [\n        'flex flex-col gap-3 p-4',\n        'rounded-xl border border-border',\n        'bg-card text-card-foreground',\n      ],\n    },\n    size: {\n      sm: '',\n      md: '',\n      lg: '',\n    },\n  },\n  compoundVariants: [\n    { variant: 'compact', size: 'sm', class: 'p-2 gap-2' },\n    { variant: 'compact', size: 'lg', class: 'p-4 gap-4' },\n    { variant: 'waveform', size: 'sm', class: 'p-3 gap-2' },\n    { variant: 'waveform', size: 'lg', class: 'p-5 gap-4' },\n  ],\n  defaultVariants: {\n    variant: 'compact',\n    size: 'md',\n  },\n});\n\nconst playButtonVariants = cva(\n  [\n    'inline-flex items-center justify-center',\n    'rounded-full transition-all duration-200',\n    'focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2',\n    'disabled:pointer-events-none disabled:opacity-50',\n    'active:scale-95',\n  ],\n  {\n    variants: {\n      variant: {\n        inline: [\n          'text-neutral-500 hover:text-neutral-700 hover:bg-neutral-100',\n          'dark:text-neutral-400 dark:hover:text-neutral-200 dark:hover:bg-neutral-800',\n        ],\n        compact: [\n          'bg-primary-600 text-white',\n          'hover:bg-primary-700',\n          'active:bg-primary-800',\n        ],\n        waveform: [\n          'bg-primary-600 text-white',\n          'hover:bg-primary-700',\n          'active:bg-primary-800',\n        ],\n      },\n      size: {\n        sm: 'h-7 w-7',\n        md: 'h-9 w-9',\n        lg: 'h-11 w-11',\n      },\n    },\n    defaultVariants: {\n      variant: 'compact',\n      size: 'md',\n    },\n  }\n);\n\n// ============================================================================\n// Helper Functions\n// ============================================================================\n\nexport function formatTime(seconds: number): string {\n  if (!isFinite(seconds) || isNaN(seconds)) return '0:00';\n  const mins = Math.floor(seconds / 60);\n  const secs = Math.floor(seconds % 60);\n  return `${mins}:${secs.toString().padStart(2, '0')}`;\n}\n\n// ============================================================================\n// Icons\n// ============================================================================\n\nfunction PlayIcon({ className }: { className?: string }) {\n  return (\n    <svg\n      className={className}\n      fill=\"currentColor\"\n      viewBox=\"0 0 24 24\"\n      aria-hidden=\"true\"\n    >\n      <path d=\"M8 5v14l11-7z\" />\n    </svg>\n  );\n}\n\nfunction PauseIcon({ className }: { className?: string }) {\n  return (\n    <svg\n      className={className}\n      fill=\"currentColor\"\n      viewBox=\"0 0 24 24\"\n      aria-hidden=\"true\"\n    >\n      <path d=\"M6 19h4V5H6v14zm8-14v14h4V5h-4z\" />\n    </svg>\n  );\n}\n\nfunction SpinnerIcon({ className }: { className?: string }) {\n  return (\n    <svg\n      className={cn('animate-spin', className)}\n      fill=\"none\"\n      viewBox=\"0 0 24 24\"\n      aria-hidden=\"true\"\n    >\n      <circle\n        className=\"opacity-25\"\n        cx=\"12\"\n        cy=\"12\"\n        r=\"10\"\n        stroke=\"currentColor\"\n        strokeWidth=\"4\"\n      />\n      <path\n        className=\"opacity-75\"\n        fill=\"currentColor\"\n        d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n      />\n    </svg>\n  );\n}\n\n// ============================================================================\n// Progress Bar Component (for compact variant)\n// ============================================================================\n\ninterface ProgressBarProps {\n  currentTime: number;\n  duration: number;\n  onSeek: (time: number) => void;\n  disabled?: boolean;\n}\n\nfunction ProgressBar({\n  currentTime,\n  duration,\n  onSeek,\n  disabled,\n}: ProgressBarProps) {\n  const progressRef = React.useRef<HTMLDivElement>(null);\n  const progress = duration > 0 ? (currentTime / duration) * 100 : 0;\n\n  const handleClick = (e: React.MouseEvent<HTMLDivElement>) => {\n    if (disabled || !progressRef.current || duration <= 0) return;\n    const rect = progressRef.current.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n    const percentage = x / rect.width;\n    onSeek(percentage * duration);\n  };\n\n  return (\n    <div\n      ref={progressRef}\n      role=\"slider\"\n      aria-label=\"Audio progress\"\n      aria-valuemin={0}\n      aria-valuemax={duration}\n      aria-valuenow={currentTime}\n      aria-valuetext={`${formatTime(currentTime)} of ${formatTime(duration)}`}\n      tabIndex={disabled ? -1 : 0}\n      className={cn(\n        'relative h-1.5 flex-1 cursor-pointer rounded-full bg-neutral-200 dark:bg-neutral-700',\n        disabled && 'cursor-not-allowed opacity-50'\n      )}\n      onClick={handleClick}\n      onKeyDown={(e) => {\n        if (disabled) return;\n        const step = duration * 0.05; // 5% steps\n        if (e.key === 'ArrowRight') {\n          onSeek(Math.min(currentTime + step, duration));\n        } else if (e.key === 'ArrowLeft') {\n          onSeek(Math.max(currentTime - step, 0));\n        }\n      }}\n    >\n      <div\n        className=\"bg-primary-600 absolute inset-y-0 left-0 rounded-full transition-all\"\n        style={{ width: `${progress}%` }}\n      />\n      <div\n        className=\"bg-primary-600 absolute top-1/2 h-3 w-3 -translate-y-1/2 rounded-full shadow-sm transition-all\"\n        style={{ left: `calc(${progress}% - 6px)` }}\n      />\n    </div>\n  );\n}\n\n// ============================================================================\n// Waveform Component (lazy-loaded WaveSurfer)\n// ============================================================================\n\ninterface WaveformProps {\n  src: string;\n  isPlaying: boolean;\n  onReady: (duration: number) => void;\n  onTimeUpdate: (time: number) => void;\n  onFinish: () => void;\n  onSeek: (time: number) => void;\n  waveColor?: string;\n  progressColor?: string;\n  height?: number;\n}\n\nfunction Waveform({\n  src,\n  isPlaying,\n  onReady,\n  onTimeUpdate,\n  onFinish,\n  onSeek,\n  waveColor,\n  progressColor,\n  height = 64,\n}: WaveformProps) {\n  const containerRef = React.useRef<HTMLDivElement>(null);\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const wavesurferRef = React.useRef<any>(null);\n  const [isLoaded, setIsLoaded] = React.useState(false);\n\n  // Initialize WaveSurfer\n  React.useEffect(() => {\n    if (!containerRef.current) return;\n\n    const initWaveSurfer = async () => {\n      try {\n        const WaveSurfer = (await import('wavesurfer.js')).default;\n\n        if (wavesurferRef.current) {\n          wavesurferRef.current.destroy();\n        }\n\n        wavesurferRef.current = WaveSurfer.create({\n          container: containerRef.current!,\n          waveColor: waveColor || '#d1d5db',\n          progressColor: progressColor || 'var(--color-primary-600, #2563eb)',\n          cursorColor: 'transparent',\n          barWidth: 2,\n          barGap: 2,\n          barRadius: 2,\n          height,\n          normalize: true,\n          interact: true,\n        });\n\n        wavesurferRef.current.on('ready', () => {\n          setIsLoaded(true);\n          onReady(wavesurferRef.current.getDuration());\n        });\n\n        wavesurferRef.current.on('audioprocess', () => {\n          onTimeUpdate(wavesurferRef.current.getCurrentTime());\n        });\n\n        wavesurferRef.current.on('seeking', () => {\n          onTimeUpdate(wavesurferRef.current.getCurrentTime());\n        });\n\n        wavesurferRef.current.on('interaction', () => {\n          onSeek(wavesurferRef.current.getCurrentTime());\n        });\n\n        wavesurferRef.current.on('finish', () => {\n          onFinish();\n        });\n\n        wavesurferRef.current.load(src);\n      } catch (error) {\n        console.error('Failed to load WaveSurfer:', error);\n      }\n    };\n\n    initWaveSurfer();\n\n    return () => {\n      if (wavesurferRef.current) {\n        wavesurferRef.current.destroy();\n        wavesurferRef.current = null;\n      }\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [src]);\n\n  // Handle play/pause\n  React.useEffect(() => {\n    if (!wavesurferRef.current || !isLoaded) return;\n\n    if (isPlaying) {\n      wavesurferRef.current.play();\n    } else {\n      wavesurferRef.current.pause();\n    }\n  }, [isPlaying, isLoaded]);\n\n  return (\n    <div\n      ref={containerRef}\n      className={cn(\n        'w-full rounded-lg bg-neutral-100 dark:bg-neutral-800',\n        !isLoaded && 'animate-pulse'\n      )}\n      style={{ height }}\n    />\n  );\n}\n\n// ============================================================================\n// Main AudioPlayer Component\n// ============================================================================\n\n/**\n * A versatile audio player component with multiple display variants.\n *\n * @example\n * ```tsx\n * // Inline - minimal, just play button and duration\n * <AudioPlayer src=\"/audio.mp3\" variant=\"inline\" showDuration />\n *\n * // Compact - play button, progress bar, and time\n * <AudioPlayer src=\"/audio.mp3\" variant=\"compact\" showTime />\n *\n * // Waveform - full visualization with WaveSurfer\n * <AudioPlayer src=\"/audio.mp3\" variant=\"waveform\" showTime />\n * ```\n */\nfunction AudioPlayer({\n  src,\n  title,\n  variant = 'compact',\n  size = 'md',\n  onStateChange,\n  onEnded,\n  onError,\n  onTimeUpdate,\n  showTime = true,\n  showDuration = true,\n  waveColor,\n  progressColor,\n  waveformHeight = 64,\n  disabled = false,\n  className,\n  'aria-label': ariaLabel,\n  playbackRates = [0.5, 0.75, 1, 1.25, 1.5, 2],\n  showPlaybackRate = false,\n  /** Whether to preload audio (set to false for lists with many items) */\n  preload = false,\n  /** Fallback duration in seconds to display before audio is loaded */\n  fallbackDuration,\n}: AudioPlayerProps & { preload?: boolean; fallbackDuration?: number }) {\n  const [state, setState] = React.useState<AudioPlayerState>('idle');\n  const [currentTime, setCurrentTime] = React.useState(0);\n  const [duration, setDuration] = React.useState(0);\n  const [playbackRate, setPlaybackRate] = React.useState(1);\n  const [audioInitialized, setAudioInitialized] = React.useState(false);\n  const audioRef = React.useRef<globalThis.HTMLAudioElement | null>(null);\n\n  const isPlaying = state === 'playing';\n  const isLoading = state === 'loading';\n\n  // Update state helper\n  const updateState = React.useCallback(\n    (newState: AudioPlayerState) => {\n      setState(newState);\n      onStateChange?.(newState);\n    },\n    [onStateChange]\n  );\n\n  // Initialize audio element (for non-waveform variants)\n  const initAudio = React.useCallback(() => {\n    if (variant === 'waveform' || audioInitialized) return null;\n\n    const audio = new globalThis.Audio(src);\n    audioRef.current = audio;\n    setAudioInitialized(true);\n\n    audio.addEventListener('loadstart', () => updateState('loading'));\n    audio.addEventListener('canplay', () => {\n      updateState('idle');\n    });\n    audio.addEventListener('loadedmetadata', () => {\n      setDuration(audio.duration);\n    });\n    audio.addEventListener('timeupdate', () => {\n      setCurrentTime(audio.currentTime);\n      onTimeUpdate?.(audio.currentTime, audio.duration);\n    });\n    audio.addEventListener('ended', () => {\n      updateState('idle');\n      setCurrentTime(0);\n      onEnded?.();\n    });\n    audio.addEventListener('error', () => {\n      updateState('error');\n      onError?.(new Error('Failed to load audio'));\n    });\n\n    return audio;\n  }, [\n    src,\n    variant,\n    audioInitialized,\n    updateState,\n    onTimeUpdate,\n    onEnded,\n    onError,\n  ]);\n\n  // Auto-initialize if preload is true\n  React.useEffect(() => {\n    if (preload && !audioInitialized && variant !== 'waveform') {\n      initAudio();\n    }\n  }, [preload, audioInitialized, variant, initAudio]);\n\n  // Cleanup on unmount\n  React.useEffect(() => {\n    return () => {\n      if (audioRef.current) {\n        audioRef.current.pause();\n        audioRef.current.src = '';\n      }\n    };\n  }, []);\n\n  // Handle playback rate changes\n  React.useEffect(() => {\n    if (audioRef.current) {\n      audioRef.current.playbackRate = playbackRate;\n    }\n  }, [playbackRate]);\n\n  const handlePlay = React.useCallback(() => {\n    if (disabled) return;\n\n    // Lazy initialize audio on first play\n    if (!audioInitialized && !isLoading) {\n      const audio = initAudio();\n      if (audio) {\n        updateState('loading');\n        audio.addEventListener(\n          'canplay',\n          () => {\n            audio.play().catch((error) => {\n              updateState('error');\n              onError?.(error);\n            });\n            updateState('playing');\n          },\n          { once: true }\n        );\n      }\n      return;\n    }\n\n    if (isLoading) return;\n\n    if (isPlaying) {\n      if (audioRef.current) {\n        audioRef.current.pause();\n      }\n      updateState('paused');\n    } else {\n      if (audioRef.current) {\n        audioRef.current.play().catch((error) => {\n          updateState('error');\n          onError?.(error);\n        });\n        updateState('playing');\n      }\n    }\n  }, [\n    disabled,\n    audioInitialized,\n    isLoading,\n    isPlaying,\n    initAudio,\n    updateState,\n    onError,\n  ]);\n\n  const handleSeek = React.useCallback((time: number) => {\n    if (audioRef.current) {\n      audioRef.current.currentTime = time;\n      setCurrentTime(time);\n    }\n  }, []);\n\n  // Waveform callbacks\n  const handleWaveformReady = React.useCallback((dur: number) => {\n    setDuration(dur);\n    setState('idle');\n  }, []);\n\n  const handleWaveformTimeUpdate = React.useCallback(\n    (time: number) => {\n      setCurrentTime(time);\n      onTimeUpdate?.(time, duration);\n    },\n    [duration, onTimeUpdate]\n  );\n\n  const handleWaveformFinish = React.useCallback(() => {\n    updateState('idle');\n    setCurrentTime(0);\n    onEnded?.();\n  }, [updateState, onEnded]);\n\n  const handleWaveformSeek = React.useCallback((time: number) => {\n    setCurrentTime(time);\n  }, []);\n\n  const iconSize =\n    size === 'sm' ? 'h-3.5 w-3.5' : size === 'lg' ? 'h-5 w-5' : 'h-4 w-4';\n\n  const getAriaLabel = () => {\n    if (ariaLabel) return ariaLabel;\n    if (title) return `${isPlaying ? 'Pause' : 'Play'} ${title}`;\n    return isPlaying ? 'Pause audio' : 'Play audio';\n  };\n\n  const renderPlayButton = () => (\n    <button\n      type=\"button\"\n      onClick={handlePlay}\n      disabled={disabled || isLoading}\n      className={cn(playButtonVariants({ variant, size }))}\n      aria-label={getAriaLabel()}\n      aria-pressed={isPlaying}\n    >\n      {isLoading ? (\n        <SpinnerIcon className={iconSize} />\n      ) : isPlaying ? (\n        <PauseIcon className={iconSize} />\n      ) : (\n        <PlayIcon className={iconSize} />\n      )}\n    </button>\n  );\n\n  const renderTime = () => {\n    if (!showTime) return null;\n    return (\n      <span className=\"font-mono text-xs text-neutral-500 tabular-nums dark:text-neutral-400\">\n        {formatTime(currentTime)} / {formatTime(duration)}\n      </span>\n    );\n  };\n\n  const renderPlaybackRateControl = () => {\n    if (!showPlaybackRate) return null;\n    return (\n      <select\n        value={playbackRate}\n        onChange={(e) => setPlaybackRate(Number(e.target.value))}\n        className=\"rounded border border-neutral-200 bg-transparent px-1 py-0.5 text-xs dark:border-neutral-700\"\n        aria-label=\"Playback speed\"\n      >\n        {playbackRates.map((rate) => (\n          <option key={rate} value={rate}>\n            {rate}x\n          </option>\n        ))}\n      </select>\n    );\n  };\n\n  // ============================================================================\n  // Inline Variant\n  // ============================================================================\n  if (variant === 'inline') {\n    const displayDuration = duration > 0 ? duration : (fallbackDuration ?? 0);\n    return (\n      <div className={cn(audioPlayerVariants({ variant, size }), className)}>\n        {renderPlayButton()}\n        {title && (\n          <span className=\"text-sm font-medium text-neutral-700 dark:text-neutral-300\">\n            {title}\n          </span>\n        )}\n        {showDuration && displayDuration > 0 && (\n          <span className=\"font-mono text-xs text-neutral-500 tabular-nums dark:text-neutral-400\">\n            {isPlaying ? formatTime(currentTime) : formatTime(displayDuration)}\n          </span>\n        )}\n      </div>\n    );\n  }\n\n  // ============================================================================\n  // Compact Variant\n  // ============================================================================\n  if (variant === 'compact') {\n    return (\n      <div className={cn(audioPlayerVariants({ variant, size }), className)}>\n        {renderPlayButton()}\n        <ProgressBar\n          currentTime={currentTime}\n          duration={duration}\n          onSeek={handleSeek}\n          disabled={disabled}\n        />\n        {renderTime()}\n        {renderPlaybackRateControl()}\n      </div>\n    );\n  }\n\n  // ============================================================================\n  // Waveform Variant\n  // ============================================================================\n  return (\n    <div className={cn(audioPlayerVariants({ variant, size }), className)}>\n      {title && (\n        <span className=\"text-sm font-medium text-neutral-700 dark:text-neutral-300\">\n          {title}\n        </span>\n      )}\n      <Waveform\n        src={src}\n        isPlaying={isPlaying}\n        onReady={handleWaveformReady}\n        onTimeUpdate={handleWaveformTimeUpdate}\n        onFinish={handleWaveformFinish}\n        onSeek={handleWaveformSeek}\n        waveColor={waveColor}\n        progressColor={progressColor}\n        height={waveformHeight}\n      />\n      <div className=\"flex items-center gap-3\">\n        {renderPlayButton()}\n        <div className=\"flex flex-1 items-center justify-between\">\n          {renderTime()}\n          {renderPlaybackRateControl()}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nAudioPlayer.displayName = 'AudioPlayer';\n\n// ============================================================================\n// Exports\n// ============================================================================\n\nexport { AudioPlayer, audioPlayerVariants, playButtonVariants, ProgressBar };\n","import * as React from 'react';\nimport { cva, type VariantProps } from 'class-variance-authority';\nimport { cn } from '../../utils/cn';\n\n// ============================================================================\n// Types & Interfaces\n// ============================================================================\n\nexport type AudioRecorderState =\n  | 'idle'\n  | 'listening'\n  | 'recording'\n  | 'paused'\n  | 'stopped'\n  | 'playback';\n\nexport interface AudioRecorderProps extends VariantProps<\n  typeof audioRecorderVariants\n> {\n  /** Current state of the recorder */\n  state?: AudioRecorderState;\n  /** Callback when state changes */\n  onStateChange?: (state: AudioRecorderState) => void;\n  /** Callback when recording is complete with the audio blob */\n  onRecordingComplete?: (blob: Blob, duration: number) => void;\n  /** Callback when recording starts */\n  onRecordingStart?: () => void;\n  /** Callback when an error occurs */\n  onError?: (error: Error) => void;\n  /** Maximum recording duration in seconds (0 for unlimited) */\n  maxDuration?: number;\n  /** Audio MIME type */\n  mimeType?: string;\n  /** Waveform color (uses theme primary by default) */\n  waveColor?: string;\n  /** Progress/recorded waveform color */\n  progressColor?: string;\n  /** Cursor color */\n  cursorColor?: string;\n  /** Height of the waveform display */\n  waveformHeight?: number;\n  /** Show time display */\n  showTime?: boolean;\n  /** Show waveform visualization */\n  showWaveform?: boolean;\n  /** Additional class name */\n  className?: string;\n  /** Accessible label */\n  'aria-label'?: string;\n  /** Pre-loaded audio URL for playback mode */\n  audioUrl?: string;\n  /** Whether the component is disabled */\n  disabled?: boolean;\n  /** Custom controls render function */\n  renderControls?: (props: AudioRecorderControlsRenderProps) => React.ReactNode;\n}\n\nexport interface AudioRecorderControlsRenderProps {\n  state: AudioRecorderState;\n  currentTime: number;\n  duration: number;\n  isRecording: boolean;\n  isPaused: boolean;\n  isPlaying: boolean;\n  onRecord: () => void;\n  onPause: () => void;\n  onResume: () => void;\n  onStop: () => void;\n  onPlay: () => void;\n  onSeek: (time: number) => void;\n  formatTime: (seconds: number) => string;\n}\n\n// ============================================================================\n// Variants\n// ============================================================================\n\nconst audioRecorderVariants = cva(\n  [\n    'relative flex flex-col gap-3',\n    'rounded-xl border border-border',\n    'bg-card text-card-foreground',\n    'transition-all duration-200',\n  ],\n  {\n    variants: {\n      size: {\n        sm: 'p-3',\n        md: 'p-4',\n        lg: 'p-5',\n      },\n      variant: {\n        default: '',\n        minimal: 'border-none bg-transparent shadow-none',\n        elevated: 'shadow-lg border-0',\n      },\n    },\n    defaultVariants: {\n      size: 'md',\n      variant: 'default',\n    },\n  }\n);\n\nconst waveformContainerVariants = cva(\n  [\n    'relative w-full overflow-hidden rounded-lg',\n    'bg-neutral-100 dark:bg-neutral-800',\n    'transition-all duration-200',\n  ],\n  {\n    variants: {\n      state: {\n        idle: 'opacity-50',\n        listening: 'opacity-75',\n        recording: '',\n        paused: 'opacity-90',\n        stopped: '',\n        playback: '',\n      },\n    },\n    defaultVariants: {\n      state: 'idle',\n    },\n  }\n);\n\nconst controlButtonVariants = cva(\n  [\n    'inline-flex items-center justify-center',\n    'rounded-full transition-all duration-200',\n    'focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2',\n    'disabled:pointer-events-none disabled:opacity-50',\n    'active:scale-95',\n  ],\n  {\n    variants: {\n      variant: {\n        primary: [\n          'bg-primary-600 text-white',\n          'hover:bg-primary-700',\n          'active:bg-primary-800',\n        ],\n        secondary: [\n          'bg-neutral-200 text-neutral-700',\n          'hover:bg-neutral-300',\n          'dark:bg-neutral-700 dark:text-neutral-200',\n          'dark:hover:bg-neutral-600',\n        ],\n        danger: [\n          'bg-red-600 text-white',\n          'hover:bg-red-700',\n          'active:bg-red-800',\n        ],\n        ghost: [\n          'bg-transparent text-neutral-600',\n          'hover:bg-neutral-100',\n          'dark:text-neutral-400 dark:hover:bg-neutral-800',\n        ],\n      },\n      size: {\n        sm: 'h-8 w-8',\n        md: 'h-10 w-10',\n        lg: 'h-12 w-12',\n      },\n    },\n    defaultVariants: {\n      variant: 'primary',\n      size: 'md',\n    },\n  }\n);\n\n// ============================================================================\n// Helper Functions\n// ============================================================================\n\nfunction formatTime(seconds: number): string {\n  const mins = Math.floor(seconds / 60);\n  const secs = Math.floor(seconds % 60);\n  return `${mins}:${secs.toString().padStart(2, '0')}`;\n}\n\n// ============================================================================\n// Icons\n// ============================================================================\n\nfunction MicrophoneIcon({ className }: { className?: string }) {\n  return (\n    <svg\n      className={className}\n      fill=\"none\"\n      viewBox=\"0 0 24 24\"\n      strokeWidth={2}\n      stroke=\"currentColor\"\n      aria-hidden=\"true\"\n    >\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        d=\"M12 18.75a6 6 0 006-6v-1.5m-6 7.5a6 6 0 01-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 01-3-3V4.5a3 3 0 116 0v8.25a3 3 0 01-3 3z\"\n      />\n    </svg>\n  );\n}\n\nfunction StopIcon({ className }: { className?: string }) {\n  return (\n    <svg\n      className={className}\n      fill=\"currentColor\"\n      viewBox=\"0 0 24 24\"\n      aria-hidden=\"true\"\n    >\n      <rect x=\"6\" y=\"6\" width=\"12\" height=\"12\" rx=\"2\" />\n    </svg>\n  );\n}\n\nfunction PlayIcon({ className }: { className?: string }) {\n  return (\n    <svg\n      className={className}\n      fill=\"currentColor\"\n      viewBox=\"0 0 24 24\"\n      aria-hidden=\"true\"\n    >\n      <path d=\"M8 5.14v14l11-7-11-7z\" />\n    </svg>\n  );\n}\n\nfunction PauseIcon({ className }: { className?: string }) {\n  return (\n    <svg\n      className={className}\n      fill=\"currentColor\"\n      viewBox=\"0 0 24 24\"\n      aria-hidden=\"true\"\n    >\n      <path d=\"M6 4h4v16H6V4zm8 0h4v16h-4V4z\" />\n    </svg>\n  );\n}\n\nfunction TrashIcon({ className }: { className?: string }) {\n  return (\n    <svg\n      className={className}\n      fill=\"none\"\n      viewBox=\"0 0 24 24\"\n      strokeWidth={2}\n      stroke=\"currentColor\"\n      aria-hidden=\"true\"\n    >\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        d=\"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0\"\n      />\n    </svg>\n  );\n}\n\n// ============================================================================\n// Recording Indicator\n// ============================================================================\n\ninterface RecordingIndicatorProps {\n  isRecording: boolean;\n  isPaused: boolean;\n}\n\nfunction RecordingIndicator({\n  isRecording,\n  isPaused,\n}: RecordingIndicatorProps) {\n  if (!isRecording && !isPaused) return null;\n\n  return (\n    <div className=\"flex items-center gap-2\">\n      <div\n        className={cn(\n          'h-3 w-3 rounded-full',\n          isRecording && !isPaused\n            ? 'animate-pulse bg-red-500'\n            : 'bg-yellow-500'\n        )}\n        aria-hidden=\"true\"\n      />\n      <span className=\"text-sm font-medium text-neutral-600 dark:text-neutral-400\">\n        {isPaused ? 'Paused' : 'Recording'}\n      </span>\n    </div>\n  );\n}\n\n// ============================================================================\n// Time Display\n// ============================================================================\n\ninterface TimeDisplayProps {\n  currentTime: number;\n  duration: number;\n  maxDuration?: number;\n  showMax?: boolean;\n}\n\nfunction TimeDisplay({\n  currentTime,\n  duration,\n  maxDuration,\n  showMax,\n}: TimeDisplayProps) {\n  return (\n    <div className=\"flex items-center gap-1 font-mono text-sm text-neutral-600 dark:text-neutral-400\">\n      <span>{formatTime(currentTime)}</span>\n      <span>/</span>\n      <span>{formatTime(showMax && maxDuration ? maxDuration : duration)}</span>\n    </div>\n  );\n}\n\n// ============================================================================\n// Live Visualizer (for recording mode without WaveSurfer)\n// ============================================================================\n\ninterface LiveVisualizerProps {\n  analyser: AnalyserNode | null;\n  isActive: boolean;\n  height: number;\n  barColor?: string;\n}\n\nfunction LiveVisualizer({\n  analyser,\n  isActive,\n  height,\n  barColor,\n}: LiveVisualizerProps) {\n  const canvasRef = React.useRef<HTMLCanvasElement>(null);\n  const animationRef = React.useRef<number | undefined>(undefined);\n\n  React.useEffect(() => {\n    if (!analyser || !canvasRef.current || !isActive) return;\n\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    if (!ctx) return;\n\n    const bufferLength = analyser.frequencyBinCount;\n    const dataArray = new Uint8Array(bufferLength);\n\n    const draw = () => {\n      if (!isActive) return;\n\n      analyser.getByteFrequencyData(dataArray);\n\n      ctx.fillStyle = 'transparent';\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n      const barWidth = (canvas.width / bufferLength) * 2.5;\n      let x = 0;\n\n      for (let i = 0; i < bufferLength; i++) {\n        const barHeight = (dataArray[i] / 255) * canvas.height;\n\n        // Use CSS variable for primary color or fallback\n        ctx.fillStyle =\n          barColor ||\n          getComputedStyle(document.documentElement).getPropertyValue(\n            '--color-primary-500'\n          ) ||\n          '#3b82f6';\n\n        ctx.fillRect(x, canvas.height - barHeight, barWidth, barHeight);\n\n        x += barWidth + 1;\n      }\n\n      animationRef.current = requestAnimationFrame(draw);\n    };\n\n    draw();\n\n    return () => {\n      if (animationRef.current) {\n        cancelAnimationFrame(animationRef.current);\n      }\n    };\n  }, [analyser, isActive, barColor]);\n\n  return (\n    <canvas\n      ref={canvasRef}\n      width={600}\n      height={height}\n      className=\"w-full\"\n      style={{ height }}\n    />\n  );\n}\n\n// ============================================================================\n// Main Component\n// ============================================================================\n\n/**\n * An audio recorder component with waveform visualization and custom controls.\n * Uses the Web Audio API and WaveSurfer.js for visualization.\n *\n * @example\n * ```tsx\n * // Basic usage\n * <AudioRecorder\n *   onRecordingComplete={(blob, duration) => {\n *     console.log('Recording complete:', blob, duration);\n *   }}\n * />\n *\n * // With max duration and custom styling\n * <AudioRecorder\n *   maxDuration={60}\n *   variant=\"elevated\"\n *   size=\"lg\"\n *   waveColor=\"#3b82f6\"\n *   progressColor=\"#1d4ed8\"\n * />\n *\n * // Playback mode with pre-loaded audio\n * <AudioRecorder\n *   audioUrl=\"/audio/message.wav\"\n *   state=\"stopped\"\n * />\n * ```\n */\nfunction AudioRecorder({\n  state: controlledState,\n  onStateChange,\n  onRecordingComplete,\n  onRecordingStart,\n  onError,\n  maxDuration = 0,\n  mimeType = 'audio/webm',\n  waveColor,\n  progressColor,\n  cursorColor,\n  waveformHeight = 80,\n  showTime = true,\n  showWaveform = true,\n  size,\n  variant,\n  className,\n  'aria-label': ariaLabel = 'Audio recorder',\n  audioUrl,\n  disabled = false,\n  renderControls,\n}: AudioRecorderProps) {\n  // State\n  const [internalState, setInternalState] =\n    React.useState<AudioRecorderState>('idle');\n  const state = controlledState ?? internalState;\n\n  const [currentTime, setCurrentTime] = React.useState(0);\n  const [duration, setDuration] = React.useState(0);\n  const [audioBlob, setAudioBlob] = React.useState<Blob | null>(null);\n  const [audioObjectUrl, setAudioObjectUrl] = React.useState<string | null>(\n    null\n  );\n  const [pendingBlob, setPendingBlob] = React.useState<Blob | null>(null);\n\n  // Refs\n  const waveformRef = React.useRef<HTMLDivElement>(null);\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const wavesurferRef = React.useRef<any>(null);\n  const mediaRecorderRef = React.useRef<MediaRecorder | null>(null);\n  const audioContextRef = React.useRef<AudioContext | null>(null);\n  const analyserRef = React.useRef<AnalyserNode | null>(null);\n  const streamRef = React.useRef<MediaStream | null>(null);\n  const chunksRef = React.useRef<Blob[]>([]);\n  const timerRef = React.useRef<number | undefined>(undefined);\n  const startTimeRef = React.useRef<number>(0);\n  const handleStopRef = React.useRef<() => void>(() => {});\n\n  // Update state\n  const updateState = React.useCallback(\n    (newState: AudioRecorderState) => {\n      if (!controlledState) {\n        setInternalState(newState);\n      }\n      onStateChange?.(newState);\n    },\n    [controlledState, onStateChange]\n  );\n\n  // Initialize WaveSurfer for playback\n  const initWaveSurfer = React.useCallback(async () => {\n    if (!waveformRef.current || !showWaveform) return;\n\n    // Dynamically import WaveSurfer\n    const WaveSurferModule = await import('wavesurfer.js');\n    const WaveSurfer = WaveSurferModule.default;\n\n    // Destroy existing instance\n    if (wavesurferRef.current) {\n      wavesurferRef.current.destroy();\n    }\n\n    // Get computed styles for theming\n    const computedStyle = getComputedStyle(document.documentElement);\n    const defaultWaveColor =\n      computedStyle.getPropertyValue('--color-primary-400').trim() || '#60a5fa';\n    const defaultProgressColor =\n      computedStyle.getPropertyValue('--color-primary-600').trim() || '#2563eb';\n    const defaultCursorColor =\n      computedStyle.getPropertyValue('--color-primary-800').trim() || '#1e40af';\n\n    wavesurferRef.current = WaveSurfer.create({\n      container: waveformRef.current,\n      waveColor: waveColor || defaultWaveColor,\n      progressColor: progressColor || defaultProgressColor,\n      cursorColor: cursorColor || defaultCursorColor,\n      cursorWidth: 2,\n      height: waveformHeight,\n      barWidth: 2,\n      barGap: 1,\n      barRadius: 2,\n      normalize: true,\n      hideScrollbar: true,\n    });\n\n    const ws = wavesurferRef.current;\n\n    ws.on('timeupdate', (time: number) => {\n      setCurrentTime(time);\n    });\n\n    ws.on('ready', () => {\n      if (wavesurferRef.current) {\n        setDuration(wavesurferRef.current.getDuration());\n      }\n    });\n\n    ws.on('finish', () => {\n      updateState('stopped');\n    });\n  }, [\n    showWaveform,\n    waveColor,\n    progressColor,\n    cursorColor,\n    waveformHeight,\n    updateState,\n  ]);\n\n  // Load audio URL if provided\n  React.useEffect(() => {\n    if (audioUrl && wavesurferRef.current) {\n      wavesurferRef.current.load(audioUrl);\n      updateState('stopped');\n    }\n  }, [audioUrl, updateState]);\n\n  // Load pending blob into WaveSurfer after the waveform container becomes available\n  React.useEffect(() => {\n    if (pendingBlob && waveformRef.current && state === 'stopped') {\n      const loadBlob = async () => {\n        // Initialize WaveSurfer if needed\n        if (!wavesurferRef.current) {\n          await initWaveSurfer();\n        }\n        // Load the blob\n        if (wavesurferRef.current && pendingBlob) {\n          wavesurferRef.current.loadBlob(pendingBlob);\n          setPendingBlob(null);\n        }\n      };\n      // Small delay to ensure the DOM is ready\n      const timer = setTimeout(loadBlob, 50);\n      return () => clearTimeout(timer);\n    }\n  }, [pendingBlob, state, initWaveSurfer]);\n\n  // Initialize on mount\n  React.useEffect(() => {\n    initWaveSurfer();\n\n    return () => {\n      if (wavesurferRef.current) {\n        wavesurferRef.current.destroy();\n      }\n      if (audioContextRef.current) {\n        audioContextRef.current.close();\n      }\n      if (streamRef.current) {\n        streamRef.current.getTracks().forEach((track) => track.stop());\n      }\n      if (audioObjectUrl) {\n        URL.revokeObjectURL(audioObjectUrl);\n      }\n      if (timerRef.current) {\n        clearInterval(timerRef.current);\n      }\n    };\n  }, [initWaveSurfer, audioObjectUrl]);\n\n  // Start recording\n  const handleRecord = React.useCallback(async () => {\n    if (disabled) return;\n\n    try {\n      // Request microphone access\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n      streamRef.current = stream;\n\n      // Create audio context for visualization\n      audioContextRef.current = new AudioContext();\n      const source = audioContextRef.current.createMediaStreamSource(stream);\n      analyserRef.current = audioContextRef.current.createAnalyser();\n      analyserRef.current.fftSize = 256;\n      source.connect(analyserRef.current);\n\n      // Create media recorder\n      const options = { mimeType };\n      if (!MediaRecorder.isTypeSupported(mimeType)) {\n        // Fallback to default\n        mediaRecorderRef.current = new MediaRecorder(stream);\n      } else {\n        mediaRecorderRef.current = new MediaRecorder(stream, options);\n      }\n\n      chunksRef.current = [];\n\n      mediaRecorderRef.current.ondataavailable = (e) => {\n        if (e.data.size > 0) {\n          chunksRef.current.push(e.data);\n        }\n      };\n\n      mediaRecorderRef.current.onstop = async () => {\n        const blob = new Blob(chunksRef.current, { type: mimeType });\n        setAudioBlob(blob);\n\n        // Clean up old URL\n        if (audioObjectUrl) {\n          URL.revokeObjectURL(audioObjectUrl);\n        }\n\n        const url = URL.createObjectURL(blob);\n        setAudioObjectUrl(url);\n\n        // Store the blob to load after the waveform container is rendered\n        setPendingBlob(blob);\n\n        onRecordingComplete?.(blob, duration);\n        updateState('stopped');\n      };\n\n      // Start recording\n      mediaRecorderRef.current.start(100);\n      startTimeRef.current = Date.now();\n      updateState('recording');\n      onRecordingStart?.();\n\n      // Start timer\n      timerRef.current = window.setInterval(() => {\n        const elapsed = (Date.now() - startTimeRef.current) / 1000;\n        setCurrentTime(elapsed);\n        setDuration(elapsed);\n\n        // Check max duration\n        if (maxDuration > 0 && elapsed >= maxDuration) {\n          handleStopRef.current();\n        }\n      }, 100);\n    } catch (error) {\n      onError?.(error as Error);\n      updateState('idle');\n    }\n  }, [\n    disabled,\n    mimeType,\n    maxDuration,\n    audioObjectUrl,\n    duration,\n    initWaveSurfer,\n    onRecordingComplete,\n    onRecordingStart,\n    onError,\n    updateState,\n  ]);\n\n  // Pause recording\n  const handlePause = React.useCallback(() => {\n    if (\n      mediaRecorderRef.current &&\n      mediaRecorderRef.current.state === 'recording'\n    ) {\n      mediaRecorderRef.current.pause();\n      if (timerRef.current) {\n        clearInterval(timerRef.current);\n      }\n      updateState('paused');\n    } else if (\n      wavesurferRef.current &&\n      (state === 'playback' || state === 'stopped')\n    ) {\n      wavesurferRef.current.pause();\n      updateState('paused');\n    }\n  }, [state, updateState]);\n\n  // Resume recording\n  const handleResume = React.useCallback(() => {\n    if (\n      mediaRecorderRef.current &&\n      mediaRecorderRef.current.state === 'paused'\n    ) {\n      mediaRecorderRef.current.resume();\n      const pausedTime = currentTime;\n      startTimeRef.current = Date.now() - pausedTime * 1000;\n      timerRef.current = window.setInterval(() => {\n        const elapsed = (Date.now() - startTimeRef.current) / 1000;\n        setCurrentTime(elapsed);\n        setDuration(elapsed);\n\n        if (maxDuration > 0 && elapsed >= maxDuration) {\n          handleStopRef.current();\n        }\n      }, 100);\n      updateState('recording');\n    } else if (wavesurferRef.current && state === 'paused') {\n      wavesurferRef.current.play();\n      updateState('playback');\n    }\n  }, [currentTime, maxDuration, state, updateState]);\n\n  // Stop recording\n  const handleStop = React.useCallback(() => {\n    if (timerRef.current) {\n      clearInterval(timerRef.current);\n    }\n\n    if (\n      mediaRecorderRef.current &&\n      (mediaRecorderRef.current.state === 'recording' ||\n        mediaRecorderRef.current.state === 'paused')\n    ) {\n      mediaRecorderRef.current.stop();\n    }\n\n    if (streamRef.current) {\n      streamRef.current.getTracks().forEach((track) => track.stop());\n    }\n\n    if (audioContextRef.current) {\n      audioContextRef.current.close();\n      audioContextRef.current = null;\n    }\n\n    analyserRef.current = null;\n    // State will be updated in onstop handler\n  }, []);\n\n  // Keep ref updated for use inside intervals\n  handleStopRef.current = handleStop;\n\n  // Play recording\n  const handlePlay = React.useCallback(() => {\n    if (wavesurferRef.current) {\n      wavesurferRef.current.play();\n      updateState('playback');\n    }\n  }, [updateState]);\n\n  // Seek\n  const handleSeek = React.useCallback((time: number) => {\n    if (wavesurferRef.current) {\n      const progress = time / wavesurferRef.current.getDuration();\n      wavesurferRef.current.seekTo(progress);\n      setCurrentTime(time);\n    }\n  }, []);\n\n  // Delete recording\n  const handleDelete = React.useCallback(() => {\n    setAudioBlob(null);\n    if (audioObjectUrl) {\n      URL.revokeObjectURL(audioObjectUrl);\n      setAudioObjectUrl(null);\n    }\n    setCurrentTime(0);\n    setDuration(0);\n    updateState('idle');\n  }, [audioObjectUrl, updateState]);\n\n  // Computed values\n  const isRecording = state === 'recording';\n  const isPaused = state === 'paused';\n  const isPlaying = state === 'playback';\n  const hasRecording = audioBlob !== null || audioUrl !== undefined;\n\n  // Control render props\n  const controlRenderProps: AudioRecorderControlsRenderProps = {\n    state,\n    currentTime,\n    duration,\n    isRecording,\n    isPaused,\n    isPlaying,\n    onRecord: handleRecord,\n    onPause: handlePause,\n    onResume: handleResume,\n    onStop: handleStop,\n    onPlay: handlePlay,\n    onSeek: handleSeek,\n    formatTime,\n  };\n\n  return (\n    <div\n      className={cn(audioRecorderVariants({ size, variant }), className)}\n      role=\"group\"\n      aria-label={ariaLabel}\n    >\n      {/* Waveform / Visualizer */}\n      {showWaveform && (\n        <div\n          className={cn(waveformContainerVariants({ state }))}\n          style={{ height: waveformHeight }}\n        >\n          {(state === 'recording' || state === 'listening') && !hasRecording ? (\n            <LiveVisualizer\n              analyser={analyserRef.current}\n              isActive={isRecording}\n              height={waveformHeight}\n              barColor={waveColor}\n            />\n          ) : (\n            <div ref={waveformRef} className=\"w-full\" />\n          )}\n        </div>\n      )}\n\n      {/* Status and Time */}\n      {showTime && (\n        <div className=\"flex items-center justify-between\">\n          <RecordingIndicator isRecording={isRecording} isPaused={isPaused} />\n          <TimeDisplay\n            currentTime={currentTime}\n            duration={duration}\n            maxDuration={maxDuration}\n            showMax={isRecording || isPaused}\n          />\n        </div>\n      )}\n\n      {/* Controls */}\n      {renderControls ? (\n        renderControls(controlRenderProps)\n      ) : (\n        <DefaultControls\n          {...controlRenderProps}\n          disabled={disabled}\n          hasRecording={hasRecording}\n          onDelete={handleDelete}\n        />\n      )}\n    </div>\n  );\n}\n\nAudioRecorder.displayName = 'AudioRecorder';\n\n// ============================================================================\n// Default Controls\n// ============================================================================\n\ninterface DefaultControlsProps extends AudioRecorderControlsRenderProps {\n  disabled?: boolean;\n  hasRecording: boolean;\n  onDelete: () => void;\n}\n\nfunction DefaultControls({\n  state,\n  isRecording,\n  isPaused,\n  isPlaying,\n  hasRecording,\n  disabled,\n  onRecord,\n  onPause,\n  onResume,\n  onStop,\n  onPlay,\n  onDelete,\n}: DefaultControlsProps) {\n  return (\n    <div className=\"flex items-center justify-center gap-3\">\n      {/* Delete button - only when we have a recording */}\n      {hasRecording && !isRecording && (\n        <button\n          type=\"button\"\n          onClick={onDelete}\n          disabled={disabled}\n          className={cn(\n            controlButtonVariants({ variant: 'ghost', size: 'md' })\n          )}\n          aria-label=\"Delete recording\"\n        >\n          <TrashIcon className=\"h-5 w-5\" />\n        </button>\n      )}\n\n      {/* Main control button */}\n      {state === 'idle' && (\n        <button\n          type=\"button\"\n          onClick={onRecord}\n          disabled={disabled}\n          className={cn(\n            controlButtonVariants({ variant: 'danger', size: 'lg' })\n          )}\n          aria-label=\"Start recording\"\n        >\n          <MicrophoneIcon className=\"h-6 w-6\" />\n        </button>\n      )}\n\n      {isRecording && (\n        <>\n          <button\n            type=\"button\"\n            onClick={onPause}\n            disabled={disabled}\n            className={cn(\n              controlButtonVariants({ variant: 'secondary', size: 'md' })\n            )}\n            aria-label=\"Pause recording\"\n          >\n            <PauseIcon className=\"h-5 w-5\" />\n          </button>\n          <button\n            type=\"button\"\n            onClick={onStop}\n            disabled={disabled}\n            className={cn(\n              controlButtonVariants({ variant: 'danger', size: 'lg' })\n            )}\n            aria-label=\"Stop recording\"\n          >\n            <StopIcon className=\"h-6 w-6\" />\n          </button>\n        </>\n      )}\n\n      {isPaused && !hasRecording && (\n        <>\n          <button\n            type=\"button\"\n            onClick={onResume}\n            disabled={disabled}\n            className={cn(\n              controlButtonVariants({ variant: 'danger', size: 'lg' })\n            )}\n            aria-label=\"Resume recording\"\n          >\n            <MicrophoneIcon className=\"h-6 w-6\" />\n          </button>\n          <button\n            type=\"button\"\n            onClick={onStop}\n            disabled={disabled}\n            className={cn(\n              controlButtonVariants({ variant: 'secondary', size: 'md' })\n            )}\n            aria-label=\"Stop recording\"\n          >\n            <StopIcon className=\"h-5 w-5\" />\n          </button>\n        </>\n      )}\n\n      {(state === 'stopped' || (isPaused && hasRecording)) && hasRecording && (\n        <button\n          type=\"button\"\n          onClick={isPlaying || isPaused ? onPause : onPlay}\n          disabled={disabled}\n          className={cn(\n            controlButtonVariants({ variant: 'primary', size: 'lg' })\n          )}\n          aria-label={\n            isPaused\n              ? 'Resume playback'\n              : isPlaying\n                ? 'Pause playback'\n                : 'Play recording'\n          }\n        >\n          {isPaused || !isPlaying ? (\n            <PlayIcon className=\"h-6 w-6\" />\n          ) : (\n            <PauseIcon className=\"h-6 w-6\" />\n          )}\n        </button>\n      )}\n\n      {isPlaying && (\n        <button\n          type=\"button\"\n          onClick={onPause}\n          disabled={disabled}\n          className={cn(\n            controlButtonVariants({ variant: 'primary', size: 'lg' })\n          )}\n          aria-label=\"Pause playback\"\n        >\n          <PauseIcon className=\"h-6 w-6\" />\n        </button>\n      )}\n    </div>\n  );\n}\n\n// ============================================================================\n// Exports\n// ============================================================================\n\nexport {\n  AudioRecorder,\n  audioRecorderVariants,\n  waveformContainerVariants,\n  controlButtonVariants,\n  formatTime,\n};\n","import React, {\n  createContext,\n  useContext,\n  useCallback,\n  useState,\n  useMemo,\n  type ReactNode,\n} from 'react';\nimport { useCommandK } from '../../hooks/useKeyboardShortcut';\n\n// =============================================================================\n// Types\n// =============================================================================\n\nexport interface CommandPaletteItem {\n  /** Unique identifier */\n  id: string;\n  /** Display label */\n  label: string;\n  /** Optional subtitle/description */\n  subtitle?: string;\n  /** Optional description text */\n  description?: string;\n  /** Category/group for grouping items */\n  category?: string;\n  /** Custom icon element */\n  icon?: ReactNode;\n  /** Keyboard shortcut hint */\n  shortcut?: string;\n  /** Whether the item is disabled */\n  disabled?: boolean;\n  /** Additional metadata for filtering/display */\n  metadata?: Record<string, unknown>;\n}\n\nexport interface CommandPaletteCategory {\n  /** Unique identifier for the category */\n  id: string;\n  /** Display label */\n  label: string;\n  /** Optional icon */\n  icon?: ReactNode;\n  /** Optional color class for styling */\n  colorClass?: string;\n}\n\nexport interface CommandPaletteContextValue {\n  /** Whether the palette is currently open */\n  isOpen: boolean;\n  /** Open the command palette */\n  open: () => void;\n  /** Close the command palette */\n  close: () => void;\n  /** Toggle the command palette */\n  toggle: () => void;\n  /** Current search query */\n  query: string;\n  /** Set the search query */\n  setQuery: (query: string) => void;\n  /** Currently selected item index */\n  selectedIndex: number;\n  /** Set the selected item index */\n  setSelectedIndex: (index: number) => void;\n  /** Active category filter */\n  activeCategory: string | null;\n  /** Set the active category filter */\n  setActiveCategory: (category: string | null) => void;\n  /** Register items (used by consumers) */\n  items: CommandPaletteItem[];\n  /** Register categories (used by consumers) */\n  categories: CommandPaletteCategory[];\n  /** Set items */\n  setItems: (items: CommandPaletteItem[]) => void;\n  /** Set categories */\n  setCategories: (categories: CommandPaletteCategory[]) => void;\n}\n\n// =============================================================================\n// Context\n// =============================================================================\n\nconst CommandPaletteContext = createContext<CommandPaletteContextValue | null>(\n  null\n);\n\n// =============================================================================\n// Provider\n// =============================================================================\n\nexport interface CommandPaletteProviderProps {\n  children: ReactNode;\n  /** Whether to enable the Cmd/Ctrl+K shortcut (default: true) */\n  enableShortcut?: boolean;\n  /** Custom event name for opening (for integration with other systems) */\n  customEventName?: string;\n}\n\nexport function CommandPaletteProvider({\n  children,\n  enableShortcut = true,\n  customEventName,\n}: CommandPaletteProviderProps): React.JSX.Element {\n  const [isOpen, setIsOpen] = useState(false);\n  const [query, setQuery] = useState('');\n  const [selectedIndex, setSelectedIndex] = useState(-1);\n  const [activeCategory, setActiveCategory] = useState<string | null>(null);\n  const [items, setItems] = useState<CommandPaletteItem[]>([]);\n  const [categories, setCategories] = useState<CommandPaletteCategory[]>([]);\n\n  const open = useCallback(() => {\n    setIsOpen(true);\n    setQuery('');\n    setSelectedIndex(-1);\n    setActiveCategory(null);\n  }, []);\n\n  const close = useCallback(() => {\n    setIsOpen(false);\n    setQuery('');\n    setSelectedIndex(-1);\n  }, []);\n\n  const toggle = useCallback(() => {\n    if (isOpen) {\n      close();\n    } else {\n      open();\n    }\n  }, [isOpen, open, close]);\n\n  // Register Cmd/Ctrl+K shortcut\n  useCommandK(toggle, enableShortcut);\n\n  // Listen for custom event (for integration with other systems)\n  React.useEffect(() => {\n    if (!customEventName) return;\n\n    const handler = () => open();\n    document.addEventListener(customEventName, handler);\n    return () => document.removeEventListener(customEventName, handler);\n  }, [customEventName, open]);\n\n  const contextValue = useMemo<CommandPaletteContextValue>(\n    () => ({\n      isOpen,\n      open,\n      close,\n      toggle,\n      query,\n      setQuery,\n      selectedIndex,\n      setSelectedIndex,\n      activeCategory,\n      setActiveCategory,\n      items,\n      categories,\n      setItems,\n      setCategories,\n    }),\n    [\n      isOpen,\n      open,\n      close,\n      toggle,\n      query,\n      selectedIndex,\n      activeCategory,\n      items,\n      categories,\n    ]\n  );\n\n  return (\n    <CommandPaletteContext.Provider value={contextValue}>\n      {children}\n    </CommandPaletteContext.Provider>\n  );\n}\n\n// =============================================================================\n// Hook\n// =============================================================================\n\n/**\n * Hook to access the command palette context.\n * Must be used within a CommandPaletteProvider.\n *\n * @example\n * ```tsx\n * function SearchButton() {\n *   const { open } = useCommandPalette();\n *   return <button onClick={open}>Search (K)</button>;\n * }\n * ```\n */\nexport function useCommandPalette(): CommandPaletteContextValue {\n  const context = useContext(CommandPaletteContext);\n  if (!context) {\n    throw new Error(\n      'useCommandPalette must be used within a CommandPaletteProvider'\n    );\n  }\n  return context;\n}\n","import React, { useCallback, useEffect, useRef, useMemo } from 'react';\nimport { cn } from '../../utils/cn';\nimport { useEscapeKey } from '../../hooks/useEscapeKey';\nimport { useClickOutside } from '../../hooks/useClickOutside';\nimport {\n  useCommandPalette,\n  type CommandPaletteItem,\n  type CommandPaletteCategory,\n} from './CommandPaletteProvider';\n\n// =============================================================================\n// Icons\n// =============================================================================\n\nconst SearchIcon = () => (\n  <svg\n    className=\"h-5 w-5\"\n    fill=\"none\"\n    viewBox=\"0 0 24 24\"\n    stroke=\"currentColor\"\n    strokeWidth={2}\n  >\n    <path\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"\n    />\n  </svg>\n);\n\nconst XIcon = () => (\n  <svg\n    className=\"h-4 w-4\"\n    fill=\"none\"\n    viewBox=\"0 0 24 24\"\n    stroke=\"currentColor\"\n    strokeWidth={2}\n  >\n    <path\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      d=\"M6 18L18 6M6 6l12 12\"\n    />\n  </svg>\n);\n\nconst SpinnerIcon = () => (\n  <svg className=\"h-4 w-4 animate-spin\" fill=\"none\" viewBox=\"0 0 24 24\">\n    <circle\n      className=\"opacity-25\"\n      cx=\"12\"\n      cy=\"12\"\n      r=\"10\"\n      stroke=\"currentColor\"\n      strokeWidth=\"4\"\n    />\n    <path\n      className=\"opacity-75\"\n      fill=\"currentColor\"\n      d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n    />\n  </svg>\n);\n\n// =============================================================================\n// Helpers\n// =============================================================================\n\n/** Check if running on Mac */\nconst isMac =\n  typeof window !== 'undefined' &&\n  typeof window.navigator !== 'undefined' &&\n  /Mac|iPod|iPhone|iPad/.test(window.navigator.platform);\n\n// =============================================================================\n// CommandPalette Component\n// =============================================================================\n\nexport interface CommandPaletteProps {\n  /** Placeholder text for search input */\n  placeholder?: string;\n  /** Whether search is loading */\n  isLoading?: boolean;\n  /** Called when an item is selected */\n  onSelect?: (item: CommandPaletteItem) => void;\n  /** Custom empty state content */\n  emptyState?: React.ReactNode;\n  /** Custom render function for items */\n  renderItem?: (\n    item: CommandPaletteItem,\n    options: { isSelected: boolean; index: number }\n  ) => React.ReactNode;\n  /** Custom footer content */\n  footer?: React.ReactNode;\n  /** Additional CSS classes for the modal */\n  className?: string;\n  /** Test ID for testing */\n  'data-testid'?: string;\n}\n\nexport function CommandPalette({\n  placeholder = 'Search...',\n  isLoading = false,\n  onSelect,\n  emptyState,\n  renderItem,\n  footer,\n  className,\n  'data-testid': testId = 'command-palette',\n}: CommandPaletteProps): React.JSX.Element | null {\n  const {\n    isOpen,\n    close,\n    query,\n    setQuery,\n    selectedIndex,\n    setSelectedIndex,\n    activeCategory,\n    setActiveCategory,\n    items,\n    categories,\n  } = useCommandPalette();\n\n  const inputRef = useRef<HTMLInputElement>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const listRef = useRef<HTMLDivElement>(null);\n\n  // Filter items by query and category\n  const filteredItems = useMemo(() => {\n    let result = items;\n\n    // Filter by category\n    if (activeCategory) {\n      result = result.filter((item) => item.category === activeCategory);\n    }\n\n    // Filter by query\n    if (query.trim()) {\n      const lowerQuery = query.toLowerCase();\n      result = result.filter(\n        (item) =>\n          item.label.toLowerCase().includes(lowerQuery) ||\n          item.subtitle?.toLowerCase().includes(lowerQuery) ||\n          item.description?.toLowerCase().includes(lowerQuery)\n      );\n    }\n\n    return result;\n  }, [items, query, activeCategory]);\n\n  // Group items by category\n  const groupedItems = useMemo(() => {\n    const groups: Map<string, CommandPaletteItem[]> = new Map();\n\n    filteredItems.forEach((item) => {\n      const category = item.category ?? 'Other';\n      const group = groups.get(category) ?? [];\n      group.push(item);\n      groups.set(category, group);\n    });\n\n    return groups;\n  }, [filteredItems]);\n\n  // Handle close\n  useEscapeKey(close, isOpen);\n  useClickOutside(containerRef, close);\n\n  // Focus input when opened\n  useEffect(() => {\n    if (isOpen) {\n      setTimeout(() => inputRef.current?.focus(), 50);\n    }\n  }, [isOpen]);\n\n  // Reset selected index when filtered items change\n  useEffect(() => {\n    setSelectedIndex(filteredItems.length > 0 ? 0 : -1);\n  }, [filteredItems.length, setSelectedIndex]);\n\n  // Scroll selected item into view\n  useEffect(() => {\n    if (selectedIndex >= 0 && listRef.current) {\n      const selectedElement = listRef.current.querySelector(\n        `[data-index=\"${selectedIndex}\"]`\n      ) as HTMLElement | null;\n      selectedElement?.scrollIntoView({ block: 'nearest' });\n    }\n  }, [selectedIndex]);\n\n  // Keyboard navigation\n  const handleKeyDown = useCallback(\n    (e: React.KeyboardEvent) => {\n      switch (e.key) {\n        case 'ArrowDown':\n          e.preventDefault();\n          setSelectedIndex(\n            Math.min(selectedIndex + 1, filteredItems.length - 1)\n          );\n          break;\n        case 'ArrowUp':\n          e.preventDefault();\n          setSelectedIndex(Math.max(selectedIndex - 1, 0));\n          break;\n        case 'Enter':\n          e.preventDefault();\n          if (selectedIndex >= 0 && filteredItems[selectedIndex]) {\n            const item = filteredItems[selectedIndex];\n            if (!item.disabled) {\n              onSelect?.(item);\n              close();\n            }\n          }\n          break;\n        case 'Tab':\n          e.preventDefault();\n          // Cycle through categories\n          if (categories.length > 0) {\n            const currentIdx = activeCategory\n              ? categories.findIndex((c) => c.id === activeCategory)\n              : -1;\n            const nextIdx = e.shiftKey\n              ? currentIdx <= 0\n                ? categories.length - 1\n                : currentIdx - 1\n              : currentIdx >= categories.length - 1\n                ? -1\n                : currentIdx + 1;\n            setActiveCategory(nextIdx === -1 ? null : categories[nextIdx].id);\n          }\n          break;\n      }\n    },\n    [\n      filteredItems,\n      selectedIndex,\n      setSelectedIndex,\n      onSelect,\n      close,\n      categories,\n      activeCategory,\n      setActiveCategory,\n    ]\n  );\n\n  const handleItemClick = useCallback(\n    (item: CommandPaletteItem) => {\n      if (!item.disabled) {\n        onSelect?.(item);\n        close();\n      }\n    },\n    [onSelect, close]\n  );\n\n  const getCategoryInfo = useCallback(\n    (categoryId: string): CommandPaletteCategory | undefined => {\n      return categories.find((c) => c.id === categoryId);\n    },\n    [categories]\n  );\n\n  if (!isOpen) return null;\n\n  // Calculate global index for items across groups\n  let globalIndex = -1;\n\n  return (\n    <>\n      {/* Backdrop */}\n      <div\n        className=\"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm dark:bg-black/70\"\n        aria-hidden=\"true\"\n      />\n\n      {/* Modal */}\n      <div className=\"fixed inset-x-0 top-20 z-50 mx-auto max-w-2xl px-4\">\n        <div\n          ref={containerRef}\n          data-testid={testId}\n          className={cn(\n            'rounded-xl border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-800',\n            'overflow-hidden shadow-2xl',\n            className\n          )}\n        >\n          {/* Search Input */}\n          <div className=\"relative border-b border-gray-200 dark:border-gray-700\">\n            <div className=\"absolute top-1/2 left-4 -translate-y-1/2 text-gray-400\">\n              <SearchIcon />\n            </div>\n            <input\n              ref={inputRef}\n              type=\"text\"\n              value={query}\n              onChange={(e) => setQuery(e.target.value)}\n              onKeyDown={handleKeyDown}\n              placeholder={placeholder}\n              // eslint-disable-next-line jsx-a11y/no-autofocus\n              autoFocus\n              data-testid={`${testId}-input`}\n              className={cn(\n                'w-full bg-transparent py-4 pr-12 pl-12 text-base',\n                'focus:outline-none dark:text-white dark:placeholder-gray-400'\n              )}\n            />\n            {query && (\n              <button\n                onClick={() => setQuery('')}\n                data-testid={`${testId}-clear`}\n                className=\"absolute top-1/2 right-12 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n              >\n                <XIcon />\n              </button>\n            )}\n            {isLoading && (\n              <div className=\"text-primary-500 absolute top-1/2 right-4 -translate-y-1/2\">\n                <SpinnerIcon />\n              </div>\n            )}\n          </div>\n\n          {/* Category Filters */}\n          {categories.length > 0 && (\n            <div className=\"flex items-center gap-1 overflow-x-auto border-b border-gray-100 p-2 dark:border-gray-700\">\n              <button\n                onClick={() => setActiveCategory(null)}\n                data-testid={`${testId}-filter-all`}\n                className={cn(\n                  'rounded px-2 py-1 text-xs font-medium transition-colors',\n                  activeCategory === null\n                    ? 'bg-primary-500 text-white'\n                    : 'text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700'\n                )}\n              >\n                All\n              </button>\n              {categories.map((cat) => (\n                <button\n                  key={cat.id}\n                  onClick={() => setActiveCategory(cat.id)}\n                  data-testid={`${testId}-filter-${cat.id}`}\n                  className={cn(\n                    'flex items-center gap-1 rounded px-2 py-1 text-xs font-medium transition-colors',\n                    activeCategory === cat.id\n                      ? 'bg-primary-500 text-white'\n                      : 'text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700'\n                  )}\n                >\n                  {cat.icon && <span className=\"h-3 w-3\">{cat.icon}</span>}\n                  {cat.label}\n                </button>\n              ))}\n            </div>\n          )}\n\n          {/* Results List */}\n          <div ref={listRef} className=\"max-h-[60vh] overflow-y-auto\">\n            {filteredItems.length === 0 ? (\n              <div className=\"p-8 text-center text-gray-500 dark:text-gray-400\">\n                {emptyState ?? (\n                  <>\n                    <div className=\"mx-auto mb-2 h-8 w-8 opacity-50\">\n                      <SearchIcon />\n                    </div>\n                    <p className=\"text-sm\">\n                      {query.trim()\n                        ? `No results for \"${query}\"`\n                        : 'Start typing to search...'}\n                    </p>\n                  </>\n                )}\n              </div>\n            ) : (\n              Array.from(groupedItems.entries()).map(\n                ([categoryId, categoryItems]) => {\n                  const categoryInfo = getCategoryInfo(categoryId);\n                  return (\n                    <div key={categoryId}>\n                      {/* Group Header */}\n                      <div\n                        className={cn(\n                          'sticky top-0 px-3 py-2 text-xs font-semibold',\n                          'text-gray-500 dark:text-gray-400',\n                          'bg-gray-50 dark:bg-gray-900/50'\n                        )}\n                      >\n                        {categoryInfo?.icon && (\n                          <span\n                            className={cn(\n                              'mr-2 inline-block h-4 w-4 align-middle',\n                              categoryInfo.colorClass\n                            )}\n                          >\n                            {categoryInfo.icon}\n                          </span>\n                        )}\n                        {categoryInfo?.label ?? categoryId} (\n                        {categoryItems.length})\n                      </div>\n\n                      {/* Group Items */}\n                      {categoryItems.map((item) => {\n                        globalIndex++;\n                        const currentIndex = globalIndex;\n                        const isSelected = currentIndex === selectedIndex;\n\n                        if (renderItem) {\n                          return (\n                            <div\n                              key={item.id}\n                              role=\"option\"\n                              aria-selected={isSelected}\n                              data-index={currentIndex}\n                              onClick={() => handleItemClick(item)}\n                              onKeyDown={(e) => {\n                                if (e.key === 'Enter' || e.key === ' ') {\n                                  e.preventDefault();\n                                  handleItemClick(item);\n                                }\n                              }}\n                              onMouseEnter={() =>\n                                setSelectedIndex(currentIndex)\n                              }\n                              tabIndex={0}\n                            >\n                              {renderItem(item, {\n                                isSelected,\n                                index: currentIndex,\n                              })}\n                            </div>\n                          );\n                        }\n\n                        return (\n                          <button\n                            key={item.id}\n                            data-index={currentIndex}\n                            onClick={() => handleItemClick(item)}\n                            onMouseEnter={() => setSelectedIndex(currentIndex)}\n                            disabled={item.disabled}\n                            className={cn(\n                              'flex w-full items-start gap-3 px-4 py-3 text-left transition-colors',\n                              isSelected\n                                ? 'bg-primary-50 dark:bg-primary-500/20'\n                                : 'hover:bg-gray-50 dark:hover:bg-gray-700/50',\n                              item.disabled && 'cursor-not-allowed opacity-50'\n                            )}\n                          >\n                            {item.icon && (\n                              <div\n                                className={cn(\n                                  'mt-0.5 h-4 w-4 flex-shrink-0',\n                                  isSelected\n                                    ? 'text-primary-600 dark:text-primary-400'\n                                    : 'text-gray-400'\n                                )}\n                              >\n                                {item.icon}\n                              </div>\n                            )}\n                            <div className=\"min-w-0 flex-1\">\n                              <div className=\"truncate text-sm font-medium text-gray-900 dark:text-white\">\n                                {item.label}\n                              </div>\n                              {item.subtitle && (\n                                <div className=\"truncate text-xs text-gray-500 dark:text-gray-400\">\n                                  {item.subtitle}\n                                </div>\n                              )}\n                              {item.description && (\n                                <div className=\"mt-0.5 truncate text-xs text-gray-400 dark:text-gray-500\">\n                                  {item.description}\n                                </div>\n                              )}\n                            </div>\n                            {item.shortcut && (\n                              <kbd\n                                className={cn(\n                                  'hidden items-center px-1.5 py-0.5 text-[10px] sm:inline-flex',\n                                  'rounded border bg-gray-100 dark:bg-gray-700',\n                                  'border-gray-200 dark:border-gray-600',\n                                  'text-gray-600 dark:text-gray-400'\n                                )}\n                              >\n                                {item.shortcut}\n                              </kbd>\n                            )}\n                          </button>\n                        );\n                      })}\n                    </div>\n                  );\n                }\n              )\n            )}\n          </div>\n\n          {/* Footer */}\n          {footer ?? (\n            <div\n              className={cn(\n                'border-t border-gray-100 p-2 dark:border-gray-700',\n                'bg-gray-50 text-xs text-gray-500 dark:bg-gray-900/50 dark:text-gray-400',\n                'flex items-center justify-between'\n              )}\n            >\n              <div className=\"flex items-center gap-2\">\n                <kbd className=\"rounded border border-gray-200 bg-white px-1 py-0.5 dark:border-gray-600 dark:bg-gray-700\">\n                  \n                </kbd>\n                <span>navigate</span>\n                <kbd className=\"ml-2 rounded border border-gray-200 bg-white px-1 py-0.5 dark:border-gray-600 dark:bg-gray-700\">\n                  \n                </kbd>\n                <span>select</span>\n                <kbd className=\"ml-2 rounded border border-gray-200 bg-white px-1 py-0.5 dark:border-gray-600 dark:bg-gray-700\">\n                  esc\n                </kbd>\n                <span>close</span>\n              </div>\n              <span>{filteredItems.length} results</span>\n            </div>\n          )}\n        </div>\n      </div>\n    </>\n  );\n}\n\n// =============================================================================\n// CommandPaletteTrigger Component\n// =============================================================================\n\nexport interface CommandPaletteTriggerProps {\n  /** Button content (default shows search icon and keyboard hint) */\n  children?: React.ReactNode;\n  /** Placeholder text to show in the trigger */\n  placeholder?: string;\n  /** Additional CSS classes */\n  className?: string;\n  /** Test ID for testing */\n  'data-testid'?: string;\n}\n\nexport function CommandPaletteTrigger({\n  children,\n  placeholder = 'Search...',\n  className,\n  'data-testid': testId = 'command-palette-trigger',\n}: CommandPaletteTriggerProps): React.JSX.Element {\n  const { open } = useCommandPalette();\n\n  return (\n    <button\n      onClick={open}\n      data-testid={testId}\n      className={cn(\n        'flex items-center gap-3 rounded-lg border border-gray-300 dark:border-gray-600',\n        'bg-white px-4 py-2.5 text-sm text-gray-500 dark:bg-gray-700 dark:text-gray-400',\n        'hover:border-gray-400 dark:hover:border-gray-500',\n        'transition-colors hover:bg-gray-50 dark:hover:bg-gray-600',\n        'min-w-[200px] sm:min-w-[300px]',\n        className\n      )}\n    >\n      {children ?? (\n        <>\n          <SearchIcon />\n          <span className=\"flex-1 text-left whitespace-nowrap\">\n            {placeholder}\n          </span>\n          <kbd\n            className={cn(\n              'inline-flex items-center gap-0.5 px-2 py-0.5',\n              'rounded border border-gray-200 bg-gray-100 dark:border-gray-500 dark:bg-gray-600',\n              'flex-shrink-0 text-xs text-gray-600 dark:text-gray-300'\n            )}\n          >\n            {isMac ? '' : 'Ctrl'}+K\n          </kbd>\n        </>\n      )}\n    </button>\n  );\n}\n","import * as React from 'react';\nimport { cva, type VariantProps } from 'class-variance-authority';\nimport { cn } from '../../utils/cn';\nimport type { Conversation, MessageParticipant } from './types';\n\n// ============================================================================\n// Conversation Header Component\n// ============================================================================\n\nconst headerVariants = cva(\n  [\n    'flex items-center gap-3 px-4 py-3',\n    'bg-white dark:bg-neutral-900',\n    'border-b border-neutral-200 dark:border-neutral-700',\n  ],\n  {\n    variants: {\n      size: {\n        sm: 'py-2',\n        md: 'py-3',\n        lg: 'py-4',\n      },\n    },\n    defaultVariants: {\n      size: 'md',\n    },\n  }\n);\n\nexport interface ConversationHeaderProps\n  extends\n    React.HTMLAttributes<HTMLElement>,\n    VariantProps<typeof headerVariants> {\n  /** The conversation to display */\n  conversation?: Conversation;\n  /** Custom title (overrides conversation name) */\n  title?: string;\n  /** Custom subtitle */\n  subtitle?: string;\n  /** Avatar URL */\n  avatarUrl?: string;\n  /** Participant for direct messages */\n  participant?: MessageParticipant;\n  /** Show online status indicator */\n  showOnlineStatus?: boolean;\n  /** Show back button (mobile) */\n  showBackButton?: boolean;\n  /** Called when back button is clicked */\n  onBack?: () => void;\n  /** Additional actions (menu, call, etc.) */\n  actions?: React.ReactNode;\n  /** Custom left content */\n  leftContent?: React.ReactNode;\n  /** Custom right content */\n  rightContent?: React.ReactNode;\n}\n\n/**\n * Get display title for a conversation.\n */\nfunction getConversationTitle(\n  conversation?: Conversation,\n  participant?: MessageParticipant\n): string {\n  if (conversation?.name) return conversation.name;\n  if (participant?.name) return participant.name;\n  if (conversation?.participants && conversation.participants.length > 0) {\n    const names = conversation.participants\n      .filter((p) => !p.isCurrentUser)\n      .map((p) => p.name);\n    if (names.length <= 2) return names.join(' & ');\n    return `${names[0]} and ${names.length - 1} others`;\n  }\n  return 'Conversation';\n}\n\n/**\n * Get subtitle for a conversation.\n */\nfunction getConversationSubtitle(\n  conversation?: Conversation,\n  participant?: MessageParticipant,\n  showOnlineStatus?: boolean\n): string | undefined {\n  if (participant) {\n    if (showOnlineStatus && participant.isOnline) {\n      return 'Online';\n    }\n    if (participant.lastSeen) {\n      const lastSeen = new Date(participant.lastSeen);\n      return `Last seen ${formatLastSeen(lastSeen)}`;\n    }\n    if (participant.phoneNumber) {\n      return participant.phoneNumber;\n    }\n  }\n  if (conversation?.type === 'group' && conversation.participants) {\n    return `${conversation.participants.length} participants`;\n  }\n  return undefined;\n}\n\n/**\n * Format last seen time.\n */\nfunction formatLastSeen(date: Date): string {\n  const now = new Date();\n  const diffMs = now.getTime() - date.getTime();\n  const diffMins = Math.floor(diffMs / (1000 * 60));\n  const diffHours = Math.floor(diffMs / (1000 * 60 * 60));\n  const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));\n\n  if (diffMins < 1) return 'just now';\n  if (diffMins < 60) return `${diffMins}m ago`;\n  if (diffHours < 24) return `${diffHours}h ago`;\n  if (diffDays < 7) return `${diffDays}d ago`;\n  return date.toLocaleDateString();\n}\n\n/**\n * Header component for a conversation/message thread.\n *\n * @example\n * ```tsx\n * <ConversationHeader\n *   conversation={conversation}\n *   showBackButton\n *   onBack={() => navigate('/conversations')}\n *   actions={<IconButton icon={<MoreIcon />} />}\n * />\n * ```\n */\nconst ConversationHeader = React.forwardRef<\n  HTMLElement,\n  ConversationHeaderProps\n>(\n  (\n    {\n      className,\n      size,\n      conversation,\n      title,\n      subtitle,\n      avatarUrl,\n      participant,\n      showOnlineStatus = true,\n      showBackButton = false,\n      onBack,\n      actions,\n      leftContent,\n      rightContent,\n      ...props\n    },\n    ref\n  ) => {\n    const displayTitle =\n      title || getConversationTitle(conversation, participant);\n    const displaySubtitle =\n      subtitle ||\n      getConversationSubtitle(conversation, participant, showOnlineStatus);\n    const displayAvatar =\n      avatarUrl || conversation?.avatarUrl || participant?.avatarUrl;\n    const isOnline = participant?.isOnline;\n\n    return (\n      <header\n        ref={ref}\n        className={cn(headerVariants({ size }), className)}\n        {...props}\n      >\n        {/* Left content / Back button */}\n        {leftContent ||\n          (showBackButton && onBack && (\n            <button\n              type=\"button\"\n              onClick={onBack}\n              className={cn(\n                '-ml-2 rounded-full p-2',\n                'text-neutral-500 hover:text-neutral-700',\n                'dark:text-neutral-400 dark:hover:text-neutral-200',\n                'hover:bg-neutral-100 dark:hover:bg-neutral-800',\n                'focus:ring-primary-500 focus:ring-2 focus:outline-none',\n                'transition-colors'\n              )}\n              aria-label=\"Go back\"\n            >\n              <svg\n                className=\"h-5 w-5\"\n                fill=\"none\"\n                viewBox=\"0 0 24 24\"\n                stroke=\"currentColor\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M15 19l-7-7 7-7\"\n                />\n              </svg>\n            </button>\n          ))}\n\n        {/* Avatar */}\n        <div className=\"relative shrink-0\">\n          <div\n            className={cn(\n              'flex h-10 w-10 items-center justify-center rounded-full',\n              'bg-primary-800 font-medium text-white'\n            )}\n          >\n            {displayAvatar ? (\n              <img\n                src={displayAvatar}\n                alt={displayTitle}\n                className=\"h-full w-full rounded-full object-cover\"\n              />\n            ) : (\n              displayTitle.charAt(0).toUpperCase()\n            )}\n          </div>\n          {/* Online indicator */}\n          {showOnlineStatus && isOnline && (\n            <span\n              className={cn(\n                'absolute right-0 bottom-0',\n                'h-3 w-3 rounded-full',\n                'bg-green-500 ring-2 ring-white dark:ring-neutral-900'\n              )}\n              aria-label=\"Online\"\n            />\n          )}\n        </div>\n\n        {/* Title and subtitle */}\n        <div className=\"min-w-0 flex-1\">\n          <h2 className=\"truncate font-semibold text-neutral-900 dark:text-neutral-100\">\n            {displayTitle}\n          </h2>\n          {displaySubtitle && (\n            <p\n              className={cn(\n                'truncate text-sm',\n                isOnline\n                  ? 'text-green-600 dark:text-green-400'\n                  : 'text-neutral-500 dark:text-neutral-400'\n              )}\n            >\n              {displaySubtitle}\n            </p>\n          )}\n        </div>\n\n        {/* Right content / Actions */}\n        {rightContent ||\n          (actions && (\n            <div className=\"flex shrink-0 items-center gap-1\">{actions}</div>\n          ))}\n      </header>\n    );\n  }\n);\n\nConversationHeader.displayName = 'ConversationHeader';\n\n// ============================================================================\n// Conversation List Item Component\n// ============================================================================\n\nexport interface ConversationListItemProps extends Omit<\n  React.HTMLAttributes<HTMLButtonElement>,\n  'onSelect'\n> {\n  /** The conversation to display */\n  conversation: Conversation;\n  /** Whether this item is selected */\n  isSelected?: boolean;\n  /** Called when the item is clicked */\n  onSelect?: (conversation: Conversation) => void;\n}\n\n/**\n * A list item for displaying a conversation in a list.\n */\nconst ConversationListItem = React.forwardRef<\n  HTMLButtonElement,\n  ConversationListItemProps\n>(({ className, conversation, isSelected, onSelect, ...props }, ref) => {\n  const participant = conversation.participants.find((p) => !p.isCurrentUser);\n  const title = getConversationTitle(conversation, participant);\n  const avatarUrl = conversation.avatarUrl || participant?.avatarUrl;\n  const lastMessage = conversation.lastMessage;\n  const isUnread = conversation.unreadCount > 0;\n\n  const formatTime = (timestamp: Date | string) => {\n    const date = new Date(timestamp);\n    const now = new Date();\n    const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n    const messageDate = new Date(\n      date.getFullYear(),\n      date.getMonth(),\n      date.getDate()\n    );\n\n    if (messageDate.getTime() === today.getTime()) {\n      return date.toLocaleTimeString(undefined, {\n        hour: 'numeric',\n        minute: '2-digit',\n      });\n    }\n\n    const yesterday = new Date(today);\n    yesterday.setDate(yesterday.getDate() - 1);\n    if (messageDate.getTime() === yesterday.getTime()) {\n      return 'Yesterday';\n    }\n\n    return date.toLocaleDateString(undefined, {\n      month: 'short',\n      day: 'numeric',\n    });\n  };\n\n  return (\n    <button\n      ref={ref}\n      type=\"button\"\n      onClick={() => onSelect?.(conversation)}\n      className={cn(\n        'flex w-full items-center gap-3 px-4 py-3',\n        'text-left transition-colors',\n        isSelected\n          ? 'bg-primary-50 dark:bg-primary-900/20'\n          : 'hover:bg-neutral-50 dark:hover:bg-neutral-800/50',\n        'focus:bg-neutral-50 focus:outline-none dark:focus:bg-neutral-800/50',\n        className\n      )}\n      aria-current={isSelected ? 'true' : undefined}\n      {...props}\n    >\n      {/* Avatar */}\n      <div className=\"relative shrink-0\">\n        <div\n          className={cn(\n            'flex h-12 w-12 items-center justify-center rounded-full',\n            'bg-primary-800 font-medium text-white'\n          )}\n        >\n          {avatarUrl ? (\n            <img\n              src={avatarUrl}\n              alt={title}\n              className=\"h-full w-full rounded-full object-cover\"\n            />\n          ) : (\n            title.charAt(0).toUpperCase()\n          )}\n        </div>\n        {participant?.isOnline && (\n          <span\n            className={cn(\n              'absolute right-0 bottom-0',\n              'h-3 w-3 rounded-full',\n              'bg-green-500 ring-2 ring-white dark:ring-neutral-900'\n            )}\n          />\n        )}\n      </div>\n\n      {/* Content */}\n      <div className=\"min-w-0 flex-1\">\n        <div className=\"flex items-center justify-between gap-2\">\n          <h3\n            className={cn(\n              'truncate text-sm',\n              isUnread\n                ? 'font-semibold text-neutral-900 dark:text-neutral-100'\n                : 'font-medium text-neutral-700 dark:text-neutral-300'\n            )}\n          >\n            {title}\n          </h3>\n          {lastMessage && (\n            <span className=\"shrink-0 text-xs text-neutral-500 dark:text-neutral-400\">\n              {formatTime(lastMessage.timestamp)}\n            </span>\n          )}\n        </div>\n        <div className=\"flex items-center justify-between gap-2\">\n          <p\n            className={cn(\n              'truncate text-sm',\n              isUnread\n                ? 'text-neutral-700 dark:text-neutral-300'\n                : 'text-neutral-500 dark:text-neutral-400'\n            )}\n          >\n            {lastMessage?.content || 'No messages yet'}\n          </p>\n          {isUnread && (\n            <span\n              className={cn(\n                'flex shrink-0 items-center justify-center',\n                'h-5 min-w-[20px] rounded-full px-1.5',\n                'bg-primary-600 text-xs font-medium text-white'\n              )}\n            >\n              {conversation.unreadCount > 99 ? '99+' : conversation.unreadCount}\n            </span>\n          )}\n        </div>\n      </div>\n\n      {/* Pinned/Muted indicators */}\n      <div className=\"flex shrink-0 flex-col items-center gap-1\">\n        {conversation.isPinned && (\n          <svg\n            className=\"text-primary-500 h-4 w-4\"\n            fill=\"currentColor\"\n            viewBox=\"0 0 24 24\"\n          >\n            <path d=\"M16 4v8l2 2v2h-6v6l-1 1-1-1v-6H4v-2l2-2V4c0-1.1.9-2 2-2h6c1.1 0 2 .9 2 2z\" />\n          </svg>\n        )}\n        {conversation.isMuted && (\n          <svg\n            className=\"h-4 w-4 text-neutral-400\"\n            fill=\"none\"\n            viewBox=\"0 0 24 24\"\n            stroke=\"currentColor\"\n          >\n            <path\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth={2}\n              d=\"M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z\"\n            />\n            <path\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth={2}\n              d=\"M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2\"\n            />\n          </svg>\n        )}\n      </div>\n    </button>\n  );\n});\n\nConversationListItem.displayName = 'ConversationListItem';\n\n// ============================================================================\n// Conversation List Skeleton Component\n// ============================================================================\n\nexport interface ConversationListSkeletonProps {\n  count?: number;\n  className?: string;\n}\n\n/**\n * Skeleton loading state for conversation list.\n */\nfunction ConversationListSkeleton({\n  count = 5,\n  className,\n}: ConversationListSkeletonProps) {\n  return (\n    <div\n      className={cn(\n        'divide-y divide-neutral-200 dark:divide-neutral-700',\n        className\n      )}\n    >\n      {Array.from({ length: count }).map((_, i) => (\n        <div\n          key={i}\n          className=\"flex items-center gap-3 px-4 py-3\"\n          aria-hidden=\"true\"\n        >\n          <div className=\"h-12 w-12 animate-pulse rounded-full bg-neutral-200 dark:bg-neutral-700\" />\n          <div className=\"flex-1 space-y-2\">\n            <div className=\"h-4 w-32 animate-pulse rounded bg-neutral-200 dark:bg-neutral-700\" />\n            <div className=\"h-3 w-48 animate-pulse rounded bg-neutral-200 dark:bg-neutral-700\" />\n          </div>\n        </div>\n      ))}\n    </div>\n  );\n}\n\nConversationListSkeleton.displayName = 'ConversationListSkeleton';\n\nexport {\n  ConversationHeader,\n  ConversationListItem,\n  ConversationListSkeleton,\n  headerVariants,\n  getConversationTitle,\n  getConversationSubtitle,\n  formatLastSeen,\n};\n","import * as React from 'react';\nimport { cn } from '../../utils/cn';\nimport type {\n  Message,\n  MessageParticipant,\n  MessageAttachment,\n  TypingState,\n  Conversation,\n  NewMessage,\n  MessagingEventHandlers,\n} from './types';\nimport { MessageList } from './MessageList';\nimport { MessageComposer } from './MessageComposer';\nimport { ConversationHeader } from './ConversationHeader';\nimport { DragDropZone } from './AttachmentPicker';\n\n// ============================================================================\n// Lightbox Modal Component\n// ============================================================================\n\nexport interface LightboxModalProps {\n  /** The attachment to display */\n  attachment: MessageAttachment | null;\n  /** Called when the modal is closed */\n  onClose: () => void;\n}\n\n/**\n * Full-screen lightbox for viewing media attachments.\n */\nfunction LightboxModal({ attachment, onClose }: LightboxModalProps) {\n  // Handle escape key\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (event.key === 'Escape') {\n        onClose();\n      }\n    };\n\n    if (attachment) {\n      document.addEventListener('keydown', handleKeyDown);\n      document.body.style.overflow = 'hidden';\n    }\n\n    return () => {\n      document.removeEventListener('keydown', handleKeyDown);\n      document.body.style.overflow = '';\n    };\n  }, [attachment, onClose]);\n\n  if (!attachment) return null;\n\n  const isImage = attachment.type === 'image';\n  const isVideo = attachment.type === 'video';\n\n  return (\n    <div\n      className={cn('fixed inset-0 z-50', 'flex items-center justify-center')}\n      role=\"dialog\"\n      aria-modal=\"true\"\n      aria-label={`View ${attachment.filename}`}\n    >\n      {/* Backdrop - clickable to close */}\n      <button\n        type=\"button\"\n        className=\"absolute inset-0 cursor-default bg-black/90\"\n        onClick={onClose}\n        aria-label=\"Close lightbox\"\n      />\n\n      {/* Close button */}\n      <button\n        type=\"button\"\n        onClick={onClose}\n        className={cn(\n          'absolute top-4 right-4 z-10',\n          'rounded-full p-2',\n          'bg-white/10 text-white',\n          'hover:bg-white/20',\n          'focus:ring-2 focus:ring-white focus:outline-none',\n          'transition-colors'\n        )}\n        aria-label=\"Close\"\n      >\n        <svg\n          className=\"h-6 w-6\"\n          fill=\"none\"\n          viewBox=\"0 0 24 24\"\n          stroke=\"currentColor\"\n        >\n          <path\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            strokeWidth={2}\n            d=\"M6 18L18 6M6 6l12 12\"\n          />\n        </svg>\n      </button>\n\n      {/* Media content */}\n      <div className=\"relative z-10 max-h-[90vh] max-w-[90vw]\">\n        {isImage && (\n          <img\n            src={attachment.url}\n            alt={attachment.alt || attachment.filename}\n            className=\"max-h-[90vh] max-w-[90vw] object-contain\"\n          />\n        )}\n        {isVideo && (\n          <video\n            src={attachment.url}\n            controls\n            autoPlay\n            className=\"max-h-[90vh] max-w-[90vw]\"\n          >\n            <track kind=\"captions\" />\n          </video>\n        )}\n      </div>\n\n      {/* Filename */}\n      <div className=\"absolute bottom-4 left-1/2 -translate-x-1/2\">\n        <p className=\"rounded-full bg-black/50 px-4 py-2 text-sm text-white\">\n          {attachment.filename}\n        </p>\n      </div>\n    </div>\n  );\n}\n\nLightboxModal.displayName = 'LightboxModal';\n\n// ============================================================================\n// Message Thread Component\n// ============================================================================\n\nexport interface MessageThreadProps {\n  /** The conversation being displayed */\n  conversation?: Conversation;\n  /** Array of messages in the thread */\n  messages: Message[];\n  /** Current user for determining message direction */\n  currentUser: MessageParticipant;\n  /** Typing indicator state */\n  typingState?: TypingState;\n  /** Whether messages are loading */\n  isLoading?: boolean;\n  /** Whether more messages are available */\n  hasMore?: boolean;\n  /** Whether more messages are being loaded */\n  isLoadingMore?: boolean;\n  /** Whether a message is being sent */\n  isSending?: boolean;\n  /** Event handlers */\n  eventHandlers?: MessagingEventHandlers;\n  /** Show header */\n  showHeader?: boolean;\n  /** Show back button in header */\n  showBackButton?: boolean;\n  /** Called when back is clicked */\n  onBack?: () => void;\n  /** Custom header actions */\n  headerActions?: React.ReactNode;\n  /** Composer placeholder */\n  placeholder?: string;\n  /** Maximum message length */\n  maxMessageLength?: number;\n  /** Show character count */\n  showCharacterCount?: boolean;\n  /** Show attachment picker */\n  showAttachmentPicker?: boolean;\n  /** Show camera button */\n  showCameraButton?: boolean;\n  /** Accepted file types */\n  acceptedFileTypes?: string[];\n  /** Maximum file size */\n  maxFileSize?: number;\n  /** Maximum attachments */\n  maxAttachments?: number;\n  /** Show avatars in message list */\n  showAvatars?: boolean;\n  /** Show sender names (group chats) */\n  showSenderNames?: boolean;\n  /** Group messages by date */\n  groupByDate?: boolean;\n  /** Custom empty state */\n  emptyState?: React.ReactNode;\n  /** Custom timestamp formatter */\n  formatTimestamp?: (timestamp: Date | string) => string;\n  /** Called when an error occurs */\n  onError?: (error: string) => void;\n  /** Additional class name */\n  className?: string;\n}\n\n/**\n * A complete message thread component combining header, message list, and composer.\n *\n * @example\n * ```tsx\n * <MessageThread\n *   conversation={conversation}\n *   messages={messages}\n *   currentUser={currentUser}\n *   typingState={typingState}\n *   eventHandlers={{\n *     onSendMessage: handleSend,\n *     onLoadMore: handleLoadMore,\n *     onRetryMessage: handleRetry,\n *   }}\n *   showHeader\n *   showBackButton\n *   onBack={() => navigate('/conversations')}\n * />\n * ```\n */\nconst MessageThread = React.forwardRef<HTMLDivElement, MessageThreadProps>(\n  (\n    {\n      conversation,\n      messages,\n      currentUser,\n      typingState,\n      isLoading = false,\n      hasMore = false,\n      isLoadingMore = false,\n      isSending = false,\n      eventHandlers = {},\n      showHeader = true,\n      showBackButton = false,\n      onBack,\n      headerActions,\n      placeholder = 'Type a message...',\n      maxMessageLength = 1600,\n      showCharacterCount = false,\n      showAttachmentPicker = true,\n      showCameraButton = false,\n      acceptedFileTypes,\n      maxFileSize,\n      maxAttachments,\n      showAvatars = true,\n      showSenderNames = false,\n      groupByDate = true,\n      emptyState,\n      formatTimestamp,\n      onError,\n      className,\n    },\n    ref\n  ) => {\n    const [lightboxAttachment, setLightboxAttachment] =\n      React.useState<MessageAttachment | null>(null);\n    const [replyTo, setReplyTo] = React.useState<{\n      id: string;\n      content: string;\n      senderName: string;\n    } | null>(null);\n\n    // Get participant for direct messages\n    const participant =\n      conversation?.type === 'direct'\n        ? conversation.participants.find((p) => p.id !== currentUser.id)\n        : undefined;\n\n    // Handle attachment click\n    const handleAttachmentClick = (\n      attachment: MessageAttachment,\n      message: Message\n    ) => {\n      if (attachment.type === 'image' || attachment.type === 'video') {\n        setLightboxAttachment(attachment);\n      }\n      eventHandlers.onAttachmentClick?.(attachment, message);\n    };\n\n    // Handle send message\n    const handleSendMessage = async (newMessage: NewMessage) => {\n      const messageWithReply: NewMessage = {\n        ...newMessage,\n        replyToId: replyTo?.id || newMessage.replyToId,\n      };\n      setReplyTo(null);\n      await eventHandlers.onSendMessage?.(messageWithReply);\n    };\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          'flex h-full flex-col',\n          'bg-white dark:bg-neutral-900',\n          className\n        )}\n      >\n        {/* Header */}\n        {showHeader && (\n          <ConversationHeader\n            conversation={conversation}\n            participant={participant}\n            showBackButton={showBackButton}\n            onBack={onBack}\n            actions={headerActions}\n          />\n        )}\n\n        {/* Message list */}\n        <DragDropZone\n          onFilesDropped={() => {\n            // Could trigger composer with attachments\n            onError?.('Drop files on the composer to attach them');\n          }}\n          disabled={!showAttachmentPicker}\n          className=\"flex-1 overflow-hidden\"\n        >\n          <MessageList\n            messages={messages}\n            currentUser={currentUser}\n            isLoading={isLoading}\n            hasMore={hasMore}\n            isLoadingMore={isLoadingMore}\n            typingState={typingState}\n            showAvatars={showAvatars}\n            showSenderNames={showSenderNames}\n            groupByDate={groupByDate}\n            onLoadMore={eventHandlers.onLoadMore}\n            onRetryMessage={eventHandlers.onRetryMessage}\n            onAttachmentClick={handleAttachmentClick}\n            emptyState={emptyState}\n            formatTimestamp={formatTimestamp}\n            className=\"h-full\"\n          />\n        </DragDropZone>\n\n        {/* Composer */}\n        <MessageComposer\n          onSend={handleSendMessage}\n          onTypingStart={eventHandlers.onTypingStart}\n          onTypingStop={eventHandlers.onTypingStop}\n          placeholder={placeholder}\n          maxLength={maxMessageLength}\n          showCharacterCount={showCharacterCount}\n          isSending={isSending}\n          showAttachmentPicker={showAttachmentPicker}\n          showCameraButton={showCameraButton}\n          acceptedFileTypes={acceptedFileTypes}\n          maxFileSize={maxFileSize}\n          maxAttachments={maxAttachments}\n          onError={onError}\n          replyTo={replyTo}\n          onCancelReply={() => setReplyTo(null)}\n        />\n\n        {/* Lightbox */}\n        <LightboxModal\n          attachment={lightboxAttachment}\n          onClose={() => setLightboxAttachment(null)}\n        />\n      </div>\n    );\n  }\n);\n\nMessageThread.displayName = 'MessageThread';\n\n// ============================================================================\n// Split View Container Component\n// ============================================================================\n\nexport interface MessagingSplitViewProps {\n  /** Conversation list content */\n  conversationList: React.ReactNode;\n  /** Message thread content */\n  messageThread: React.ReactNode;\n  /** Whether a conversation is selected */\n  hasSelectedConversation?: boolean;\n  /** Width of the conversation list on desktop */\n  listWidth?: string | number;\n  /** Breakpoint for mobile view */\n  mobileBreakpoint?: 'sm' | 'md' | 'lg';\n  /** Additional class name */\n  className?: string;\n}\n\n/**\n * Split view container for desktop with responsive mobile behavior.\n *\n * @example\n * ```tsx\n * <MessagingSplitView\n *   conversationList={<ConversationList />}\n *   messageThread={<MessageThread />}\n *   hasSelectedConversation={!!selectedConversation}\n * />\n * ```\n */\nfunction MessagingSplitView({\n  conversationList,\n  messageThread,\n  hasSelectedConversation = false,\n  listWidth = 320,\n  mobileBreakpoint = 'md',\n  className,\n}: MessagingSplitViewProps) {\n  const breakpointClasses = {\n    sm: 'sm:flex',\n    md: 'md:flex',\n    lg: 'lg:flex',\n  };\n\n  const hideMobileClasses = {\n    sm: hasSelectedConversation ? 'hidden sm:block' : 'block sm:block',\n    md: hasSelectedConversation ? 'hidden md:block' : 'block md:block',\n    lg: hasSelectedConversation ? 'hidden lg:block' : 'block lg:block',\n  };\n\n  const showMobileClasses = {\n    sm: hasSelectedConversation ? 'block sm:block' : 'hidden sm:block',\n    md: hasSelectedConversation ? 'block md:block' : 'hidden md:block',\n    lg: hasSelectedConversation ? 'block lg:block' : 'hidden lg:block',\n  };\n\n  return (\n    <div\n      className={cn(\n        'h-full w-full',\n        breakpointClasses[mobileBreakpoint],\n        className\n      )}\n    >\n      {/* Conversation list */}\n      <div\n        className={cn(\n          'h-full w-full flex-shrink-0',\n          'border-r border-neutral-200 dark:border-neutral-700',\n          hideMobileClasses[mobileBreakpoint]\n        )}\n        style={{\n          width: typeof listWidth === 'number' ? `${listWidth}px` : listWidth,\n        }}\n      >\n        {conversationList}\n      </div>\n\n      {/* Message thread */}\n      <div\n        className={cn(\n          'h-full min-w-0 flex-1',\n          showMobileClasses[mobileBreakpoint]\n        )}\n      >\n        {messageThread}\n      </div>\n    </div>\n  );\n}\n\nMessagingSplitView.displayName = 'MessagingSplitView';\n\nexport { MessageThread, LightboxModal, MessagingSplitView };\n","/* eslint-disable no-undef */\nimport * as React from 'react';\nimport type {\n  Message,\n  MessageParticipant,\n  MessageStatus,\n  TypingState,\n  NewMessage,\n} from './types';\n\n// ============================================================================\n// useMessages Hook\n// ============================================================================\n\nexport interface UseMessagesOptions {\n  /** Initial messages */\n  initialMessages?: Message[];\n  /** Current user */\n  currentUser: MessageParticipant;\n  /** Called when a message is sent */\n  onSend?: (message: NewMessage) => Promise<Message>;\n  /** Called when a message is retried */\n  onRetry?: (messageId: string) => Promise<void>;\n  /** Called when messages need to be loaded */\n  onLoadMore?: () => Promise<Message[]>;\n}\n\nexport interface UseMessagesReturn {\n  /** Current messages */\n  messages: Message[];\n  /** Add a new message (from external source) */\n  addMessage: (message: Message) => void;\n  /** Update a message */\n  updateMessage: (messageId: string, updates: Partial<Message>) => void;\n  /** Remove a message */\n  removeMessage: (messageId: string) => void;\n  /** Send a new message */\n  sendMessage: (content: NewMessage) => Promise<void>;\n  /** Retry a failed message */\n  retryMessage: (messageId: string) => Promise<void>;\n  /** Load more messages */\n  loadMore: () => Promise<void>;\n  /** Whether sending is in progress */\n  isSending: boolean;\n  /** Whether loading more is in progress */\n  isLoadingMore: boolean;\n  /** Mark a message as read */\n  markAsRead: (messageId: string) => void;\n  /** Update message status */\n  updateStatus: (messageId: string, status: MessageStatus) => void;\n}\n\n/**\n * Hook for managing message state with optimistic updates.\n *\n * @example\n * ```tsx\n * const {\n *   messages,\n *   sendMessage,\n *   isSending,\n * } = useMessages({\n *   currentUser,\n *   onSend: async (msg) => await api.sendMessage(msg),\n * });\n * ```\n */\nexport function useMessages(options: UseMessagesOptions): UseMessagesReturn {\n  const {\n    initialMessages = [],\n    currentUser,\n    onSend,\n    onRetry,\n    onLoadMore,\n  } = options;\n\n  const [messages, setMessages] = React.useState<Message[]>(initialMessages);\n  const [isSending, setIsSending] = React.useState(false);\n  const [isLoadingMore, setIsLoadingMore] = React.useState(false);\n\n  // Update messages when initialMessages changes\n  React.useEffect(() => {\n    setMessages(initialMessages);\n  }, [initialMessages]);\n\n  const addMessage = React.useCallback((message: Message) => {\n    setMessages((prev) => {\n      // Avoid duplicates\n      if (prev.some((m) => m.id === message.id)) {\n        return prev;\n      }\n      return [...prev, message];\n    });\n  }, []);\n\n  const updateMessage = React.useCallback(\n    (messageId: string, updates: Partial<Message>) => {\n      setMessages((prev) =>\n        prev.map((m) => (m.id === messageId ? { ...m, ...updates } : m))\n      );\n    },\n    []\n  );\n\n  const removeMessage = React.useCallback((messageId: string) => {\n    setMessages((prev) => prev.filter((m) => m.id !== messageId));\n  }, []);\n\n  const updateStatus = React.useCallback(\n    (messageId: string, status: MessageStatus) => {\n      updateMessage(messageId, { status });\n    },\n    [updateMessage]\n  );\n\n  const markAsRead = React.useCallback(\n    (messageId: string) => {\n      updateStatus(messageId, 'read');\n    },\n    [updateStatus]\n  );\n\n  const sendMessage = React.useCallback(\n    async (newMessage: NewMessage) => {\n      // Create optimistic message\n      const optimisticId = `optimistic-${Date.now()}`;\n      const optimisticMessage: Message = {\n        id: optimisticId,\n        type: 'text',\n        content: newMessage.content,\n        sender: currentUser,\n        timestamp: new Date(),\n        status: 'sending',\n        attachments: [], // Would handle attachment uploads here\n      };\n\n      // Add optimistic message\n      addMessage(optimisticMessage);\n      setIsSending(true);\n\n      try {\n        if (onSend) {\n          const sentMessage = await onSend(newMessage);\n          // Replace optimistic message with real one\n          setMessages((prev) =>\n            prev.map((m) => (m.id === optimisticId ? sentMessage : m))\n          );\n        } else {\n          // No send handler, just mark as sent\n          updateStatus(optimisticId, 'sent');\n        }\n      } catch {\n        // Mark as failed\n        updateStatus(optimisticId, 'failed');\n      } finally {\n        setIsSending(false);\n      }\n    },\n    [currentUser, onSend, addMessage, updateStatus]\n  );\n\n  const retryMessage = React.useCallback(\n    async (messageId: string) => {\n      updateStatus(messageId, 'sending');\n\n      try {\n        if (onRetry) {\n          await onRetry(messageId);\n          updateStatus(messageId, 'sent');\n        }\n      } catch {\n        updateStatus(messageId, 'failed');\n      }\n    },\n    [onRetry, updateStatus]\n  );\n\n  const loadMore = React.useCallback(async () => {\n    if (isLoadingMore || !onLoadMore) return;\n\n    setIsLoadingMore(true);\n    try {\n      const olderMessages = await onLoadMore();\n      setMessages((prev) => [...olderMessages, ...prev]);\n    } finally {\n      setIsLoadingMore(false);\n    }\n  }, [isLoadingMore, onLoadMore]);\n\n  return {\n    messages,\n    addMessage,\n    updateMessage,\n    removeMessage,\n    sendMessage,\n    retryMessage,\n    loadMore,\n    isSending,\n    isLoadingMore,\n    markAsRead,\n    updateStatus,\n  };\n}\n\n// ============================================================================\n// useTypingIndicator Hook\n// ============================================================================\n\nexport interface UseTypingIndicatorOptions {\n  /** Current typing participants (from server) */\n  typingParticipants?: MessageParticipant[];\n  /** Debounce time for typing stop (ms) */\n  debounceTime?: number;\n  /** Called when local user starts typing */\n  onTypingStart?: () => void;\n  /** Called when local user stops typing */\n  onTypingStop?: () => void;\n}\n\nexport interface UseTypingIndicatorReturn {\n  /** Current typing state */\n  typingState: TypingState;\n  /** Signal that local user is typing */\n  startTyping: () => void;\n  /** Signal that local user stopped typing */\n  stopTyping: () => void;\n  /** Update remote typing participants */\n  setTypingParticipants: (participants: MessageParticipant[]) => void;\n}\n\n/**\n * Hook for managing typing indicator state.\n *\n * @example\n * ```tsx\n * const { typingState, startTyping, stopTyping } = useTypingIndicator({\n *   onTypingStart: () => socket.emit('typing', true),\n *   onTypingStop: () => socket.emit('typing', false),\n * });\n * ```\n */\nexport function useTypingIndicator(\n  options: UseTypingIndicatorOptions = {}\n): UseTypingIndicatorReturn {\n  const {\n    typingParticipants: initialParticipants = [],\n    debounceTime = 2000,\n    onTypingStart,\n    onTypingStop,\n  } = options;\n\n  const [participants, setParticipants] =\n    React.useState<MessageParticipant[]>(initialParticipants);\n  const [isLocalTyping, setIsLocalTyping] = React.useState(false);\n  const typingTimeoutRef = React.useRef<NodeJS.Timeout | null>(null);\n\n  // Update from props\n  React.useEffect(() => {\n    setParticipants(initialParticipants);\n  }, [initialParticipants]);\n\n  const startTyping = React.useCallback(() => {\n    if (!isLocalTyping) {\n      setIsLocalTyping(true);\n      onTypingStart?.();\n    }\n\n    // Reset timeout\n    if (typingTimeoutRef.current) {\n      clearTimeout(typingTimeoutRef.current);\n    }\n\n    typingTimeoutRef.current = setTimeout(() => {\n      setIsLocalTyping(false);\n      onTypingStop?.();\n    }, debounceTime);\n  }, [isLocalTyping, debounceTime, onTypingStart, onTypingStop]);\n\n  const stopTyping = React.useCallback(() => {\n    if (typingTimeoutRef.current) {\n      clearTimeout(typingTimeoutRef.current);\n    }\n    setIsLocalTyping(false);\n    onTypingStop?.();\n  }, [onTypingStop]);\n\n  // Cleanup on unmount\n  React.useEffect(() => {\n    return () => {\n      if (typingTimeoutRef.current) {\n        clearTimeout(typingTimeoutRef.current);\n      }\n    };\n  }, []);\n\n  const typingState: TypingState = React.useMemo(\n    () => ({\n      participants,\n      lastUpdated: new Date(),\n    }),\n    [participants]\n  );\n\n  return {\n    typingState,\n    startTyping,\n    stopTyping,\n    setTypingParticipants: setParticipants,\n  };\n}\n\n// ============================================================================\n// useMessageScroll Hook\n// ============================================================================\n\nexport interface UseMessageScrollOptions {\n  /** Messages to watch for changes */\n  messages: Message[];\n  /** Current user ID */\n  currentUserId: string;\n  /** Threshold from bottom to consider \"at bottom\" (px) */\n  threshold?: number;\n}\n\nexport interface UseMessageScrollReturn {\n  /** Ref to attach to scroll container */\n  scrollContainerRef: React.RefObject<HTMLDivElement | null>;\n  /** Ref to attach to bottom anchor element */\n  bottomRef: React.RefObject<HTMLDivElement | null>;\n  /** Whether user has scrolled up from bottom */\n  isScrolledUp: boolean;\n  /** Scroll to bottom */\n  scrollToBottom: (smooth?: boolean) => void;\n}\n\n/**\n * Hook for managing message list scroll behavior.\n *\n * @example\n * ```tsx\n * const { scrollContainerRef, bottomRef, isScrolledUp, scrollToBottom } =\n *   useMessageScroll({ messages, currentUserId: user.id });\n * ```\n */\nexport function useMessageScroll(\n  options: UseMessageScrollOptions\n): UseMessageScrollReturn {\n  const { messages, currentUserId, threshold = 100 } = options;\n\n  const scrollContainerRef = React.useRef<HTMLDivElement>(null);\n  const bottomRef = React.useRef<HTMLDivElement>(null);\n  const [isScrolledUp, setIsScrolledUp] = React.useState(false);\n  const prevMessageCountRef = React.useRef(messages.length);\n\n  // Handle scroll events\n  React.useEffect(() => {\n    const container = scrollContainerRef.current;\n    if (!container) return;\n\n    const handleScroll = () => {\n      const { scrollTop, scrollHeight, clientHeight } = container;\n      const isAtBottom = scrollHeight - scrollTop - clientHeight < threshold;\n      setIsScrolledUp(!isAtBottom);\n    };\n\n    container.addEventListener('scroll', handleScroll);\n    return () => container.removeEventListener('scroll', handleScroll);\n  }, [threshold]);\n\n  const scrollToBottom = React.useCallback((smooth = true) => {\n    bottomRef.current?.scrollIntoView({\n      behavior: smooth ? 'smooth' : 'auto',\n    });\n  }, []);\n\n  // Auto-scroll on new messages\n  React.useEffect(() => {\n    const messageCountChanged = messages.length !== prevMessageCountRef.current;\n    prevMessageCountRef.current = messages.length;\n\n    if (!messageCountChanged) return;\n\n    const lastMessage = messages[messages.length - 1];\n    const isOutgoing = lastMessage?.sender.id === currentUserId;\n\n    // Always scroll on outgoing, only scroll on incoming if at bottom\n    if (isOutgoing || !isScrolledUp) {\n      scrollToBottom(true);\n    }\n  }, [messages, currentUserId, isScrolledUp, scrollToBottom]);\n\n  return {\n    scrollContainerRef,\n    bottomRef,\n    isScrolledUp,\n    scrollToBottom,\n  };\n}\n\n// ============================================================================\n// useReadReceipts Hook\n// ============================================================================\n\nexport interface UseReadReceiptsOptions {\n  /** Messages to track */\n  messages: Message[];\n  /** Current user ID */\n  currentUserId: string;\n  /** Called when a message should be marked as read */\n  onMarkRead?: (messageId: string) => void;\n  /** IntersectionObserver threshold */\n  threshold?: number;\n}\n\n/**\n * Hook for automatically marking messages as read when visible.\n *\n * @example\n * ```tsx\n * const { observeMessage } = useReadReceipts({\n *   messages,\n *   currentUserId: user.id,\n *   onMarkRead: (id) => socket.emit('read', id),\n * });\n * ```\n */\nexport function useReadReceipts(options: UseReadReceiptsOptions) {\n  const { currentUserId, onMarkRead, threshold = 0.5 } = options;\n\n  const observerRef = React.useRef<IntersectionObserver | null>(null);\n  const observedMessagesRef = React.useRef<Set<string>>(new Set());\n\n  React.useEffect(() => {\n    observerRef.current = new IntersectionObserver(\n      (entries) => {\n        entries.forEach((entry) => {\n          if (entry.isIntersecting) {\n            const messageId = entry.target.getAttribute('data-message-id');\n            if (messageId && !observedMessagesRef.current.has(messageId)) {\n              observedMessagesRef.current.add(messageId);\n              onMarkRead?.(messageId);\n            }\n          }\n        });\n      },\n      { threshold }\n    );\n\n    return () => {\n      observerRef.current?.disconnect();\n    };\n  }, [onMarkRead, threshold]);\n\n  const observeMessage = React.useCallback(\n    (element: HTMLElement | null, message: Message) => {\n      if (!element || !observerRef.current) return;\n\n      // Only observe unread incoming messages\n      if (\n        message.sender.id !== currentUserId &&\n        message.status !== 'read' &&\n        !observedMessagesRef.current.has(message.id)\n      ) {\n        element.setAttribute('data-message-id', message.id);\n        observerRef.current.observe(element);\n      }\n    },\n    [currentUserId]\n  );\n\n  return { observeMessage };\n}\n","import * as React from 'react';\nimport { cva, type VariantProps } from 'class-variance-authority';\nimport { cn } from '../../utils/cn';\n\n// ============================================================================\n// Types\n// ============================================================================\n\nexport type RecordButtonState = 'idle' | 'recording' | 'processing';\n\n/** Transcription state for integration with transcription services */\nexport type TranscriptionState =\n  | 'idle'\n  | 'recording'\n  | 'transcribing'\n  | 'streaming'\n  | 'complete'\n  | 'error';\n\nexport interface TranscriptionResult {\n  /** The transcribed text */\n  text: string;\n  /** Whether this is a partial (streaming) or final result */\n  isFinal: boolean;\n  /** Confidence score (0-1) if available */\n  confidence?: number;\n}\n\nexport interface RecordButtonProps extends VariantProps<\n  typeof recordButtonVariants\n> {\n  /** Callback when recording is complete with the audio blob */\n  onRecordingComplete?: (blob: Blob, duration: number) => void;\n  /** Callback when recording starts */\n  onRecordingStart?: () => void;\n  /** Callback when an error occurs */\n  onError?: (error: Error) => void;\n  /** Maximum recording duration in seconds (0 for unlimited) */\n  maxDuration?: number;\n  /** Audio MIME type */\n  mimeType?: string;\n  /** Whether the button is disabled */\n  disabled?: boolean;\n  /** Additional class name */\n  className?: string;\n  /** Accessible label */\n  'aria-label'?: string;\n  /** Show recording duration while recording */\n  showDuration?: boolean;\n  /** Custom idle icon */\n  idleIcon?: React.ReactNode;\n  /** Custom recording icon */\n  recordingIcon?: React.ReactNode;\n  /** Current transcription state (for external control) */\n  transcriptionState?: TranscriptionState;\n  /** Show transcription state indicator */\n  showTranscriptionState?: boolean;\n}\n\n// ============================================================================\n// Variants\n// ============================================================================\n\nconst recordButtonVariants = cva(\n  [\n    'relative inline-flex items-center justify-center',\n    'rounded-full transition-all duration-200',\n    'focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2',\n    'disabled:pointer-events-none disabled:opacity-50',\n  ],\n  {\n    variants: {\n      variant: {\n        default: [\n          'text-neutral-500 hover:text-neutral-700 hover:bg-neutral-100',\n          'dark:text-neutral-400 dark:hover:text-neutral-200 dark:hover:bg-neutral-800',\n        ],\n        filled: [\n          'bg-neutral-100 text-neutral-600 hover:bg-neutral-200',\n          'dark:bg-neutral-800 dark:text-neutral-300 dark:hover:bg-neutral-700',\n        ],\n        primary: [\n          'bg-primary-600 text-white hover:bg-primary-700',\n          'dark:bg-primary-500 dark:hover:bg-primary-600',\n        ],\n      },\n      size: {\n        sm: 'h-7 w-7',\n        md: 'h-9 w-9',\n        lg: 'h-11 w-11',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n      size: 'md',\n    },\n  }\n);\n\nconst recordingIndicatorVariants = cva(\n  [\n    'absolute -top-1 -right-1',\n    'flex items-center justify-center',\n    'rounded-full bg-red-500 text-white',\n    'animate-pulse',\n  ],\n  {\n    variants: {\n      size: {\n        sm: 'h-3 w-3',\n        md: 'h-4 w-4',\n        lg: 'h-5 w-5',\n      },\n    },\n    defaultVariants: {\n      size: 'md',\n    },\n  }\n);\n\n// ============================================================================\n// Helper Functions\n// ============================================================================\n\nfunction formatDuration(seconds: number): string {\n  const mins = Math.floor(seconds / 60);\n  const secs = Math.floor(seconds % 60);\n  return `${mins}:${secs.toString().padStart(2, '0')}`;\n}\n\n// ============================================================================\n// Icons\n// ============================================================================\n\nfunction MicrophoneIcon({ className }: { className?: string }) {\n  return (\n    <svg\n      className={className}\n      fill=\"none\"\n      viewBox=\"0 0 24 24\"\n      strokeWidth={2}\n      stroke=\"currentColor\"\n      aria-hidden=\"true\"\n    >\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        d=\"M12 18.75a6 6 0 006-6v-1.5m-6 7.5a6 6 0 01-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 01-3-3V4.5a3 3 0 116 0v8.25a3 3 0 01-3 3z\"\n      />\n    </svg>\n  );\n}\n\nfunction StopIcon({ className }: { className?: string }) {\n  return (\n    <svg\n      className={className}\n      fill=\"currentColor\"\n      viewBox=\"0 0 24 24\"\n      aria-hidden=\"true\"\n    >\n      <rect x=\"6\" y=\"6\" width=\"12\" height=\"12\" rx=\"2\" />\n    </svg>\n  );\n}\n\nfunction SpinnerIcon({ className }: { className?: string }) {\n  return (\n    <svg\n      className={cn('animate-spin', className)}\n      fill=\"none\"\n      viewBox=\"0 0 24 24\"\n      aria-hidden=\"true\"\n    >\n      <circle\n        className=\"opacity-25\"\n        cx=\"12\"\n        cy=\"12\"\n        r=\"10\"\n        stroke=\"currentColor\"\n        strokeWidth=\"4\"\n      />\n      <path\n        className=\"opacity-75\"\n        fill=\"currentColor\"\n        d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n      />\n    </svg>\n  );\n}\n\n// ============================================================================\n// Main Component\n// ============================================================================\n\n/**\n * A simple microphone recording button that can be placed anywhere.\n * Perfect for adding voice input to text fields, chat inputs, or forms.\n *\n * @example\n * ```tsx\n * // Basic usage\n * <RecordButton\n *   onRecordingComplete={(blob, duration) => {\n *     console.log('Recorded:', blob, duration);\n *   }}\n * />\n *\n * // In an input field\n * <div className=\"relative\">\n *   <Input className=\"pr-12\" />\n *   <div className=\"absolute right-2 top-1/2 -translate-y-1/2\">\n *     <RecordButton size=\"sm\" onRecordingComplete={handleRecording} />\n *   </div>\n * </div>\n *\n * // With max duration\n * <RecordButton maxDuration={30} showDuration />\n * ```\n */\nfunction RecordButton({\n  onRecordingComplete,\n  onRecordingStart,\n  onError,\n  maxDuration = 0,\n  mimeType = 'audio/webm',\n  disabled = false,\n  variant,\n  size,\n  className,\n  'aria-label': ariaLabel,\n  showDuration = false,\n  idleIcon,\n  recordingIcon,\n  transcriptionState,\n  showTranscriptionState = false,\n}: RecordButtonProps) {\n  const [state, setState] = React.useState<RecordButtonState>('idle');\n  const [duration, setDuration] = React.useState(0);\n\n  const mediaRecorderRef = React.useRef<MediaRecorder | null>(null);\n  const streamRef = React.useRef<MediaStream | null>(null);\n  const chunksRef = React.useRef<Blob[]>([]);\n  const timerRef = React.useRef<number | undefined>(undefined);\n  const startTimeRef = React.useRef<number>(0);\n\n  const isRecording = state === 'recording';\n  const isProcessing = state === 'processing';\n  const isTranscribing =\n    transcriptionState === 'transcribing' || transcriptionState === 'streaming';\n\n  // Cleanup on unmount\n  React.useEffect(() => {\n    return () => {\n      if (timerRef.current) {\n        clearInterval(timerRef.current);\n      }\n      if (streamRef.current) {\n        streamRef.current.getTracks().forEach((track) => track.stop());\n      }\n    };\n  }, []);\n\n  const startRecording = React.useCallback(async () => {\n    if (disabled || isRecording || isProcessing) return;\n\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n      streamRef.current = stream;\n\n      const options = { mimeType };\n      if (!MediaRecorder.isTypeSupported(mimeType)) {\n        mediaRecorderRef.current = new MediaRecorder(stream);\n      } else {\n        mediaRecorderRef.current = new MediaRecorder(stream, options);\n      }\n\n      chunksRef.current = [];\n\n      mediaRecorderRef.current.ondataavailable = (e) => {\n        if (e.data.size > 0) {\n          chunksRef.current.push(e.data);\n        }\n      };\n\n      mediaRecorderRef.current.onstop = () => {\n        setState('processing');\n\n        const blob = new Blob(chunksRef.current, { type: mimeType });\n        const finalDuration = duration;\n\n        // Small delay to show processing state\n        setTimeout(() => {\n          onRecordingComplete?.(blob, finalDuration);\n          setState('idle');\n          setDuration(0);\n        }, 200);\n      };\n\n      mediaRecorderRef.current.start(100);\n      startTimeRef.current = Date.now();\n      setState('recording');\n      onRecordingStart?.();\n\n      timerRef.current = window.setInterval(() => {\n        const elapsed = (Date.now() - startTimeRef.current) / 1000;\n        setDuration(elapsed);\n\n        if (maxDuration > 0 && elapsed >= maxDuration) {\n          stopRecording();\n        }\n      }, 100);\n    } catch (error) {\n      onError?.(error as Error);\n      setState('idle');\n    }\n  }, [\n    disabled,\n    isRecording,\n    isProcessing,\n    mimeType,\n    maxDuration,\n    duration,\n    onRecordingComplete,\n    onRecordingStart,\n    onError,\n  ]);\n\n  const stopRecording = React.useCallback(() => {\n    if (timerRef.current) {\n      clearInterval(timerRef.current);\n    }\n\n    if (\n      mediaRecorderRef.current &&\n      mediaRecorderRef.current.state !== 'inactive'\n    ) {\n      mediaRecorderRef.current.stop();\n    }\n\n    if (streamRef.current) {\n      streamRef.current.getTracks().forEach((track) => track.stop());\n    }\n  }, []);\n\n  const handleClick = React.useCallback(() => {\n    if (isRecording) {\n      stopRecording();\n    } else {\n      startRecording();\n    }\n  }, [isRecording, startRecording, stopRecording]);\n\n  const iconSize =\n    size === 'sm' ? 'h-4 w-4' : size === 'lg' ? 'h-6 w-6' : 'h-5 w-5';\n\n  const getIcon = () => {\n    if (isProcessing || isTranscribing) {\n      return <SpinnerIcon className={iconSize} />;\n    }\n    if (isRecording) {\n      return recordingIcon || <StopIcon className={iconSize} />;\n    }\n    return idleIcon || <MicrophoneIcon className={iconSize} />;\n  };\n\n  const getAriaLabel = () => {\n    if (ariaLabel) return ariaLabel;\n    if (isTranscribing) return 'Transcribing audio';\n    if (isProcessing) return 'Processing recording';\n    if (isRecording) return 'Stop recording';\n    return 'Start recording';\n  };\n\n  const getTranscriptionLabel = () => {\n    if (transcriptionState === 'streaming') return 'Listening...';\n    if (transcriptionState === 'transcribing') return 'Transcribing...';\n    return null;\n  };\n\n  return (\n    <div className=\"relative inline-flex items-center gap-2\">\n      <button\n        type=\"button\"\n        onClick={handleClick}\n        disabled={disabled || isProcessing || isTranscribing}\n        className={cn(\n          recordButtonVariants({ variant, size }),\n          isRecording && 'text-red-600 dark:text-red-400',\n          isTranscribing && 'text-primary-600 dark:text-primary-400',\n          className\n        )}\n        aria-label={getAriaLabel()}\n        aria-pressed={isRecording}\n      >\n        {getIcon()}\n        {isRecording && !isTranscribing && (\n          <span\n            className={cn(recordingIndicatorVariants({ size }))}\n            aria-hidden=\"true\"\n          />\n        )}\n      </button>\n      {showDuration && isRecording && (\n        <span className=\"font-mono text-xs text-red-600 tabular-nums dark:text-red-400\">\n          {formatDuration(duration)}\n        </span>\n      )}\n      {showTranscriptionState && getTranscriptionLabel() && (\n        <span className=\"text-primary-600 dark:text-primary-400 text-xs font-medium\">\n          {getTranscriptionLabel()}\n        </span>\n      )}\n    </div>\n  );\n}\n\nRecordButton.displayName = 'RecordButton';\n\n// ============================================================================\n// Exports\n// ============================================================================\n\nexport {\n  RecordButton,\n  recordButtonVariants,\n  recordingIndicatorVariants,\n  formatDuration,\n};\n","import React, {\n  createContext,\n  useContext,\n  useCallback,\n  useState,\n  useMemo,\n  useEffect,\n  type ReactNode,\n} from 'react';\nimport { useMediaQuery } from '../../hooks/useMediaQuery';\n\n// =============================================================================\n// Types\n// =============================================================================\n\nexport interface SidebarContextValue {\n  /** Whether the sidebar is collapsed (desktop) */\n  isCollapsed: boolean;\n  /** Toggle collapsed state */\n  toggleCollapsed: () => void;\n  /** Set collapsed state */\n  setCollapsed: (collapsed: boolean) => void;\n  /** Whether the mobile sidebar is open */\n  isMobileOpen: boolean;\n  /** Open mobile sidebar */\n  openMobile: () => void;\n  /** Close mobile sidebar */\n  closeMobile: () => void;\n  /** Toggle mobile sidebar */\n  toggleMobile: () => void;\n  /** Whether we're on a mobile/tablet viewport */\n  isMobileViewport: boolean;\n  /** Currently expanded group (for accordion behavior) */\n  expandedGroup: string | null;\n  /** Set the expanded group */\n  setExpandedGroup: (group: string | null) => void;\n  /** Toggle a group's expanded state */\n  toggleGroup: (group: string) => void;\n}\n\n// =============================================================================\n// Context\n// =============================================================================\n\nconst SidebarContext = createContext<SidebarContextValue | null>(null);\n\n// =============================================================================\n// Provider\n// =============================================================================\n\nexport interface SidebarProviderProps {\n  children: ReactNode;\n  /** Default collapsed state (default: false) */\n  defaultCollapsed?: boolean;\n  /** Storage key for persisting collapsed state (default: 'sidebar-collapsed') */\n  storageKey?: string;\n  /** Whether to persist collapsed state to localStorage (default: true) */\n  persistCollapsed?: boolean;\n  /** Default expanded group */\n  defaultExpandedGroup?: string | null;\n  /** Breakpoint for mobile detection (default: 1024px) */\n  mobileBreakpoint?: string;\n}\n\nexport function SidebarProvider({\n  children,\n  defaultCollapsed = false,\n  storageKey = 'sidebar-collapsed',\n  persistCollapsed = true,\n  defaultExpandedGroup = null,\n  mobileBreakpoint = '(max-width: 1023px)',\n}: SidebarProviderProps): React.JSX.Element {\n  // Check if mobile viewport\n  const isMobileViewport = useMediaQuery(mobileBreakpoint);\n\n  // Initialize collapsed state from localStorage or default\n  const [isCollapsed, setIsCollapsed] = useState(() => {\n    if (typeof window !== 'undefined' && persistCollapsed) {\n      const stored = localStorage.getItem(storageKey);\n      if (stored !== null) {\n        return stored === 'true';\n      }\n    }\n    return defaultCollapsed;\n  });\n\n  const [isMobileOpen, setIsMobileOpen] = useState(false);\n  const [expandedGroup, setExpandedGroup] = useState<string | null>(\n    defaultExpandedGroup\n  );\n\n  // Persist collapsed state\n  useEffect(() => {\n    if (persistCollapsed && typeof window !== 'undefined') {\n      localStorage.setItem(storageKey, String(isCollapsed));\n    }\n  }, [isCollapsed, persistCollapsed, storageKey]);\n\n  // Close mobile sidebar when resizing to desktop\n  useEffect(() => {\n    if (!isMobileViewport && isMobileOpen) {\n      setIsMobileOpen(false);\n    }\n  }, [isMobileViewport, isMobileOpen]);\n\n  const toggleCollapsed = useCallback(() => {\n    setIsCollapsed((prev) => !prev);\n  }, []);\n\n  const setCollapsed = useCallback((collapsed: boolean) => {\n    setIsCollapsed(collapsed);\n  }, []);\n\n  const openMobile = useCallback(() => {\n    setIsMobileOpen(true);\n  }, []);\n\n  const closeMobile = useCallback(() => {\n    setIsMobileOpen(false);\n  }, []);\n\n  const toggleMobile = useCallback(() => {\n    setIsMobileOpen((prev) => !prev);\n  }, []);\n\n  const toggleGroup = useCallback((group: string) => {\n    setExpandedGroup((prev) => (prev === group ? null : group));\n  }, []);\n\n  const contextValue = useMemo<SidebarContextValue>(\n    () => ({\n      isCollapsed,\n      toggleCollapsed,\n      setCollapsed,\n      isMobileOpen,\n      openMobile,\n      closeMobile,\n      toggleMobile,\n      isMobileViewport,\n      expandedGroup,\n      setExpandedGroup,\n      toggleGroup,\n    }),\n    [\n      isCollapsed,\n      toggleCollapsed,\n      setCollapsed,\n      isMobileOpen,\n      openMobile,\n      closeMobile,\n      toggleMobile,\n      isMobileViewport,\n      expandedGroup,\n      toggleGroup,\n    ]\n  );\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      {children}\n    </SidebarContext.Provider>\n  );\n}\n\n// =============================================================================\n// Hook\n// =============================================================================\n\n/**\n * Hook to access the sidebar context.\n * Must be used within a SidebarProvider.\n *\n * @example\n * ```tsx\n * function MenuButton() {\n *   const { isMobileViewport, openMobile, toggleCollapsed } = useSidebar();\n *\n *   return (\n *     <button onClick={isMobileViewport ? openMobile : toggleCollapsed}>\n *       Menu\n *     </button>\n *   );\n * }\n * ```\n */\nexport function useSidebar(): SidebarContextValue {\n  const context = useContext(SidebarContext);\n  if (!context) {\n    throw new Error('useSidebar must be used within a SidebarProvider');\n  }\n  return context;\n}\n","import React, {\n  type ReactNode,\n  useRef,\n  useCallback,\n  useState,\n  useEffect,\n} from 'react';\nimport { cn } from '../../utils/cn';\nimport { useSidebar } from './SidebarProvider';\n\n// =============================================================================\n// Icons\n// =============================================================================\n\nconst ChevronLeftIcon = () => (\n  <svg\n    className=\"h-4 w-4\"\n    fill=\"none\"\n    viewBox=\"0 0 24 24\"\n    stroke=\"currentColor\"\n    strokeWidth={2}\n  >\n    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15 19l-7-7 7-7\" />\n  </svg>\n);\n\nconst ChevronRightIcon = () => (\n  <svg\n    className=\"h-4 w-4\"\n    fill=\"none\"\n    viewBox=\"0 0 24 24\"\n    stroke=\"currentColor\"\n    strokeWidth={2}\n  >\n    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9 5l7 7-7 7\" />\n  </svg>\n);\n\nconst ChevronDownIcon = () => (\n  <svg\n    className=\"h-3 w-3\"\n    fill=\"none\"\n    viewBox=\"0 0 24 24\"\n    stroke=\"currentColor\"\n    strokeWidth={2}\n  >\n    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M19 9l-7 7-7-7\" />\n  </svg>\n);\n\nconst XIcon = () => (\n  <svg\n    className=\"h-5 w-5\"\n    fill=\"none\"\n    viewBox=\"0 0 24 24\"\n    stroke=\"currentColor\"\n    strokeWidth={2}\n  >\n    <path\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      d=\"M6 18L18 6M6 6l12 12\"\n    />\n  </svg>\n);\n\nconst MenuIcon = () => (\n  <svg\n    className=\"h-5 w-5\"\n    fill=\"none\"\n    viewBox=\"0 0 24 24\"\n    stroke=\"currentColor\"\n    strokeWidth={2}\n  >\n    <path\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      d=\"M4 6h16M4 12h16M4 18h16\"\n    />\n  </svg>\n);\n\nconst SearchIcon = () => (\n  <svg\n    className=\"h-4 w-4\"\n    fill=\"none\"\n    viewBox=\"0 0 24 24\"\n    stroke=\"currentColor\"\n    strokeWidth={2}\n  >\n    <path\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"\n    />\n  </svg>\n);\n\n// =============================================================================\n// Sidebar Component\n// =============================================================================\n\nexport interface SidebarProps {\n  children: ReactNode;\n  /** Additional CSS classes */\n  className?: string;\n  /** Width when expanded (default: '280px') */\n  expandedWidth?: string;\n  /** Width when collapsed (default: '80px') */\n  collapsedWidth?: string;\n  /** Custom styles object */\n  style?: React.CSSProperties;\n  /** Test ID for testing */\n  'data-testid'?: string;\n}\n\nexport function Sidebar({\n  children,\n  className,\n  expandedWidth = '280px',\n  collapsedWidth = '80px',\n  style,\n  'data-testid': testId = 'sidebar',\n}: SidebarProps): React.JSX.Element {\n  const { isCollapsed, isMobileOpen, closeMobile, isMobileViewport } =\n    useSidebar();\n\n  // Determine effective width\n  const width = isMobileViewport\n    ? expandedWidth\n    : isCollapsed\n      ? collapsedWidth\n      : expandedWidth;\n\n  return (\n    <>\n      {/* Mobile backdrop */}\n      {isMobileViewport && isMobileOpen && (\n        <div\n          className=\"fixed inset-0 z-40 bg-black/50 lg:hidden\"\n          onClick={closeMobile}\n          aria-hidden=\"true\"\n        />\n      )}\n\n      {/* Sidebar */}\n      <nav\n        data-testid={testId}\n        className={cn(\n          'flex h-screen flex-col',\n          'border-r border-neutral-200 bg-white dark:border-neutral-700 dark:bg-neutral-900',\n          'transition-all duration-300 ease-in-out',\n          // Mobile positioning\n          isMobileViewport && 'fixed top-0 left-0 z-50',\n          isMobileViewport &&\n            (isMobileOpen ? 'translate-x-0' : '-translate-x-full'),\n          // Desktop positioning\n          !isMobileViewport && 'relative',\n          className\n        )}\n        style={{\n          width,\n          minWidth: width,\n          ...style,\n        }}\n        aria-label=\"Main navigation\"\n      >\n        {children}\n      </nav>\n    </>\n  );\n}\n\n// =============================================================================\n// SidebarHeader Component\n// =============================================================================\n\nexport interface SidebarHeaderProps {\n  children: ReactNode;\n  /** Additional CSS classes */\n  className?: string;\n  /** Whether to show mobile close button (default: true) */\n  showMobileClose?: boolean;\n}\n\nexport function SidebarHeader({\n  children,\n  className,\n  showMobileClose = true,\n}: SidebarHeaderProps): React.JSX.Element {\n  const { closeMobile, isMobileViewport, isCollapsed } = useSidebar();\n  const showCollapsed = !isMobileViewport && isCollapsed;\n\n  return (\n    <div\n      className={cn(\n        'flex items-center border-b border-neutral-200 py-4 dark:border-neutral-700',\n        showCollapsed ? 'justify-center px-2' : 'justify-between px-4',\n        className\n      )}\n    >\n      <div\n        className={cn(\n          'min-w-0',\n          showCollapsed ? 'flex justify-center' : 'flex-1'\n        )}\n      >\n        {children}\n      </div>\n      {showMobileClose && isMobileViewport && (\n        <button\n          onClick={closeMobile}\n          className=\"-mr-2 rounded-lg p-2 text-neutral-500 transition-colors hover:bg-neutral-100 lg:hidden dark:hover:bg-neutral-800\"\n          aria-label=\"Close navigation\"\n        >\n          <XIcon />\n        </button>\n      )}\n    </div>\n  );\n}\n\n// =============================================================================\n// SidebarFooter Component\n// =============================================================================\n\nexport interface SidebarFooterProps {\n  children: ReactNode;\n  /** Additional CSS classes */\n  className?: string;\n}\n\nexport function SidebarFooter({\n  children,\n  className,\n}: SidebarFooterProps): React.JSX.Element {\n  const { isCollapsed, isMobileViewport } = useSidebar();\n  const showCollapsed = !isMobileViewport && isCollapsed;\n\n  return (\n    <div\n      className={cn(\n        'mt-auto border-t border-neutral-200 py-4 dark:border-neutral-700',\n        showCollapsed ? 'flex justify-center px-2' : 'px-4',\n        className\n      )}\n    >\n      {children}\n    </div>\n  );\n}\n\n// =============================================================================\n// SidebarContent Component (scrollable area)\n// =============================================================================\n\nexport interface SidebarContentProps {\n  children: ReactNode;\n  /** Additional CSS classes */\n  className?: string;\n}\n\nexport function SidebarContent({\n  children,\n  className,\n}: SidebarContentProps): React.JSX.Element {\n  return (\n    <div className={cn('flex-1 overflow-y-auto py-4', className)}>\n      {children}\n    </div>\n  );\n}\n\n// =============================================================================\n// SidebarNav Component\n// =============================================================================\n\nexport interface SidebarNavProps {\n  children: ReactNode;\n  /** Additional CSS classes */\n  className?: string;\n}\n\nexport function SidebarNav({\n  children,\n  className,\n}: SidebarNavProps): React.JSX.Element {\n  return <nav className={cn('space-y-1 px-2', className)}>{children}</nav>;\n}\n\n// =============================================================================\n// SidebarNavGroup Component\n// =============================================================================\n\nexport interface SidebarNavGroupProps {\n  /** Group label */\n  label: string;\n  /** Group icon */\n  icon?: ReactNode;\n  /** Group items */\n  children: ReactNode;\n  /** Whether the group starts expanded (for controlled accordion) */\n  defaultExpanded?: boolean;\n  /** Group identifier for accordion behavior */\n  groupId?: string;\n  /** Additional CSS classes */\n  className?: string;\n}\n\nexport function SidebarNavGroup({\n  label,\n  icon,\n  children,\n  defaultExpanded = false,\n  groupId,\n  className,\n}: SidebarNavGroupProps): React.JSX.Element {\n  const { isCollapsed, isMobileViewport, expandedGroup, toggleGroup } =\n    useSidebar();\n  const showCollapsed = !isMobileViewport && isCollapsed;\n\n  // Determine if this group is expanded\n  const isExpanded = groupId ? expandedGroup === groupId : defaultExpanded;\n\n  // Local state for uncontrolled behavior\n  const [localExpanded, setLocalExpanded] = useState(defaultExpanded);\n  const effectiveExpanded = groupId ? isExpanded : localExpanded;\n\n  const handleToggle = useCallback(() => {\n    if (groupId) {\n      toggleGroup(groupId);\n    } else {\n      setLocalExpanded((prev) => !prev);\n    }\n  }, [groupId, toggleGroup]);\n\n  return (\n    <div className={cn('mb-2', className)}>\n      {/* Group Header */}\n      <button\n        onClick={handleToggle}\n        className={cn(\n          'flex w-full items-center rounded-lg px-3 py-2 text-sm font-semibold',\n          'text-neutral-700 dark:text-neutral-300',\n          'transition-colors hover:bg-neutral-100 dark:hover:bg-neutral-800',\n          showCollapsed && 'justify-center'\n        )}\n        title={showCollapsed ? label : undefined}\n      >\n        {icon && (\n          <span\n            className={cn(\n              'h-5 w-5 flex-shrink-0 text-neutral-500 dark:text-neutral-400',\n              !showCollapsed && 'mr-3'\n            )}\n          >\n            {icon}\n          </span>\n        )}\n        {!showCollapsed && (\n          <>\n            <span className=\"flex-1 truncate text-left\">{label}</span>\n            <span\n              className={cn(\n                'ml-2 flex-shrink-0 transition-transform duration-200',\n                effectiveExpanded && 'rotate-180'\n              )}\n            >\n              <ChevronDownIcon />\n            </span>\n          </>\n        )}\n      </button>\n\n      {/* Group Items */}\n      {!showCollapsed && (\n        <div\n          className={cn(\n            'overflow-hidden transition-all duration-300',\n            effectiveExpanded\n              ? 'mt-1 max-h-[1000px] opacity-100'\n              : 'max-h-0 opacity-0'\n          )}\n        >\n          <div className=\"pl-2\">{children}</div>\n        </div>\n      )}\n    </div>\n  );\n}\n\n// =============================================================================\n// SidebarNavItem Component\n// =============================================================================\n\nexport interface SidebarNavItemProps {\n  /** Item label */\n  label: string;\n  /** Item icon */\n  icon?: ReactNode;\n  /** Whether this item is currently active */\n  isActive?: boolean;\n  /** Click handler */\n  onClick?: () => void;\n  /** Optional href for link items */\n  href?: string;\n  /** Badge content (number or text) */\n  badge?: ReactNode;\n  /** Whether the item is disabled */\n  disabled?: boolean;\n  /** Additional CSS classes */\n  className?: string;\n  /** Test ID for testing */\n  'data-testid'?: string;\n}\n\nexport function SidebarNavItem({\n  label,\n  icon,\n  isActive = false,\n  onClick,\n  href,\n  badge,\n  disabled = false,\n  className,\n  'data-testid': testId,\n}: SidebarNavItemProps): React.JSX.Element {\n  const { isCollapsed, isMobileViewport, closeMobile } = useSidebar();\n  const showCollapsed = !isMobileViewport && isCollapsed;\n\n  const handleClick = useCallback(() => {\n    if (disabled) return;\n    onClick?.();\n    // Close mobile sidebar on navigation\n    if (isMobileViewport) {\n      closeMobile();\n    }\n  }, [disabled, onClick, isMobileViewport, closeMobile]);\n\n  const content = (\n    <>\n      {icon && (\n        <span\n          className={cn(\n            'h-5 w-5 flex-shrink-0',\n            isActive\n              ? 'text-primary-600 dark:text-primary-400'\n              : 'text-neutral-500 dark:text-neutral-400',\n            !showCollapsed && 'mr-3'\n          )}\n        >\n          {icon}\n        </span>\n      )}\n      {!showCollapsed && (\n        <>\n          <span className=\"flex-1 truncate text-left\">{label}</span>\n          {badge && (\n            <span\n              className={cn(\n                'ml-2 rounded-full px-2 py-0.5 text-xs font-medium',\n                isActive\n                  ? 'bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300'\n                  : 'bg-neutral-100 text-neutral-600 dark:bg-neutral-700 dark:text-neutral-400'\n              )}\n            >\n              {badge}\n            </span>\n          )}\n        </>\n      )}\n    </>\n  );\n\n  const baseClasses = cn(\n    'flex items-center w-full px-3 py-2 text-sm rounded-lg transition-colors',\n    isActive\n      ? 'bg-primary-50 dark:bg-primary-900/20 text-primary-700 dark:text-primary-300 font-medium'\n      : 'text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800',\n    disabled && 'opacity-50 cursor-not-allowed',\n    showCollapsed && 'justify-center',\n    className\n  );\n\n  if (href && !disabled) {\n    return (\n      <a\n        href={href}\n        onClick={handleClick}\n        data-testid={testId}\n        className={baseClasses}\n        title={showCollapsed ? label : undefined}\n      >\n        {content}\n      </a>\n    );\n  }\n\n  return (\n    <button\n      onClick={handleClick}\n      disabled={disabled}\n      data-testid={testId}\n      className={baseClasses}\n      title={showCollapsed ? label : undefined}\n    >\n      {content}\n    </button>\n  );\n}\n\n// =============================================================================\n// SidebarToggle Component\n// =============================================================================\n\nexport interface SidebarToggleProps {\n  /** Additional CSS classes */\n  className?: string;\n  /** Position of the toggle (default: 'inline') */\n  position?: 'inline' | 'floating';\n}\n\nexport function SidebarToggle({\n  className,\n  position = 'inline',\n}: SidebarToggleProps): React.JSX.Element {\n  const { isCollapsed, toggleCollapsed, isMobileViewport } = useSidebar();\n\n  // Don't render on mobile\n  if (isMobileViewport) return <></>;\n\n  const button = (\n    <button\n      onClick={toggleCollapsed}\n      className={cn(\n        'rounded-lg p-2 text-neutral-500 dark:text-neutral-400',\n        'transition-colors hover:bg-neutral-100 dark:hover:bg-neutral-800',\n        'focus:ring-primary-500 focus:ring-2 focus:outline-none',\n        className\n      )}\n      aria-label={isCollapsed ? 'Expand sidebar' : 'Collapse sidebar'}\n    >\n      {isCollapsed ? <ChevronRightIcon /> : <ChevronLeftIcon />}\n    </button>\n  );\n\n  if (position === 'floating') {\n    return (\n      <div className=\"absolute top-6 -right-3 z-10 rounded-full border border-neutral-200 bg-white shadow-md dark:border-neutral-700 dark:bg-neutral-900\">\n        {button}\n      </div>\n    );\n  }\n\n  return button;\n}\n\n// =============================================================================\n// SidebarMobileToggle Component\n// =============================================================================\n\nexport interface SidebarMobileToggleProps {\n  /** Additional CSS classes */\n  className?: string;\n  /** Custom icon */\n  icon?: ReactNode;\n}\n\nexport function SidebarMobileToggle({\n  className,\n  icon,\n}: SidebarMobileToggleProps): React.JSX.Element {\n  const { openMobile, isMobileViewport } = useSidebar();\n\n  // Don't render on desktop\n  if (!isMobileViewport) return <></>;\n\n  return (\n    <button\n      onClick={openMobile}\n      className={cn(\n        'rounded-lg p-2 text-neutral-500 dark:text-neutral-400',\n        'transition-colors hover:bg-neutral-100 dark:hover:bg-neutral-800',\n        'focus:ring-primary-500 focus:ring-2 focus:outline-none',\n        className\n      )}\n      aria-label=\"Open navigation\"\n    >\n      {icon ?? <MenuIcon />}\n    </button>\n  );\n}\n\n// =============================================================================\n// SidebarSearch Component\n// =============================================================================\n\nexport interface SidebarSearchProps {\n  /** Search query value */\n  value: string;\n  /** Change handler */\n  onChange: (value: string) => void;\n  /** Placeholder text */\n  placeholder?: string;\n  /** Keyboard shortcut hint */\n  shortcutHint?: string;\n  /** Additional CSS classes */\n  className?: string;\n  /** Test ID for testing */\n  'data-testid'?: string;\n}\n\nexport function SidebarSearch({\n  value,\n  onChange,\n  placeholder = 'Search...',\n  shortcutHint = '/',\n  className,\n  'data-testid': testId = 'sidebar-search',\n}: SidebarSearchProps): React.JSX.Element {\n  const { isCollapsed, isMobileViewport, setCollapsed } = useSidebar();\n  const inputRef = useRef<HTMLInputElement>(null);\n  const showCollapsed = !isMobileViewport && isCollapsed;\n\n  // Global keyboard shortcut: / to focus search\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      const target = e.target as HTMLElement;\n      if (\n        target.tagName === 'INPUT' ||\n        target.tagName === 'TEXTAREA' ||\n        target.isContentEditable\n      ) {\n        return;\n      }\n\n      if (e.key === '/') {\n        e.preventDefault();\n        // Expand sidebar if collapsed\n        if (showCollapsed) {\n          setCollapsed(false);\n          setTimeout(() => inputRef.current?.focus(), 350);\n        } else {\n          inputRef.current?.focus();\n        }\n      }\n    };\n\n    document.addEventListener('keydown', handleKeyDown);\n    return () => document.removeEventListener('keydown', handleKeyDown);\n  }, [showCollapsed, setCollapsed]);\n\n  // Don't render when collapsed\n  if (showCollapsed) return <></>;\n\n  return (\n    <div className={cn('px-3 py-2', className)}>\n      <div className=\"relative\">\n        <div className=\"absolute top-1/2 left-3 -translate-y-1/2 text-neutral-400\">\n          <SearchIcon />\n        </div>\n        <input\n          ref={inputRef}\n          type=\"text\"\n          value={value}\n          onChange={(e) => onChange(e.target.value)}\n          placeholder={`${placeholder} (${shortcutHint})`}\n          data-testid={testId}\n          className={cn(\n            'w-full rounded-lg py-2 pr-4 pl-10 text-sm',\n            'border-transparent bg-neutral-100 dark:bg-neutral-800',\n            'text-neutral-900 placeholder-neutral-400 dark:text-white dark:placeholder-neutral-500',\n            'focus:ring-primary-500 focus:bg-white focus:ring-2 focus:outline-none dark:focus:bg-neutral-700',\n            'transition-colors'\n          )}\n        />\n      </div>\n    </div>\n  );\n}\n","import React from 'react';\nimport { cn } from '../../utils/cn';\nimport type { ToastData, ToastVariant, ToastPosition } from './ToastProvider';\n\n// =============================================================================\n// Icons\n// =============================================================================\n\nconst CheckIcon = () => (\n  <svg\n    className=\"h-5 w-5\"\n    fill=\"none\"\n    viewBox=\"0 0 24 24\"\n    stroke=\"currentColor\"\n    strokeWidth={2}\n  >\n    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M5 13l4 4L19 7\" />\n  </svg>\n);\n\nconst XCircleIcon = () => (\n  <svg\n    className=\"h-5 w-5\"\n    fill=\"none\"\n    viewBox=\"0 0 24 24\"\n    stroke=\"currentColor\"\n    strokeWidth={2}\n  >\n    <path\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      d=\"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z\"\n    />\n  </svg>\n);\n\nconst ExclamationIcon = () => (\n  <svg\n    className=\"h-5 w-5\"\n    fill=\"none\"\n    viewBox=\"0 0 24 24\"\n    stroke=\"currentColor\"\n    strokeWidth={2}\n  >\n    <path\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\"\n    />\n  </svg>\n);\n\nconst InfoIcon = () => (\n  <svg\n    className=\"h-5 w-5\"\n    fill=\"none\"\n    viewBox=\"0 0 24 24\"\n    stroke=\"currentColor\"\n    strokeWidth={2}\n  >\n    <path\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\n    />\n  </svg>\n);\n\nconst XIcon = () => (\n  <svg\n    className=\"h-4 w-4\"\n    fill=\"none\"\n    viewBox=\"0 0 24 24\"\n    stroke=\"currentColor\"\n    strokeWidth={2}\n  >\n    <path\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      d=\"M6 18L18 6M6 6l12 12\"\n    />\n  </svg>\n);\n\n// =============================================================================\n// Variant Styles\n// =============================================================================\n\nconst variantStyles: Record<ToastVariant, { container: string; icon: string }> =\n  {\n    success: {\n      container:\n        'bg-green-50 dark:bg-green-900/30 border-green-200 dark:border-green-800 text-green-800 dark:text-green-200',\n      icon: 'text-green-500 dark:text-green-400',\n    },\n    error: {\n      container:\n        'bg-red-50 dark:bg-red-900/30 border-red-200 dark:border-red-800 text-red-800 dark:text-red-200',\n      icon: 'text-red-500 dark:text-red-400',\n    },\n    warning: {\n      container:\n        'bg-amber-50 dark:bg-amber-900/30 border-amber-200 dark:border-amber-800 text-amber-800 dark:text-amber-200',\n      icon: 'text-amber-500 dark:text-amber-400',\n    },\n    info: {\n      container:\n        'bg-blue-50 dark:bg-blue-900/30 border-blue-200 dark:border-blue-800 text-blue-800 dark:text-blue-200',\n      icon: 'text-blue-500 dark:text-blue-400',\n    },\n  };\n\nconst defaultIcons: Record<ToastVariant, React.ReactNode> = {\n  success: <CheckIcon />,\n  error: <XCircleIcon />,\n  warning: <ExclamationIcon />,\n  info: <InfoIcon />,\n};\n\n// =============================================================================\n// Toast Component\n// =============================================================================\n\nexport interface ToastProps extends ToastData {\n  /** Called when the toast is dismissed */\n  onClose: () => void;\n}\n\nexport function Toast({\n  title,\n  message,\n  variant = 'info',\n  dismissible = true,\n  action,\n  icon,\n  onClose,\n}: ToastProps): React.JSX.Element {\n  const styles = variantStyles[variant];\n  const displayIcon = icon ?? defaultIcons[variant];\n\n  return (\n    <div\n      role=\"alert\"\n      className={cn(\n        'flex items-start gap-3 rounded-lg border p-4 shadow-lg',\n        'max-w-[420px] min-w-[300px]',\n        'animate-slide-in-right',\n        styles.container\n      )}\n    >\n      {/* Icon */}\n      <div className={cn('flex-shrink-0', styles.icon)}>{displayIcon}</div>\n\n      {/* Content */}\n      <div className=\"min-w-0 flex-1\">\n        {title && <p className=\"mb-1 text-sm font-semibold\">{title}</p>}\n        <div className=\"text-sm opacity-90\">{message}</div>\n        {action && (\n          <button\n            onClick={action.onClick}\n            className=\"mt-2 rounded text-sm font-medium underline hover:no-underline focus:ring-2 focus:ring-current focus:ring-offset-2 focus:outline-none\"\n          >\n            {action.label}\n          </button>\n        )}\n      </div>\n\n      {/* Dismiss Button */}\n      {dismissible && (\n        <button\n          onClick={onClose}\n          className=\"flex-shrink-0 rounded p-1 transition-colors hover:bg-black/10 focus:ring-2 focus:ring-current focus:outline-none dark:hover:bg-white/10\"\n          aria-label=\"Dismiss notification\"\n        >\n          <XIcon />\n        </button>\n      )}\n    </div>\n  );\n}\n\n// =============================================================================\n// Position Styles\n// =============================================================================\n\nconst positionStyles: Record<ToastPosition, string> = {\n  'top-left': 'top-4 left-4 items-start',\n  'top-center': 'top-4 left-1/2 -translate-x-1/2 items-center',\n  'top-right': 'top-4 right-4 items-end',\n  'bottom-left': 'bottom-4 left-4 items-start',\n  'bottom-center': 'bottom-4 left-1/2 -translate-x-1/2 items-center',\n  'bottom-right': 'bottom-4 right-4 items-end',\n};\n\n// =============================================================================\n// Toast Container\n// =============================================================================\n\nexport interface ToastContainerProps {\n  /** Toasts to display */\n  toasts: ToastData[];\n  /** Position of the toast container (default: 'bottom-right') */\n  position?: ToastPosition;\n  /** Called when a toast should be dismissed */\n  onDismiss: (id: string) => void;\n}\n\nexport function ToastContainer({\n  toasts,\n  position = 'bottom-right',\n  onDismiss,\n}: ToastContainerProps): React.JSX.Element | null {\n  if (toasts.length === 0) return null;\n\n  return (\n    <div\n      className={cn(\n        'pointer-events-none fixed z-50 flex flex-col gap-2',\n        positionStyles[position]\n      )}\n      aria-live=\"polite\"\n      aria-atomic=\"true\"\n    >\n      {toasts.map((toast) => (\n        <div key={toast.id} className=\"pointer-events-auto\">\n          <Toast {...toast} onClose={() => onDismiss(toast.id)} />\n        </div>\n      ))}\n    </div>\n  );\n}\n","import React, {\n  createContext,\n  useContext,\n  useCallback,\n  useState,\n  useMemo,\n  type ReactNode,\n} from 'react';\n\n// =============================================================================\n// Types\n// =============================================================================\n\nexport type ToastVariant = 'success' | 'error' | 'warning' | 'info';\nexport type ToastPosition =\n  | 'top-left'\n  | 'top-center'\n  | 'top-right'\n  | 'bottom-left'\n  | 'bottom-center'\n  | 'bottom-right';\n\nexport interface ToastData {\n  /** Unique identifier for the toast */\n  id: string;\n  /** Toast message content */\n  message: ReactNode;\n  /** Optional title for the toast */\n  title?: string;\n  /** Toast variant/type (default: 'info') */\n  variant?: ToastVariant;\n  /** Duration in milliseconds before auto-dismiss (0 = no auto-dismiss, default: 5000) */\n  duration?: number;\n  /** Whether the toast can be dismissed by clicking (default: true) */\n  dismissible?: boolean;\n  /** Optional action button */\n  action?: {\n    label: string;\n    onClick: () => void;\n  };\n  /** Custom icon to display */\n  icon?: ReactNode;\n  /** Callback when toast is dismissed */\n  onDismiss?: () => void;\n}\n\nexport type ToastOptions = Omit<ToastData, 'id'>;\n\nexport interface ToastContextValue {\n  /** Currently visible toasts */\n  toasts: ToastData[];\n  /** Add a new toast and return its ID */\n  toast: (options: ToastOptions) => string;\n  /** Shorthand for success toast */\n  success: (message: ReactNode, options?: Partial<ToastOptions>) => string;\n  /** Shorthand for error toast */\n  error: (message: ReactNode, options?: Partial<ToastOptions>) => string;\n  /** Shorthand for warning toast */\n  warning: (message: ReactNode, options?: Partial<ToastOptions>) => string;\n  /** Shorthand for info toast */\n  info: (message: ReactNode, options?: Partial<ToastOptions>) => string;\n  /** Dismiss a specific toast by ID */\n  dismiss: (id: string) => void;\n  /** Dismiss all toasts */\n  dismissAll: () => void;\n}\n\n// =============================================================================\n// Context\n// =============================================================================\n\nconst ToastContext = createContext<ToastContextValue | null>(null);\n\n// =============================================================================\n// Provider\n// =============================================================================\n\nexport interface ToastProviderProps {\n  children: ReactNode;\n  /** Maximum number of toasts to show at once (default: 5) */\n  maxToasts?: number;\n  /** Position of toasts on screen (default: 'bottom-right') */\n  position?: ToastPosition;\n  /** Default duration for toasts in ms (default: 5000) */\n  defaultDuration?: number;\n}\n\nlet toastIdCounter = 0;\nfunction generateToastId(): string {\n  return `toast-${++toastIdCounter}-${Date.now()}`;\n}\n\nexport function ToastProvider({\n  children,\n  maxToasts = 5,\n  defaultDuration = 5000,\n}: ToastProviderProps): React.JSX.Element {\n  const [toasts, setToasts] = useState<ToastData[]>([]);\n\n  const dismiss = useCallback((id: string) => {\n    setToasts((prev) => {\n      const toast = prev.find((t) => t.id === id);\n      if (toast?.onDismiss) {\n        toast.onDismiss();\n      }\n      return prev.filter((t) => t.id !== id);\n    });\n  }, []);\n\n  const dismissAll = useCallback(() => {\n    setToasts((prev) => {\n      prev.forEach((t) => t.onDismiss?.());\n      return [];\n    });\n  }, []);\n\n  const toast = useCallback(\n    (options: ToastOptions): string => {\n      const id = generateToastId();\n      const duration = options.duration ?? defaultDuration;\n\n      const newToast: ToastData = {\n        ...options,\n        id,\n        variant: options.variant ?? 'info',\n        dismissible: options.dismissible ?? true,\n        duration,\n      };\n\n      setToasts((prev) => {\n        const updated = [...prev, newToast];\n        // Remove oldest toasts if we exceed maxToasts\n        if (updated.length > maxToasts) {\n          const removed = updated.slice(0, updated.length - maxToasts);\n          removed.forEach((t) => t.onDismiss?.());\n          return updated.slice(-maxToasts);\n        }\n        return updated;\n      });\n\n      // Auto-dismiss after duration\n      if (duration > 0) {\n        setTimeout(() => dismiss(id), duration);\n      }\n\n      return id;\n    },\n    [maxToasts, defaultDuration, dismiss]\n  );\n\n  const success = useCallback(\n    (message: ReactNode, options?: Partial<ToastOptions>): string => {\n      return toast({ ...options, message, variant: 'success' });\n    },\n    [toast]\n  );\n\n  const error = useCallback(\n    (message: ReactNode, options?: Partial<ToastOptions>): string => {\n      return toast({\n        ...options,\n        message,\n        variant: 'error',\n        duration: options?.duration ?? 7000, // Errors stay longer by default\n      });\n    },\n    [toast]\n  );\n\n  const warning = useCallback(\n    (message: ReactNode, options?: Partial<ToastOptions>): string => {\n      return toast({ ...options, message, variant: 'warning' });\n    },\n    [toast]\n  );\n\n  const info = useCallback(\n    (message: ReactNode, options?: Partial<ToastOptions>): string => {\n      return toast({ ...options, message, variant: 'info' });\n    },\n    [toast]\n  );\n\n  const contextValue = useMemo<ToastContextValue>(\n    () => ({\n      toasts,\n      toast,\n      success,\n      error,\n      warning,\n      info,\n      dismiss,\n      dismissAll,\n    }),\n    [toasts, toast, success, error, warning, info, dismiss, dismissAll]\n  );\n\n  return (\n    <ToastContext.Provider value={contextValue}>\n      {children}\n    </ToastContext.Provider>\n  );\n}\n\n// =============================================================================\n// Hook\n// =============================================================================\n\n/**\n * Hook to access the toast notification system.\n * Must be used within a ToastProvider.\n *\n * @example\n * ```tsx\n * function MyComponent() {\n *   const { success, error } = useToast();\n *\n *   const handleSave = async () => {\n *     try {\n *       await saveData();\n *       success('Data saved successfully!');\n *     } catch (e) {\n *       error('Failed to save data');\n *     }\n *   };\n *\n *   return <button onClick={handleSave}>Save</button>;\n * }\n * ```\n */\nexport function useToast(): ToastContextValue {\n  const context = useContext(ToastContext);\n  if (!context) {\n    throw new Error('useToast must be used within a ToastProvider');\n  }\n  return context;\n}\n"]}